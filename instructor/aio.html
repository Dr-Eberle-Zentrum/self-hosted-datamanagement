<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="de" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Self-hosted Data Management: Alles auf einen Blick</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav UT"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Zum Hauptinhalt springen</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="UT-logo" alt="Universität Tübingen" src="../assets/images/UT-logo.svg"><span class="badge text-bg-info">
          <abbr title="Diese Lektion befindet sich in der Beta-Phase, was bedeutet, dass sie bereit für den Unterricht durch Dozenten außerhalb des ursprünglichen Autorenteams ist.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">Diese Lektion befindet sich in der Beta-Phase, was bedeutet, dass sie bereit für den Unterricht durch Dozenten außerhalb des ursprünglichen Autorenteams ist.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Thema umschalten (automatisch)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Dozentenansicht <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Lernansicht</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav UT" aria-label="Hauptnavigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Navigation umschalten">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menü</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Universität Tübingen" src="../assets/images/UT-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Self-hosted Data Management
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Suche auf der All-In-One-Seite" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Self-hosted Data Management
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Hauptpunkte</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Dozentennotizen</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Alle Bilder extrahieren</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Mehr <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html">Zusatzinformationen</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Suche auf der All-In-One-Seite"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Suche auf der All-In-One-Seite">Suche auf der All-In-One-Seite</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Self-hosted Data Management
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress UT">
    <div class="progress-bar UT" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lernfortschritt" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="Menü schließen" alt="Menü schließen" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Ausblenden " data-episodes="Episoden ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Dozentenansicht
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Lernansicht</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODEN
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Zusammenfassung und Zeitplan</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-vorbesprechung.html">1. Vorbesprechung</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-hardware-betriebssystem.html">2. Hardware und Betriebssystem</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-linux-grundlagen.html">3. Linux Schnellstart</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-remote-access.html">4. Remote Access: das SSH-Protokoll</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-sicherheit-1.html">5. Sicherheit: Benutzer und Dateirechte</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-sicherheit-ii.html">6. Sicherheit: Firewall und Fail2Ban</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-installationsvorbereitung-1.html">7. Installationsvorbereitung 1</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-installationsvorbereitung-2.html">8. Installationsvorbereitung 2</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-installationsvorbereitung-3.html">9. Installationsvorbereitung 3</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-installationsvorbereitung-4.html">10. Installationsvorbereitung 4</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-konfiguration-1.html">11. Installation und Konfiguration</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="12-backup.html">12. Backup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="13-konfiguration-2.html">13. Konfiguration 2</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESSOURCEN
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Hauptpunkte</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Dozentennotizen</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Alle Bilder extrahieren</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html">Zusatzinformationen</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">Alles auf einer Seite sehen</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-vorbesprechung"><p>Content from <a href="01-vorbesprechung.html">Vorbesprechung</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/01-vorbesprechung.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li>Was ist Datenmanagement?</li>
<li>Was ist digitale Selbstbestimmtheit?</li>
<li>Warum ist eine selbst gehostete Datenmanagementlösung gut?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li>Thematische Einleitung</li>
<li>Vorstellung der Ziele und Inhalte des Kurses</li>
<li>Voraussetzungen, die Sie mitbringen sollten</li>
<li>Informationen zum Ablauf des Kurses</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="thematische-einleitung">Thematische Einleitung<a class="anchor" aria-label="anchor" href="#thematische-einleitung"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="datenmanagement-im-wissenschaftlichen-kontext">Datenmanagement im wissenschaftlichen Kontext<a class="anchor" aria-label="anchor" href="#datenmanagement-im-wissenschaftlichen-kontext"></a>
</h3>
<p>Der Begriff des Forschungsdatenmanagements (FDM) umschreibt den
Umgang mit Forschungsdaten (z.B. Messdaten, Bilder, Artikel,
Interviewdaten u.v.m.) innerhalb von Forschungsprojekten. Dabei beginnt
FDM bei der Planung von Projekten, legt Standards für das Erstellen,
Analysieren und Publizieren fest und sorgt durch strukturierte
Archivierung für eine nachhaltige Speicherung und die Möglichkeit der
Nachnutzung der Forschungsdaten.</p>
<p>Mehr zum Thema FDM finden Sie z.B. <a href="https://uni-tuebingen.de/de/240762" class="external-link">hier</a>, <a href="https://forschungsdaten.info/" class="external-link">hier</a> oder im Kurs <a href="https://dr-eberle-zentrum.github.io/FDM-basics/" class="external-link">FDM
Basics</a></p>
<p>Um während der aktiven Forschungsarbeit seine Daten strukturiert und
zugänglich speichern zu können und mit anderen Projektteilnehmenden
kollaborieren zu können, sind online Dateispeicherung und online
Dateibearbeitung essentiell.</p>
<p>Häufig werden hierfür die Angebote großer Tech-Konzerne aus dem
Ausland genutzt. Es gibt aber auch die Möglichkeit solche Lösungen
selbst zu betreiben. Dadurch ist der Datenschutz gewährleistet, da keine
Daten außerhalb der EU gespeichert werden. Außerdem ist man unabhängig
von den vermeintlich günstigen Angeboten der Tech-Konzerne.</p>
<p>Die Probleme, die eine solche Abhängigkeit auch im privaten Alltag
herbeiführen, erfahren Sie in der folgenden Aufgabe.</p>
<div id="aufgabe-1-mark-und-sein-sohn" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="aufgabe-1-mark-und-sein-sohn" class="callout-inner">
<h3 class="callout-title">Aufgabe 1: Mark und sein Sohn</h3>
<div class="callout-content">
<ul>
<li><p>Lesen Sie den folgenden Artikel: <a href="https://www.spiegel.de/netzwelt/netzpolitik/google-vater-fotografiert-genitalbereich-von-krankem-kleinkind-und-der-aerger-beginnt-a-b0703d5e-7109-4271-bfa7-af07b551e105" class="external-link">SPIEGEL:
Autoupload in die Google-Cloud</a></p></li>
<li><p>Welche grundlegenden Probleme führten zu Marks
Situation?</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>In diesem Fall ist einiges schief gelaufen. Wir werden darüber in der
ersten Präsenzsitzung diskutieren.</p>
<p>Auf jeden Fall hat Mark jedoch seine informationelle Selbstbestimmung
aufgegeben.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="informationelle-selbstbestimmtheit">Informationelle Selbstbestimmtheit<a class="anchor" aria-label="anchor" href="#informationelle-selbstbestimmtheit"></a>
</h3>
<p>Unter dem Begriff <em>informationelle Selbstbestimmtheit</em> wird
verstanden, dass Personen selbst über ihre Daten bestimmen können. Das
<a href="https://www.bverfg.de/e/rs19831215_1bvr020983.html" class="external-link">Bundesverfassungsgericht</a>
hat dazu bereits 1983 geurteilt:</p>
<blockquote>
<p>“Das Grundrecht gewährleistet insoweit die Befugnis des Einzelnen,
grundsätzlich selbst über die Preisgabe und Verwendung seiner
persönlichen Daten zu bestimmen.”</p>
</blockquote>
<p><strong>Aber wie können wir selbst über die Preisgabe unserer Daten
bestimmen?</strong></p>
</div>
<div class="section level3">
<h3 id="digitale-mündigkeit">Digitale Mündigkeit<a class="anchor" aria-label="anchor" href="#digitale-m%C3%BCndigkeit"></a>
</h3>
<p>Um selbst über seine Daten zu bestimmen, sollte man die Daten und
deren Zustandenkommen verstehen. D.h. angewendete Technik sollte
verstanden und hinterfragt werden. Stimmt etwas nicht, sollte Kritik
geübt werden oder ggf. nach Alternativen gesucht werden. Fragen Sie sich
beim Einsatz digitaler Tools immer:</p>
<ul>
<li><p>Welche Daten gibt es?</p></li>
<li><p>Wann entstehen welche Daten?</p></li>
<li><p>Wer hat Zugriff auf diese Daten?</p></li>
<li><p>Welche Daten möchte ich wem preis geben und welche behalte ich
für mich?</p></li>
</ul>
<div id="wie-digital-mündig-sind-sie" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="wie-digital-mündig-sind-sie" class="callout-inner">
<h3 class="callout-title">Wie digital mündig sind Sie?</h3>
<div class="callout-content">
<p>Lesen Sie den folgenden Artikel von <a href="https://digitalcourage.de/digitale-selbstverteidigung/digitale-muendigkeit" class="external-link">Digitalcourage</a></p>
<p>Welche der im Artikel genannten Punkte setzen Sie bereits um? In
welchen Bereichen können Sie noch “mündiger” werden?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Nutzen Sie ein kostenloses E-Mailpostfach? Speichern Sie Daten in
verdächtig günstigen Onlinespeichern? Wie abhängig sind Sie von Big Tech
(Apple, Google, Amazon, Microsoft)?</p>
</div>
</div>
</div>
</div>
<p>Mehr zum Thema digitale Mündigkeit findet sich auch bei Simon 2024 <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div id="digitale-selbstbestimmtheit" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="digitale-selbstbestimmtheit" class="callout-inner">
<h3 class="callout-title">Digitale Selbstbestimmtheit</h3>
<div class="callout-content">
<p>Zu einem selbstbestimmten Leben gehört auch eine digitale
Selbstbestimmtheit.</p>
<p>Deshalb:</p>
<ul>
<li><p>eingesetzte Technik verstehen</p></li>
<li><p>Open-Source statt Closed Source</p></li>
<li><p>Community statt Großkonzern</p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="noch-mehr-zu-digitaler-selbstbestimmtheit-und-selbstverteidigung">Noch mehr zu digitaler Selbstbestimmtheit und
Selbstverteidigung<a class="anchor" aria-label="anchor" href="#noch-mehr-zu-digitaler-selbstbestimmtheit-und-selbstverteidigung"></a>
</h3>
<p>Noch mehr Informationen zum Thema finden Sie bei Interesse unter
anderem bei den folgenden Quellen:</p>
<ul>
<li><p><a href="https://github.com/Dr-Eberle-Zentrum/Digitale-Selbstverteidigung" class="external-link">Seminar
zur digitalen Selbstverteidigung</a></p></li>
<li><p>E. Snowden, Permanent Record - Meine Geschichte, (Berlin
2019)</p></li>
<li><p>J. Caspar, Wir Datensklaven - Wege aus der digitalen Ausbeutung,
(Berlin 2023)</p></li>
<li><p><a href="https://www.digitalcourage.org" class="external-link">Digitalcourage</a></p></li>
<li><p><a href="https://www.netzpolitik.org" class="external-link">Netzpolitik</a></p></li>
<li><p><a href="https://www.ccc.de" class="external-link">ChaosComputerClub</a> und <a href="https://media.ccc.de/" class="external-link">Streams des CCC</a></p></li>
</ul>
</div>
</section><section><h2 class="section-heading" id="ziele-und-inhalte-des-kurses">Ziele und Inhalte des Kurses<a class="anchor" aria-label="anchor" href="#ziele-und-inhalte-des-kurses"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="allgemeine-ziele">Allgemeine Ziele<a class="anchor" aria-label="anchor" href="#allgemeine-ziele"></a>
</h3>
<ul>
<li><p>Einstieg die Linux-(Server)-Welt</p></li>
<li><p>Weniger Angst vor Technik (und Fehlern)</p></li>
<li><p>Einstieg in die Systemadministration</p></li>
<li><p>Einrichten einer selbst betriebenen Cloudanwendung zur
Dateiverwaltung mit dem Raspberry Pi</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="inhaltliche-schwerpunkte">Inhaltliche Schwerpunkte<a class="anchor" aria-label="anchor" href="#inhaltliche-schwerpunkte"></a>
</h3>
<ul>
<li><strong>Betriebssystem: Installation und grundlegende
Verwaltung:</strong></li>
</ul>
<p>Wir beginnen ganz am Anfang mit der Installation dem Kennenlernen des
Linux-Betriebssystems. Wir nutzen dazu das Betriebssystem <a href="https://www.raspberrypi.com/software/operating-systems/#raspberry-pi-os-64-bit" class="external-link">Raspberry
Pi OS</a>, welches wiederum auf dem Debian-Betriebssystem aufbaut. Mehr
dazu in der zweiten Woche.</p>
<figure><img src="../fig/01_imager.png" alt="Screenshot auf welchem das Programm Raspberry Pi Imager mit Funktionen zur Auswahl eines Betriebssystems zu sehen ist." class="figure mx-auto d-block"><div class="figcaption">Raspberry Pi Imager: Tool zur Installation des
Raspberry Pi OS</div>
</figure><ul>
<li><strong>Sicherheit: Backup, Firewall, Fern-Zugriff:</strong></li>
</ul>
<p>Vor der Installation der eigentlichen Cloud-Software muss der Server
eingerichtet werden. Dazu zählen z.B. Funktionen zum Fernzugriff (SSH),
verschiedene Techniken zum Absichern des Servers (Firewall, Benutzer und
Zugriffsrechte) aber auch das Thema Backup.</p>
<figure><img src="../fig/01_rsync_firewall_ssh.png" alt="Drei Screenshot von Kommandozeilen. Der erste zeigt einen Befehl zum herstellen einer SSH-Verbindung, der zweite den rsync-Befehl zum erstellen von Backups und der dritte den Befehl zur erlauben von SSH-Verbindungen in der Firewall." class="figure mx-auto d-block"><div class="figcaption">Wir werden die meiste Zeit mit der Kommandozeile
arbeiten (hier am Beispiel von SSH (Fernzugriff), Rsync
(Dateisynchronisation) und ufw (Firewall)</div>
</figure><ul>
<li><strong>Netzwerktechnik: Router, Portweiterleitungen,
DDNS:</strong></li>
</ul>
<p>Wir werden uns damit beschäftigen, wie der Server, der Zuhause im
Wohnzimmer steht, weltweit im Internet erreichbar gemacht werden kann.
Dafür müssen wir uns mit Begriffen Dynamic Domain Name System (DDNS),
Portweiterleitung, Firewall, NAT, IPv4, IPv6 und weiteren
auseinandersetzen.</p>
<figure><img src="../fig/01_fritzbox_freigaben.png" alt="Screenshot, der dieAdministrationsoberfläche eines Fritzbox-Routers zeigt. Konkret sind Funktionen zum einrichten von Portweiterleitungen zu sehen." class="figure mx-auto d-block"><div class="figcaption">Administrationsoberfläche eines
FritzBox-Routers. Zu sehen sind Optionen zum erstellen von
Portfreigaben</div>
</figure><ul>
<li><strong>Webserver und Cloudserver</strong></li>
</ul>
<p>Sobald der Server grundlegend eingerichtet ist und die sichere
Erreichbarkeit im Internet gewährleistet ist, werden wir uns an die
Installation und Konfiguration des Webservers (Apache2) und des
Cloudservers (<a href="https://nextcloud.com" class="external-link">Nextcloud</a>) machen. Der
Webserver kann gewissermaßen als Kommunikationszentrale zwischen
Cloudserver und Internet betrachtet werden. Beim Cloudserver handelt es
sich um die Software, die für die Dateiverwaltung zuständig ist und mit
welcher wir am Ende unsere Dateien betrachten, synchronisieren,
freigeben und bearbeiten wollen.</p>
<figure><img src="../fig/01_webserver_cloudserver.png" alt="Zu sehen sind zwei Screenshots. Links ein Screenshot einer Konfigrationsdatei einer Website für den Apache2-Webserver und rechts die Browser-Administrationsoberschläche des Cloudservers Nextcloud." class="figure mx-auto d-block"><div class="figcaption">Konfigrationsdatei einer Website mit dem
Apache2-Webserver (links) und die Administrationsoberschläche des
Cloudservers Nextcloud (rechts)</div>
</figure><ul>
<li>Ausblick</li>
</ul>
<p>Sofern am Ende des Kurses noch Zeit verfügbar ist, schauen wir uns
noch ein paar andere Projekte an, die ebenfalls auf einem Raspberry Pi
betrieben werden können. Denn es gibt sehr viele Dinge, die man selbst
betreiben kann (auf einem Rasperry Pi oder ggf. größerer Hardware). Auf
Github gibt es eine große <a href="https://github.com/awesome-selfhosted/awesome-selfhosted" class="external-link">Liste
mit Projekten</a>.</p>
<figure><img src="../fig/01_ausblick.png" alt="Zu sehen sind vier Bilder. Von links nach rechts: Logo des Radicale-Projekts in Form eines Radieschens, Logo de Pi-hole-Projekts in Form einer abstrahierten Himbeere, Logo des KODI-Projekts als auf der Spitze stehendes balues Quadrat und zuletzt ein Screenshot aus dem Programm MotionEye, welcher verschiede Einstellungsparameter fpr eien Kamera zeigt sowie eine Momentaufnahme der Kamera, die ein Fenster von außen überwacht." class="figure mx-auto d-block"><div class="figcaption">Andere Self-Hosted-Projekte für den Raspberrry
Pi: Radicale als Kalenderserver, Pi-hole als zentraler Werbeblocker,
Kodi als Media-Streaming-Dienst und MotionEye zur Verwaltung von
(Überwachungs-)Kameras</div>
</figure>
</div>
</section><section><h2 class="section-heading" id="voraussetzungen">Voraussetzungen<a class="anchor" aria-label="anchor" href="#voraussetzungen"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="allgemeine-voraussetzungen">Allgemeine Voraussetzungen<a class="anchor" aria-label="anchor" href="#allgemeine-voraussetzungen"></a>
</h3>
<ul>
<li><p>Sie sollten sicher mit Ihrem PC (Windows oder Linux) oder Ihrem
Mac umgehen können</p></li>
<li><p>Sie sollten keine Angst vor Technik und der Kommandozeile
haben</p></li>
<li><p>Sie sollten ein Notebook mit administrativen Rechten
haben.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="technische-voraussetzungen">Technische Voraussetzungen<a class="anchor" aria-label="anchor" href="#technische-voraussetzungen"></a>
</h3>
<p>Für die Teilnahme am Kurs wird ein Raspberry Pi Set benötigt.
Entweder Sie nutzen dafür Ihre <strong>eigene Hardware</strong> oder Sie
<strong>leihen</strong> eines von max. 15 Sets aus.</p>
<p>Das Raspberry Pi Set besteht mindestens aus den folgenden
Komponenten:</p>
<ul>
<li><p>Raspberry Pi 4 oder 5 mit min. 4 GB RAM (besser 8 GB)</p></li>
<li><p>USB-C-Netzteil</p></li>
<li><p>SDHC-Karte (ca. 16 GB)</p></li>
<li><p>Adapterkabel Micro-HDMI auf HDMI</p></li>
<li><p>Kühlkörper ggf. mit Lüfter (v.a. beim Raspberry Pi 5 sind aktive
Lüfter empfehlenswert)</p></li>
<li><p>Tastatur und Maus</p></li>
</ul>
<figure><img src="../fig/01_pi-kit-berrybase.jpg" class="figure mx-auto d-block"><div class="figcaption">Hardware-Beispiel: Raspberry Pi Kit mit
Raspberry Pi 4, Gehäuse, Netzteil und Adapterkabel</div>
</figure><p><strong>Zusätzlich</strong> zum Raspberry Pi Set ist folgendes
nötig:</p>
<ul>
<li><p>1 Patch-Kabel (LAN-Kabel) zum Anschluss des Raspberry Pi am
Router</p></li>
<li><p>Zugriff auf die Administrationsoberfläche Ihres Routers</p></li>
<li><p>Freie Netzwerkbuchse am Router bzw. Switch (notfalls auch
WLAN)</p></li>
<li><p>einen Monitor/Fernseher mit HDMI-Eingang</p></li>
<li><p>Aufstellplatz mit Strom- und Netzwerkversorgung</p></li>
<li><p>Leerer USB-Stick oder leere externe Festplatte mit eigener
Stromversorgung</p></li>
</ul>
</div>
</section><section><h2 class="section-heading" id="organisatorisches">Organisatorisches<a class="anchor" aria-label="anchor" href="#organisatorisches"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="wöchentlicher-ablauf">Wöchentlicher Ablauf:<a class="anchor" aria-label="anchor" href="#w%C3%B6chentlicher-ablauf"></a>
</h3>
<p>Die Wochen laufen i.d.R. wie folgt ab:</p>
<ol style="list-style-type: decimal">
<li><p>Sie arbeiten das Lernmaterial auf <a href="https://dr-eberle-zentrum.github.io/self-hosted-datamanagement/" class="external-link">Github</a>
durch</p></li>
<li><p>Sie absolvieren auf <a href="https://ovidius.uni-tuebingen.de/" class="external-link">ILIAS</a> den Test zum
Selbstlernmaterial</p></li>
<li><p>Sie setzen die Arbeitsschritte selbstständig mit Ihrem Raspberry
Pi um. Dazu können Sie (online oder in Präsenz) zum Übungstermin
kommen.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="gruppenarbeit">Gruppenarbeit<a class="anchor" aria-label="anchor" href="#gruppenarbeit"></a>
</h3>
<p>Um die praktische Umsetzung des Projekts zu erleichtern, werden im
Kurs Gruppen gebildet. Nutzen Sie diese Gruppen, um Fragen zu klären,
das praktische Vorgehen gemeinsam zu planen und bei Problemen gemeinsam
nach Lösungen zu suchen.</p>
</div>
<div class="section level3">
<h3 id="leistungsnachweis">Leistungsnachweis<a class="anchor" aria-label="anchor" href="#leistungsnachweis"></a>
</h3>
<ul>
<li><p>Bei erbrachter Leistung erhalten Sie für diesen Kurs 3
ECTS-Punkte zunächst ohne Note oder auf expliziten Wunsch mit
Note.</p></li>
<li><p>Der Kurs ist anrechenbar für das Zertifikat <em><a href="https://uni-tuebingen.de/de/180835" class="external-link">Data Literacy</a></em> im
Wahlbereich praktische Anwendungen</p></li>
<li>
<p>Die erforderliche Leistungen sind:</p>
<ul>
<li><p>wöchentliche Bearbeitung der Lernmaterialien</p></li>
<li><p>wöchentlicher Test auf <a href="https://ovidius.uni-tuebingen.de/" class="external-link">ILIAS</a></p></li>
</ul>
<!-- - Abgabe von fünf Protokollen im Laufe des Vorlesungszeit --><ul>
<li><p>selbstständige Konfiguration eines Cloud-Servers</p></li>
<li><p>Verfassen eines Abschlussberichts (ca. 3-4 Seiten)</p></li>
</ul>
</li>
<li><p>Der Workload beträgt entsprechend 3 ECTS ca. 90 Stunden im
Semester. Davon entfallen ca. 21 Stunden auf die Präsenzsitzungen, 9
Stunden auf den Abschlussbericht und 60 Stunden auf die Vor- und
Nachbereitung der Sitzungen inkl. den Protokollen. D.h. pro Woche müssen
Sie während der Vorlesungszeit durchschnittlich ca. 4,3 Stunden
Arbeitszeit zusätzlich zu den Präsenzsitzungen einplanen.</p></li>
</ul>
<p><strong>Mehr Informationen folgen in der ersten
Präsenzsitzung.</strong></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li>Die eigene Cloud schützt die Privatsphäre und reduziert die
Abhängigkeit von großen Monopolisten</li>
<li>Der Kurs begleitet Sie vom Hardwaresetup und dem Linux
Betriebssystem über die Grundkonfiguration des Servers bis hin zur
Installation und Konfiguration des eigenen Cloudservers</li>
<li>Sie müssen jede Woche Selbstlernmaterial durcharbeiten, auf ILIAS
einen Test durchführen und die praktischen Aufgaben absolvieren</li>
<li>Am Ende des Kurses müssen Sie noch einen Abschlussbericht
verfassen</li>
<li>Für den Kurs erhalten Sie 3 ECTS-Punkte</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section><div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>L. Simon, Digitale Mündigkeit - Wie wir mit einer neuen
Haltung die Welt retten können, (Bielefeld 2024)<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div></section><section id="aio-02-hardware-betriebssystem"><p>Content from <a href="02-hardware-betriebssystem.html">Hardware und Betriebssystem</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-25 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/02-hardware-betriebssystem.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Was steht am Anfang eines jeden IT-Projekts?</p></li>
<li><p>Was ist ein Server, was ein Client?</p></li>
<li><p>Welche Betriebssystem-Optionen gibt es für den Raspberry
Pi?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li>Begriffsklärung</li>
<li>Betriebssystem installieren</li>
<li>Raspberry Pi zusammenbauen und erstmalig starten</li>
<li>Erste administrative Schritte mit dem Raspberry Pi</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="die-hard--und-software">Die Hard- und Software<a class="anchor" aria-label="anchor" href="#die-hard--und-software"></a>
</h1>
<div class="section level2">
<h2 id="hardware">Hardware<a class="anchor" aria-label="anchor" href="#hardware"></a>
</h2>
<p>Zu Beginn der meisten IT-Projekte steht die Frage, wo diese Projekte
umgesetzt werden sollen. Dabei gibt es heutzutage unterschiedliche
Möglichkeiten. Abgesehen von Tests auf lokalen Endgeräten wie PC oder
Notebook, werden für viele Projekte spezialisierte Geräte genutzt. Vor
allem für Firmen, Rechenzentren und andere Hochleistungsszenarien werden
Computer mit <strong>spezialisierter Hardware</strong> (Prozessoren,
Festplatten, Arbeitsspeicher oder RAID-Controller) eingesetzt, die für
diese anspruchsvollen Aufgaben geeignet ist und häufig nicht mit
Endanwender-Hardware vergleichbar ist.</p>
<p>Neben eigener Hardware besteht heute auch die Möglichkeit, seine
Projekte auf fremder Hardware umzusetzen. Diese fremde Hardware befindet
sich in einem <strong>entfernten Rechenzentrum (“der Cloud”)</strong>
und ist über das Internet erreich- und steuerbar. Häufig wird die
Hardware dabei virtualisiert, d.h. dass z.B. die Leistung eines echten
Prozessors mithilfe von Software für mehrere virtuelle Computer zur
Verfügung gestellt wird.</p>
<p>Für dezentrale Projekte können sogenannte <strong>Embedded
Devices</strong> genutzt werden. Hierbei handelt es sich häufig um
Spezialanfertigungen für genau einen Einsatzzweck, z.B. als Kassensystem
oder Waage im Supermarkt oder als Informationsdisplay im öffentlichen
Raum. Für diese Geräte werden auch spezielle Betriebssysteme und
Software eingesetzt.</p>
<p>Für kleinere Projekte wie Heimanwender können normale PCs genutzt
werden. Passender für Projekte mit wenig Leistungsanspruch (und im
Heimanwenderbereich ist das i.d.R. der Fall) sind Mini-PCs, bei denen
sämtliche oder die meisten Bauteile (Prozessor, Arbeitsspeicher,
Datenspeicher und externe Schnittstellen wie Netzwerk und USB) auf einer
Platine verbaut sind. Diese sogenannten <strong>Systems-on-a-Chip
(SoC)</strong> haben den Vorteil, dass sie besonders energiesparsam
sind, wenig Platz benötigen, keinen oder kaum Lärm verursachen und im
Vergleich mit herkömmlichen PCs oder gar professionellen Servern
deutlich günstiger sind.</p>
</div>
<div class="section level2">
<h2 id="server-vs--client">Server vs. Client<a class="anchor" aria-label="anchor" href="#server-vs--client"></a>
</h2>
<p>Bezogen auf ihre Funktion innerhalb eines Computernetzwerks werden
Geräte unterschiedlich bezeichnet:</p>
<ol style="list-style-type: decimal">
<li>Client</li>
</ol>
<p>Klassisches Endgerät wie PC, Notebook oder Smartphone. Hat keine
zentralen Aufgaben. Ist ein Client-Gerät ausgefallen, ist das Netzwerk
nicht betroffen.</p>
<ol start="2" style="list-style-type: decimal">
<li>Server</li>
</ol>
<p>Übernimmt als Kommunikationsknotenpunkt zentrale Aufgaben im
Netzwerk. Je nach Leistungsbedarf werden spezialisierte
Hochleistungshardware, normale PCs oder SoCs genutzt. Fällt ein Server
aus, fehlt damit i.d.R. eine zentrale Funktion im Netzwerk. Je nachdem
welche Aufgaben der Server hat, kann dies zum vollständigen versagen des
Netzwerks führen oder nur zum Ausfall eines Dienstes (z.B. einer
Website).</p>
</div>
<div class="section level2">
<h2 id="software">Software<a class="anchor" aria-label="anchor" href="#software"></a>
</h2>
<p>Unter Software kann all das verstanden werden, was nicht angefasst
werden kann. Also sämtlicher Programmcode, der auf einem Computer
installiert ist. Dazu gehört sowohl das Betriebssystem, die
Boot-Umgebung (welche das Betriebssystem lädt) aber auch alle anderen
Programme wie Treiber, eine Firewall, ein Office-Programm oder ein
Webserver-Programm.</p>
<p>Möchte man ein bestimmtes IT-Projekt umsetzen und hat die Hardware
besorgt, gilt es auch die richtige Software auszuwählen. Hierbei ist zu
beachten, dass Hard- und Software miteinander kompatibel sein müssen.
Z.B. unterstützt nicht jedes Betriebssystem jede Art von Prozessor
(siehe auch diesen <a href="https://de.wikipedia.org/wiki/Prozessorarchitektur" class="external-link">Wikipedia-Artikel</a>).</p>
<p>Abhängig von den Programmen, die man nutzen möchte, kann das passende
Betriebssystem gewählt werden. Für viele Serveranwendungen, wie die in
diesem Kurs genutzte Software <a href="https://nextcloud.com" class="external-link">Nextcloud</a>, werden Linux-Betriebssysteme
empfohlen. In vielen Fällen werden für die Funktion des Hauptprogramms
(in unserem Fall Nextcloud) weitere Programme benötigt. Das sind häufig
ein <a href="https://de.wikipedia.org/wiki/Datenbank#Komponenten_eines_Datenbanksystems" class="external-link">Datenbankmanagementsystem</a>
wie Mysql oder MariaDB, die Skriptsprache PHP, und ein Webserver wie <a href="https://httpd.apache.org/" class="external-link">Apache2</a>. In dieser Kombination
spricht man auch von einem LAMP-Stack (<strong>L</strong>inux,
<strong>A</strong>pache, <strong>M</strong>ysql/<strong>M</strong>ariaDB
und <strong>P</strong>HP).</p>
<p>Die genauen Anforderungen an die Hard- und Software sind häufig den
Handbüchern der Programme zu entnehmen. Allerdings hängt die richtige
Wahl auch von der Intensivität der Nutzung, persönlichen Vorlieben oder
Vorgaben innerhalb einer Organisation ab.</p>
<div id="system-requirements" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="system-requirements" class="callout-inner">
<h3 class="callout-title">System requirements</h3>
<div class="callout-content">
<p>Szenario: Sie wollen für eine kleine Forschungsgruppe (ca. 10
Personen) eine Datenmanagement-Lösung betreiben und als Serversoftware
<a href="https://nextcloud.com" class="external-link">Nextcloud</a> installieren.</p>
<p>Welche Hardware wählen Sie dafür? Schauen Sie sich dafür die <a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/system_requirements.html" class="external-link">System
requirements</a> von Nextcloud an und wählen Sie aus einer der folgenden
Hardware-Optionen:</p>
<ol style="list-style-type: decimal">
<li><p><a href="https://www.raspberrypi.com/products/raspberry-pi-4-model-b/" class="external-link">Raspberry
Pi 4</a> mit 8GB RAM für ca. 100€ und einer externen <a href="https://www.idealo.de/preisvergleich/OffersOfProduct/204400140_-mysafe-advance-3-5-usb-3-0-2tb-i-tec.html" class="external-link">2
TB USB-HDD-Festplatte</a></p></li>
<li><p><a href="https://www.raspberrypi.com/products/raspberry-pi-5/" class="external-link">Raspberry Pi
5</a> mit 8GB RAM für ca. 110€ und einer <a href="https://geizhals.de/crucial-p310-ssd-2tb-ct2000p310ssd2-a3234426.html?hloc=at&amp;hloc=de" class="external-link">2
TB SSD-Festplatte</a></p></li>
<li><p><a href="https://www.hardkernel.com/shop/odroid-h4-ultra/" class="external-link">Odroid
H4 Ultra</a> mit einer <a href="https://geizhals.de/crucial-p310-ssd-2tb-ct2000p310ssd2-a3234426.html?hloc=at&amp;hloc=de" class="external-link">2
TB SSD-Festplatte</a></p></li>
<li><p>Einen Tower Server <a href="../files/server-angebot.pdf">SR10766 der
Intel Xeon E-2400 Serie</a></p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Die genauen Hardwareanforderungen sind (v.a. am Anfang des Projekts
und ohne Vorkenntnisse) schwer abzuschätzen. Geeignete Lösungen können
aber die Nummern 2. und 3. sein. Die Nummer 4 wäre überdimensioniert und
mit der Nummer 1. kommt das System an seine Grenzen. Auch der Raspberry
Pi 5 ist für 10 Personen vermutlich zu schwach. Das hängt aber stark von
der Art und Intensivität der Nutzung ab.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="praktische-umsetzung">Praktische Umsetzung<a class="anchor" aria-label="anchor" href="#praktische-umsetzung"></a>
</h1>
<p>Im Folgenden werden die Schritte zur praktischen Umsetzung erklärt.
Diese können gemeinsam während der Präsenzsitzungen oder selbstständig
durchgeführt werden.</p>
<div class="section level2">
<h2 id="installation-des-betriebssystems">Installation des Betriebssystems<a class="anchor" aria-label="anchor" href="#installation-des-betriebssystems"></a>
</h2>
<p>Für unser Projekt nutzen wir als Hardware den Raspberry Pi 4 oder 5.
Als Betriebssystem installieren wir das offizielle Betriebssystem des
Herstellers: <a href="https://www.raspberrypi.com/software/operating-systems/#raspberry-pi-os-64-bit" class="external-link">Raspberry
Pi OS 64-Bit</a>. Dabei handelt es sich um ein Linux-Betriebssystem aus
der Reihe der Debian-Linux-Systeme. Damit ist unser System sehr ähnlich
zu den Linux-Betriebssystemen Debian, Ubuntu oder Linux Mint.</p>
<p>Grundlegend können auf einem Raspberry Pi unterschiedliche
Betriebssysteme installiert werden. Sie müssen jedoch mit dem
ARM-Prozessor kompatibel sein. Möglich sind z.B. Ubuntu, Windows, viele
Linux-Distribution oder Spezialanwendungen wie <a href="https://libreelec.tv/" class="external-link">LibreElec</a> als
Medienstreaming-Server.</p>
<p>Für die Installation des Betriebssystems wird vom Hersteller der
Hardware das Programm <a href="https://www.raspberrypi.com/software/" class="external-link">Raspberry Pi Imager</a> zur
Verfügung gestellt. Dieses wird auf dem eigenen (Windows, Linux)-PC oder
Mac installiert. Anschließend kann damit das Betriebssystem auf die
SD-Karte oder Festplatte des Raspberry Pi geschrieben werden.</p>
<div class="section level3">
<h3 id="vorgehen">Vorgehen:<a class="anchor" aria-label="anchor" href="#vorgehen"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Betriebssystem auswählen: Rapsberry Pi OS 64 Bit</li>
</ol>
<figure><img src="../fig/02_imager_write.png" alt="Startbildschirm des Raspberry Pi Imager. Es ist zu sehen, dass als Betriebssystem das Raspberry Pi OS 64 Bit ausgewählt ist" class="figure mx-auto d-block"><div class="figcaption">Raspberry Pi Imager mit ausgewähltem
Betriebssystem (hier Raspberry Pi OS in der 64 Bit-Variante).</div>
</figure><ol start="2" style="list-style-type: decimal">
<li><p>Speicher auswählen: die SD-Karte muss im PC eingesteckt sein und
nun ausgewählt werden.</p></li>
<li><p>Über das Zahnradsymbol die erweiterten Einstellungen
öffnen</p></li>
</ol>
<figure><img src="../fig/02_imager_settings.png" alt="Fenster mit den erweiterten Einstellungen des Raspberry Pi Imager." class="figure mx-auto d-block"><div class="figcaption">Erweiterte Einstellungen des Raspberry Pi
Imager</div>
</figure><ol start="4" style="list-style-type: decimal">
<li>
<p>Folgende Optionen einstellen:</p>
<ol style="list-style-type: decimal">
<li><p>Hostname: ein Name für deinen Raspberry Pi (keine Sonderzeichen,
keine Leerzeichen)</p></li>
<li><p><em>SSH aktivieren</em> auswählen</p></li>
<li><p>Benutzername und Passwort festlegen (und merken!)</p></li>
<li><p>WLAN-Zugang konfigurieren</p></li>
<li><p>Spracheinstellungen festlegen: <em>Europe/Berlin</em> und
<em>de</em></p></li>
<li><p>Telemetrie deaktivieren</p></li>
</ol>
</li>
<li><p>Inhalte mit dem <em>Schreiben</em> Button auf die SD-Karte
schreiben</p></li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="hardware-zusammen-bauen">Hardware zusammen bauen<a class="anchor" aria-label="anchor" href="#hardware-zusammen-bauen"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Gehäuse öffnen (Pfeile am Deckel beachten)</p></li>
<li><p>Raspberry Pi Board auf die Zapfen des Gehäuses setzen (bei
manchen Gehäusen müssen die Zapfen mit einem Messer ausgedünnt
werden)</p></li>
<li><p>Wenn noch nicht geschehen: Kühlkörper aufkleben</p></li>
<li><p>Gehäuse schließen und falls vorhanden zuvor den Lüfter
einsetzen</p></li>
<li><p>Netzkabel und HDMI-Kabel anschließen (noch nicht mit dem
Stromnetz verbinden)</p></li>
<li><p>SD-Karte einsetzen</p></li>
<li><p>Monitor verbinden</p></li>
<li><p>Maus und Tastatur anschließen</p></li>
<li><p>Netzteil in die Steckdose stecken</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="erster-start">Erster Start<a class="anchor" aria-label="anchor" href="#erster-start"></a>
</h2>
<p>Der erste Start ist i.d.R. etwas langsam, da im Hintergrund noch ein
paar einmalige Prozesse ablaufen. Diesen Startvorgang einfach abwarten,
bis der Desktop des Raspberry Pi OS erscheint.</p>
<p>Nun können erste Grundeinstellungen vorgenommen werden:</p>
<ol style="list-style-type: decimal">
<li><p>Im Hauptmenü (oben links) unter Einstellungen auf Raspberry Pi
Konfiguration gehen</p></li>
<li><p>Autologin deaktivieren</p></li>
<li><p>Interfaces: SSH aktivieren (wenn noch nicht passiert)</p></li>
<li><p>Performance: ggf. Raspberry Pi Lüfter konfigurieren</p></li>
<li><p>Localisation: ggf. Sprache einstellen</p></li>
<li><p>Bluethooth ausschalten (Symbol oben rechts)</p></li>
</ol>
<p>Der Raspberry Pi ist nun grundlegend eingerichtet und einsatzbereit.
Die Nutzung unterscheidet sich hierbei zunächst nicht von einem
herkömmlichen PC. In den folgenden Lektionen wird der Mini-Computer
jedoch in seiner Funktionalität erweitert, um als Server genutzt werden
zu können.</p>
</div>
</div>
<div class="section level1">
<h1 id="weitere-quellen">Weitere Quellen<a class="anchor" aria-label="anchor" href="#weitere-quellen"></a>
</h1>
<ul>
<li><p>Empfehlung: <a href="https://dr-eberle-zentrum.github.io/DataBASHing/basics.html" class="external-link">Grundlagen
mit der Linux-Kommandozeile</a> aneignen</p></li>
<li><p><a href="https://www.youtube.com/watch?v=uXUjwk2-qx4&amp;t=103s" class="external-link">Youtube:
Raspberry Pi Basisinformation</a></p></li>
<li><p><a href="https://www.elektronik-kompendium.de/sites/raspberry-pi/2002221.htm" class="external-link">Elektronik-Kompendium:
Raspberry Pi Grundkonfiguration</a></p></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li>Für viele Heimanwender und Kleinprojekte reichen Mini-PCs (SoC)
aus.</li>
<li>Für große Projekte wird spezialisierte Serverhardware benötigt</li>
<li>In diesem Kurs wird auf einem Raspberry Pi mit Linux-Betriebssystem
die Cloud-Software <a href="https://nextcloud.com" class="external-link">Nextcloud</a>
installiert.</li>
<li>Die Installation des Betriebssystems erfolgt mit dem Raspberry Pi
Imager</li>
<li>Der Raspberry Pi mit dem Raspberry Pi OS kann sowohl wie ein
herkömmlicher PC, als auch wie ein Server genutzt werden</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div></section><section id="aio-03-linux-grundlagen"><p>Content from <a href="03-linux-grundlagen.html">Linux Schnellstart</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-25 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/03-linux-grundlagen.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Was sind markante Unterschiede zwischen Linux und
Windows/Mac</p></li>
<li><p>Wie ist das Dateisystem von Linux aufgebaut?</p></li>
<li><p>Wie kann ich unter Linux Software verwalten?</p></li>
<li><p>Wie bediene ich die Kommandozeile?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Essentielle Verzeichnisse kennenlernen</p></li>
<li><p>Software installieren und verwalten</p></li>
<li><p>Erste Schritte mit der Linux-Kommandozeile</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="status-quo">Status Quo:<a class="anchor" aria-label="anchor" href="#status-quo"></a>
</h2>
<hr class="half-width">
<ul>
<li><p>Das Betriebssystem wurde installiert</p></li>
<li><p>Der erste Start wurde durchgeführt</p></li>
<li><p>Der Raspberry Pi ist mit dem Netzwerk verbunden und der
SSH-Dienst ist aktiviert</p></li>
</ul></section><section><h2 class="section-heading" id="raspberry-pi-os">Raspberry Pi OS<a class="anchor" aria-label="anchor" href="#raspberry-pi-os"></a>
</h2>
<hr class="half-width">
<p>Beim Raspberry Pi OS handelt es sich um eine
<strong>Linux-Distribution</strong>. Da das Kernstück eines jeden
Linux-Systems, der <strong>Linux-Kernel</strong>, unter einer offenen
Lizenz steht, kann und wird dieses Kernstück von vielen Organisationen
und Personen genutzt. Erst durch die Kombination mit weiterer Software
wie Treibern, Dienstprogrammen und ggf. einer graphischen Oberfläche
wird ein vollwertiges Betriebssystem daraus. Die vielen
unterschiedlichen Zusammenstellungen mit dem Linux-Kernel als Kernstück
werden als Distribution bezeichnet.</p>
<p>Einen Eindruck über die Fülle an unterschiedlichen Distributionen
gibt die <a href="https://commons.wikimedia.org/wiki/File:Linux_Distribution_Timeline.svg" class="external-link">Linux
Distribution Timeline</a> auf Wikipedia.</p>
<p>Das Raspberry Pi OS wird von der Raspberry Pi Ltd. entwickelt. Es ist
speziell auf die Hardware des Raspberry Pis angepasst, ressourcensparend
und basiert auf der Debian-Distribution. Deshalb sind Anleitungen für
Linux-Systeme aus der Debian-Familie (Debian, Ubuntu, Mint u.v.a.)
häufig auch für das Raspberry Pi OS passend.</p>
</section><section><h2 class="section-heading" id="linux-schnellstart">Linux Schnellstart:<a class="anchor" aria-label="anchor" href="#linux-schnellstart"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="dateisystem">Dateisystem<a class="anchor" aria-label="anchor" href="#dateisystem"></a>
</h3>
<p>Das Linux-Dateisystem ist für alle Linux-Distributionen weitestgehend
einheitlich. Die oberste Hierarchie-Ebene ist dabei immer das
Verzeichnis <code>/</code> (Slash). Dieses ist vergleichbar mit dem
“C:”-Laufwerk unter Windows.</p>
<p>Weitere wichtige Verzeichnisse sind:</p>
<ul>
<li>die Benutzerverzeichnisse unter
<code>/home/&lt;username&gt;/</code>, z.B.
<code>/home/linus/</code>
</li>
</ul>
<p>Hier liegen die Dateien, Dokumente und Konfigurationen der User.
Schreib- und Leserechte haben nur die jeweiligen User und Personen mit
administrativen Rechten. Die Verzeichnisse sind mit dem Pfad
<code>C:\Users\&lt;username&gt;\</code> unter Windows vergleichbar.</p>
<ul>
<li>Die Systemverzeichnisse (z.B. <code>/etc/</code>,
<code>/var/</code>, <code>/mnt/</code>, <code>/lib/</code>,
<code>/bin/</code>, <code>/sys/</code>)</li>
</ul>
<p>Diese Verzeichnisse beinhalten Systemdaten, z.B. Programme,
Programmbibliotheken, temporäre Dateien, Log-Dateien oder systemweite
Konfigurationen. Deshalb haben in diesen Verzeichnissen i.d.R. nur
Personen mit administrativen Rechten Schreibrechte.</p>
<p>Im Vergleich mit dem Dateisystem von Windows fällt auf, dass es unter
Linux nur einen Verzeichnisbaum für alle Dateien, Festplatten und
Laufwerke gibt. Auch zusätzliche Festplatten oder externe Datenträger
werden in Linux-Systemen zunächst durch eine Gerätedatei im Verzeichnis
<code>/dev/</code> identifiziert und können dann über sogenannte
Einhängepunkte oder Mountpoints an einer beliebigen Stelle des
Verzeichnisbaumes verfügbar gemacht werden (“eingehängt” oder
“gemountet” werden). Unter Windows haben zusätzliche Datenträger und
Laufwerke stets ihre eigene unabhängige Verzeichnishierarchie, was die
Verwaltung von Festplatten weniger flexibel macht.</p>
<figure><img src="../fig/03_Filesystem.png" alt="Die Abbildung zeigt nebeneinander drei Verzeichnisbäume. Je einen für die Betriebssystem Linux, Mac und Windows. Dabei wird insbesondere die unterschiedliche Art der Einhängung von zusätzlichen Datenträgern wie Festplatten oder USB-Sticks hervorgehoben." class="figure mx-auto d-block"><div class="figcaption">Vergleich der Dateisysteme von Linux, Mac und
Windows (Quelle: <a href="https://itoss.org/faq/filesystem-hierarchy-standard/" class="external-link uri">https://itoss.org/faq/filesystem-hierarchy-standard/</a>)</div>
</figure><div class="section level4">
<h4 id="systemweite-konfigurationen-in-etc">Systemweite Konfigurationen in <code>/etc/</code>
<a class="anchor" aria-label="anchor" href="#systemweite-konfigurationen-in-etc"></a>
</h4>
<p>Das Verzeichnis <code>/etc/</code> enthält zahlreiche
Konfigurationsdateien für die systemweite Verwaltung von Programmen.
Viele Programme haben hier eigene Unterordner (z.B.
<code>/etc/apache2</code> für die Konfiguration des Apache-Webservers).
Möchte man die Konfiguration eines Programms systemweit ändern, ist das
<code>/etc/</code> Verzeichnis i.d.R. ein guter Startpunkt.
Schreibrechte haben hier nur Personen mit administrativen Rechten.</p>
</div>
<div class="section level4">
<h4 id="programmverzeichnnisse-bin-sbin-usrbin-usrsbin">Programmverzeichnnisse: <code>/bin/</code>, <code>/sbin/</code>,
<code>/usr/bin/</code> <code>/usr/sbin/</code>
<a class="anchor" aria-label="anchor" href="#programmverzeichnnisse-bin-sbin-usrbin-usrsbin"></a>
</h4>
<ul>
<li><p><code>/bin/</code>: Essentielle Systemprogramme (Start, Restore,
Basisprogramm des Betriebssystems)</p></li>
<li><p><code>/usr/bin/</code>: ergänzende Systemprogramme</p></li>
<li><p><code>/sbin/</code> und <code>/usr/sbin/</code>: nur für Personen
mit administrativen Rechten nutzbare Programme</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="dynamische-programmdateien-var">Dynamische Programmdateien: <code>/var/</code>
<a class="anchor" aria-label="anchor" href="#dynamische-programmdateien-var"></a>
</h4>
<p>Das Betriebssystem erzeugt ständig neue Dateien, z.B. werden in den
Log-Dateien Systemereignisse protokolliert. Solche dynamischen Inhalte
werden i.d.R. im <code>/var/</code>-Verzeichnis gespeichert.</p>
</div>
<div class="section level4">
<h4 id="einhängepunkte-mnt-und-media">Einhängepunkte <code>/mnt/</code> und <code>/media/</code>
<a class="anchor" aria-label="anchor" href="#einh%C3%A4ngepunkte-mnt-und-media"></a>
</h4>
<p>Externe Laufwerke und Wechselmedien werden standardmäßig in den
Verzeichnisse <code>/mnt/</code> und <code>/media/</code> eingebunden.
Dies ist allerdings keine zwingende Vorgabe und häufig gibt es gute
Gründe eine Festplatte an einer anderen Stelle des Verzeichnisbaumes
einzuhängen, z.B. im Home-Verzeichnis eines Users.</p>
</div>
</div>
<div class="section level3">
<h3 id="weitere-quellen">Weitere Quellen<a class="anchor" aria-label="anchor" href="#weitere-quellen"></a>
</h3>
<p>Mehr zur Verzeichnisstruktur von Linux findet sich z.B. bei <a href="https://wiki.ubuntuusers.de/Verzeichnisstruktur/" class="external-link">Ubuntuusers</a>
oder bei der Tuxacademy im Handbuch zur <a href="https://www.tuxcademy.org/product/lxes/" class="external-link">Linux-Essentials-Zertifizierung</a>
auf den Seiten 146-154.</p>
</div>
</section><section><h2 class="section-heading" id="paketverwaltung">Paketverwaltung<a class="anchor" aria-label="anchor" href="#paketverwaltung"></a>
</h2>
<hr class="half-width">
<p>Programme (oder auch Pakete, Packages, Software oder Apps) werden in
Linux i.d.R. durch eine zentrale Paketverwaltung ähnlich einem App-Store
auf dem Smartphone installiert. Da auch Android auf dem Linux-Kernel
aufbaut, sind die Prozesse zur Softwareverwaltung im Raspberry Pi OS
vergleichbar mit den Prozessen, die im Hintergrund ablaufen, wenn man
auf dem Smartphone eine App installiert und aktualisiert.</p>
<div class="section level3">
<h3 id="paketquellen">Paketquellen<a class="anchor" aria-label="anchor" href="#paketquellen"></a>
</h3>
<p>Zur Installation verfügbare Software wird unter Linux in
Paketrepositorien (oder auch Paketkatalogen oder Paketquellen)
aufgelistet und verfügbar gemacht. Ein Repositorium wird i.d.R. vom
Hersteller des Betriebssystems zur Verfügung gestellt und ähnelt in der
Funktion dem Google-Play-Store auf einem Android-Smartphone.</p>
<p>Die in den Repositorien des OS-Herstellers beinhaltete Software ist
kompatibel mit dem Betriebssystem und, je nach konkretem “Unterkatalog”,
auch getestet. Allerdings handelt es sich nicht immer um die neueste
Version eines Programms. Denn neue Versionen werden aufgrund der Tests
und Abhängigkeiten zu anderer Software erst zeitverzögert in die
Kataloge aufgenommen.</p>
<p>Bevor Software Software installiert werden kann, muss das
Betriebssystem die aktuelle Version des Katalogs herunterladen. Dies
erfolgt auf der Kommandozeile mit dem Befehl
<code>sudo apt-get update</code> oder <code>sudo apt update</code>.
Möchte man anschließend ein Programm installieren, muss der Name des
entsprechenden Pakets bekannt sein. Die Installation erfolgt mit
<code>sudo apt-get install &lt;Paketname&gt;</code>.</p>
<p>Der Vorteil der zentralen Paketverwaltung ist, dass in den
Repositorien stets festgehalten ist, welche Version eines Programms die
aktuelle ist. Durch den Abgleich der Versionen aller installierter
Programme mit dem Repositorium kann die Paketverwaltung schnell
ermitteln, für welche Programme es Aktualisierungen gibt. Um diese zu
installieren, muss der Befehl <code>sudo apt-get upgrade</code>
ausgeführt werden.</p>
<div class="section level4">
<h4 id="fremdquellen">Fremdquellen<a class="anchor" aria-label="anchor" href="#fremdquellen"></a>
</h4>
<p>Ist in den Paketquellen des OS-Herstellers nicht die nötige Software
enthalten, können auch Fremdquellen zum System hinzugefügt werden.
Hierbei handelt es sich um Paketkataloge, die nicht vom OS-Hersteller
(oder der Community) überprüft wurden. Deshalb besteht hier stets die
Gefahr, dass die enthaltende Software das System beschädigt oder es sich
um Malware handelt. Es gibt jedoch immer wieder Fälle, bei welchen
solche Fremdquellen nötig sind. Wie diese dem System hinzugefügt werden
können, ist z.B. <a href="https://linuxize.com/post/how-to-add-apt-repository-in-ubuntu/" class="external-link">hier</a>
für die Ubuntu-Distribution geschildert und kann so auch für das
Raspberry Pi OS übernommen werden.</p>
</div>
<div class="section level4">
<h4 id="weitere-befehle">Weitere Befehle<a class="anchor" aria-label="anchor" href="#weitere-befehle"></a>
</h4>
<p>Weitere wichtige Befehle für die Paketverwaltung sind z.B.</p>
<ul>
<li><p><code>sudo apt-get autoremove</code>: entfernt Abhängigkeiten von
Programmen, die selbst nicht mehr installiert sind. Dadurch wird das
System aufgeräumt.</p></li>
<li><p><code>sudo apt list --upgradeable</code>: zeigt aktualisierbare
Programme an</p></li>
<li><p><code>sudo apt-get remove &lt;Paketname&gt;</code>: entfernt ein
Paket, nicht jedoch dessen Konfigurationsdateien</p></li>
<li><p><code>sudo apt-get purge &lt;Paketname&gt;</code>: entfernt ein
Paket inkl. dessen Konfigurationsdateien</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="stolpersteine-bei-der-paketverwaltung">Stolpersteine bei der Paketverwaltung<a class="anchor" aria-label="anchor" href="#stolpersteine-bei-der-paketverwaltung"></a>
</h4>
<ul>
<li><p>Abhängigkeitsprobleme: v.a. bei der manuellen Installation von
Paketen oder der Nutzung von Fremdquellen besteht die Möglichkeit, dass
ein Programm ein anderes Programm als Abhängigkeit benötigt. Diese
Abhängigkeit ist aber nicht in den Paketquellen enthalten. Dadurch kommt
es zu einem nicht automatisch auflösbaren Abhängigkeitsproblem. Mögliche
Maßnahmen sind die manuelle Installation der Abhängigkeiten (die aber
weitere Abhängigkeiten haben können) oder der Downgrade auf eine
kompatible Version.</p></li>
<li><p>Paketname: häufig sind die Paketnamen für ein Programm nicht
eindeutig. Um den genauen Namen für die Installation zu finden, können
die Programmkataloge durchsucht werden:
<code>sudo apt-cache search &lt;Suchbegriff&gt;</code>. Alternativ kann
natürlich auch im Internet nach dem genauen Namen eines Pakets gesucht
werden.</p></li>
</ul>
<div id="webserver" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="webserver" class="callout-inner">
<h3 class="callout-title">Webserver</h3>
<div class="callout-content">
<p>Sie möchten auf Ihrem Linux-Server eine Website betreiben. Dazu
wollen Sie den Webserver <em>Apache</em> installieren. Wie gehen Sie
vor?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Der erste Schritt bei der Softwareverwaltung sollte immer die
Aktualisierung der Paketquellen sein:
<code>sudo apt-get update</code>.</p>
<p>Anschließend wird das System auf den aktuellen Stand gebracht:
<code>sudo apt-get upgrade</code>.</p>
<p>Nun müssen Sie herausfinden, wie das Paket, das den Apache-Webserver
für das Raspberry Pi OS liefert, heißt. Das können Sie mit einer
Internetrecherche oder dem Befehl
<code>sudo apt-cache search apache</code> tun.</p>
<p>Wenn Sie wissen, wie das Paket lautet, können Sie dieses mit dem
Befehl <code>sudo apt-get install &lt;Paketname&gt;</code>
installieren.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="kommandozeile">Kommandozeile<a class="anchor" aria-label="anchor" href="#kommandozeile"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="grundlegende-bedienung">Grundlegende Bedienung<a class="anchor" aria-label="anchor" href="#grundlegende-bedienung"></a>
</h3>
<ul>
<li><p><em>ENTER-Taste</em> nach Eingabe eines Befehls wird dieser mit
der ENTER-Taste ausgeführt</p></li>
<li><p><em>Pfeiltasten</em> hoch/runter: durch bisherige Befehle
blättern und diese wieder aufrufen</p></li>
<li><p><em>Tab-Taste:</em> Autovervollständigung von Pfaden und
Befehlen. Erste Buchstaben eines Pfades tippen, dann TAB-Taste für die
Autovervollständigung oder anzeigen von Optionen.</p></li>
<li><p><em>STRG + C</em>: bricht den laufenden Befehl ab</p></li>
<li><p>Kopieren: mit dem Cursor Text auswählen, dann <em>STRG + Umschalt
+ C</em></p></li>
<li><p>Einfügen: <em>STRG + Umschalt + V</em></p></li>
<li><p>Cursor-Position: mit Pfeiltasten ändern, geht nicht per
Mausklick</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="mit-der-kommandozeile-im-dateisystem-navigieren">Mit der Kommandozeile im Dateisystem navigieren<a class="anchor" aria-label="anchor" href="#mit-der-kommandozeile-im-dateisystem-navigieren"></a>
</h3>
<ul>
<li><p>Verzeichnis wechseln: <code>cd &lt;Pfadangabe&gt;</code>, z.B.
<code>cd /home/david/Dokumente</code></p></li>
<li><p>in das eigene Home-Verzeichnis wechseln: <code>cd</code></p></li>
<li><p>Eine Ebene nach oben gehen: <code>cd ..</code></p></li>
<li><p>Zwei Ebenen nach oben gehen: <code>cd ../..</code></p></li>
<li><p>Aktuelle Position im Dateisystem anzeigen:
<code>pwd</code></p></li>
<li><p>Verzeichnisinhalt anzeigen lassen: <code>ls</code> oder mit mehr
Informationen <code>ls -l</code></p></li>
</ul>
</div>
<div class="section level3">
<h3 id="dateioperationen">Dateioperationen:<a class="anchor" aria-label="anchor" href="#dateioperationen"></a>
</h3>
<ul>
<li><p>Datei erstellen:
<code>touch &lt;Dateipfad&gt;/&lt;Dateiname&gt;</code></p></li>
<li><p>Verzeichnis anlegen:
<code>mkdir &lt;Dateipfad&gt;/&lt;Neuer-Ordner&gt;</code></p></li>
<li><p>Inhalt einer Textdatei ausgeben:
<code>cat &lt;Dateiname&gt;</code></p></li>
<li><p>Oberste oder letzte 10 Zeilen einer Datei anzeigen lassen:
<code>head &lt;Dateiname&gt;</code> und
<code>tail &lt;Dateiname&gt;</code></p></li>
<li>
<p>Datei kopieren/verschieben/löschen:</p>
<ul>
<li><p>Copy:
<code>cp &lt;Quelldatei&gt; &lt;Zieldatei&gt;</code></p></li>
<li><p>Move:
<code>mv &lt;Quelldatei&gt; &lt;Zeildatei&gt;</code></p></li>
<li><p>remove: <code>rm &lt;Dateiname&gt;</code> oder remove recursive:
<code>rm -r &lt;Verzeichnispfad&gt;</code></p></li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="textdateien-bearbeiten-nano-editor">Textdateien bearbeiten: Nano-Editor<a class="anchor" aria-label="anchor" href="#textdateien-bearbeiten-nano-editor"></a>
</h3>
<p>Es gibt viele Texteditoren für Linux. Weit verbreitet sind z.B.
<strong>nano</strong> und <strong>vim</strong>, wobei nano der
einsteigerfreundlichere Editor ist. Deshalb arbeiten wir im Kurs mit dem
nano-Editor. Wer dennoch mit dem Vim-Editor arbeiten möchte, kann sich
z.B. <a href="https://www.youtube.com/playlist?list=PLT98CRl2KxKHy4A5N70jMRYAROzzC2a6x" class="external-link">dieses
Tutorial</a> anschauen</p>
<ul>
<li><p>Datei im Nano-Editor öffnen:
<code>nano &lt;Dateipfad&gt;/&lt;Dateiname&gt;</code></p></li>
<li><p>Navigation erfolgt ohne Maus, nur mit den Pfeiltasten
navigieren!</p></li>
<li><p>Datei schließen und speichern: <em>STRG + X</em>, dann
<em>J</em>, dann <em>ENTER</em></p></li>
<li><p>Schließen ohne zu speichern: <em>STRG + X</em>, dann
<em>N</em></p></li>
<li><p>Komplette Zeile löschen: <em>STRG + K</em></p></li>
<li><p>Kopieren und einfügen wie auf dem Terminal</p></li>
<li><p>Text suchen: <em>STRG + W</em>, dann Suchbegriff eingeben oder
für weitere Treffer direkt mit <em>ENTER</em> bestätigen</p></li>
<li><p>Zu bestimmter Zeile springen: <em>STRG + /</em>, dann
Zeilennummer eingeben</p></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>Raspberry Pi OS ist das Linux-Betriebssystem unserer
Wahl</p></li>
<li><p>Das Dateisystem unter Linux besteht aus einem einzigen
Verzeichnisbaum. “/” ist dabei die oberste Ebene</p></li>
<li><p>Software wird unter Linux zentral verwaltet. Die Verwaltung
erfolgt bei der Debian-Familie mit den Programmen <em>apt-get</em> oder
<em>apt</em></p></li>
<li><p>Ein Linux-Server wird i.d.R. über die Kommandozeile gesteuert.
Dabei erfolgt die Arbeit ohne Maus. Programmsteuerung, Dateioperationen
und die Dateierstellung werden per Tastatur erledigt.</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-04-remote-access"><p>Content from <a href="04-remote-access.html">Remote Access: das SSH-Protokoll</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/04-remote-access.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Wie kann ein Computer (ggf. aus der Ferne) verwaltet werden, auch
wenn er keinen Bildschirm hat?</p></li>
<li><p>Wie kann eine SSH-Verbindung sicher über unsichere Netzwerke
hergestellt werden?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Grundlagen des SSH-Protokolls verstehen</p></li>
<li><p>SSH-Server sicher konfigurieren</p></li>
<li><p>Sichere SSH-Verbindungen mit Schlüssel-Authentifikation
aufbauen</p></li>
<li><p>den Raspberry Pi im Headless-Setup aus der Ferne steuern</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="das-ssh-protokoll">Das SSH-Protokoll<a class="anchor" aria-label="anchor" href="#das-ssh-protokoll"></a>
</h2>
<hr class="half-width">
<p>Server stehen häufig an unzugänglichen Orten (Keller, gekühlte
Serverräume, weit entfernte Rechenzentren o.Ä.). Dennoch müssen sie
verwaltet werden. Dies wird heutzutage mittels des SSH-Protokolls
gemacht (früher wurde das inzwischen veraltete Telnet-Protokoll
genutzt).</p>
<p>Das SSH-Protokoll baut eine sichere Verbindung zwischen einem
Clientgerät (z.B. Ihrem Notebook) und einem Server (z.B. Ihrem Raspberry
Pi) über ein (ggf. auch unsicheres) Netzwerk auf. Über diese Verbindung
besteht in der Regel Zugriff auf die Kommandozeile des entfernten
Geräts, womit dieses verwaltet werden kann.</p>
<p>Die Verbindung kann aber auch zum Übertragen anderer Daten genutzt
werden. So können Dateien übertragen werden (mit dem <a href="https://www.ionos.de/digitalguide/server/konfiguration/linux-scp-befehl/" class="external-link"><code>scp</code>-Befehl</a>),
entfernte Dateisysteme lokal genutzt werden (per SSHFS, siehe <a href="https://de.wikipedia.org/wiki/SSHFS" class="external-link">Wikipedia</a>) oder die
graphische Ausgabe eines entfernten Programms lokal dargestellt werden
(<a href="https://www.heise.de/tipps-tricks/SSH-Tunnel-nutzen-so-geht-s-4320041.html" class="external-link">siehe
diesen Heise-Artikel</a>).</p>
<div id="protokoll" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="protokoll" class="callout-inner">
<h3 class="callout-title">Protokoll</h3>
<div class="callout-content">
<p>Bei einem Protokoll handelt es sich um eine Sammlung genau
festgelegter technischer Parameter für den Kommunikationsaustausch
zwischen Computern. Ähnlich der Sprache und ihrer Grammatik, auf die
sich zwei Menschen zum Kommunizieren einigen. Ein Protokoll hat einen
genauen Einsatzzweck und eine klar definierte Funktionsweise. z.B. ist
das HTTPS-Protokoll dafür gemacht, Daten zwischen einem Browser und
einem Webserver verschlüsselt mittels der TLS-Verschlüsselung zu
übertragen. Mehr zum Thema findet sich bei <a href="https://www.studysmarter.de/schule/informatik/theoretische-informatik/netzwerkprotokolle/" class="external-link">StudySmarter</a></p>
</div>
</div>
</div>
<p>Das SSH-Protkoll nutzt verschiedene Technologien zur Gewährleistung
der sicheren Übertragung. Ähnlich einer <a href="https://tiptopsecurity.com/how-does-https-work-rsa-encryption-explained/" class="external-link">HTTPS-Verbindung</a>
werden beim Verbindungsaufbau zunächst die Kommunikationsstandards
zwischen Client und Server ausgehandelt, dann werden sog. Session-Keys
ausgetauscht, welche nur für die aktuelle Verbindung Gültigkeit haben.
Mit diesen Session-Keys wird die eigentliche Verbindung in Form einer
symmetrischen Verschlüsselung aufgebaut (welche deutlich schneller ist,
als die zuvor stattfindende asymmetrische Verschlüsselung, siehe dazu
auch die Ressourcen von Studyflix zur <a href="https://studyflix.de/informatik/symmetrische-verschlusselung-1610" class="external-link">symmetrischen</a>
und <a href="https://studyflix.de/informatik/asymmetrische-verschlusselung-1609" class="external-link">asymmetrischen</a>
Verschlüsselung).</p>
<p>Mehr zur Funktionsweise des SSH-Protkolls können Sie im Netz finden,
z.B. bei <a href="https://www.ip-insider.de/was-ist-secure-shell-ssh-ssh-1-ssh-2-openssh-a-691217/" class="external-link">IP-Insider</a>.</p>
<div id="voraussetzung-für-die-ssh-verbindung" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="voraussetzung-für-die-ssh-verbindung" class="callout-inner">
<h3 class="callout-title">Voraussetzung für die SSH-Verbindung</h3>
<div class="callout-content">
<p>Sie haben wie in <a href="02-hardware-betriebssystem.html">Sitzung
2</a> besprochen auf Ihrem Raspberry Pi das Raspberry Pi OS installiert.
Nun wollen Sie eine SSH-Verbindung von Ihrem Notebook mit Ihrem
Raspberry Pi herstellen. Was sind die Bedingungen für eine erfolgreiche
SSH-Verbindung?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p>Netzwerkverbindung: der Server muss im Netzwerk erreichbar sein.
Dazu müssen entweder Server und Client im selben Netzwerk (z.B.
demselben Heimnetzwerk) sein oder der Server muss im Internet erreichbar
sein.</p></li>
<li><p>Software: Auf dem Raspberry Pi muss die SSH-Server-Software
installiert sein (das <strong>Paket openssh-server</strong>) und auf dem
Client ein SSH-Client-Programm (das OpenSSH-Client-Programm für die
Kommandozeile ist i.d.R. auf allen PCs installiert. Für Windows kann
auch das graphische Programm <a href="https://putty.org/" class="external-link">Putty</a>
installiert werden).</p></li>
<li><p>Berechtigungen: die Anmeldung am entfernten Server ist nur
möglich, wenn Sie die Berechtigungen haben. Sie benötigen also einen
Account auf dem Raspberry Pi OS und dessen Passwort.</p></li>
<li><p>Firewall: eine etwaige Firewall am Server muss die SSH-Verbindung
zulassen</p></li>
<li><p>Identifizierung: der Server muss für eine ordentliche Verbindung
eindeutig identifizierbar sein. Dies geschieht durch sogenannte
Host-Keys, die bei der erstmaligen Verbindung vom Server zum Client
übertragen werden und manuell akzeptiert werden müssen. Ändert sich der
Host-Key (z.B. nach einer Neuinstallation oder weil ein bösartiger
Akteur sich als Ihren Raspberry Pi ausgibt) und passt nicht mehr zum
ursprünglich übertragenen Key, schlägt die Verbindung fehl. Erst wenn
der neue Key akzeptiert wird ist eine Verbindung wieder möglich
(gespeicherte Keys finden Sie in der Datei <em>know_hosts.conf</em> im
Verzeichis <em>.ssh</em> in Ihrem persönlichen Ordner).</p></li>
</ol>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="grundlegender-verbindungsaufbau">Grundlegender Verbindungsaufbau<a class="anchor" aria-label="anchor" href="#grundlegender-verbindungsaufbau"></a>
</h3>
<p>Wenn die Voraussetzungen stimmen (siehe <a href="#voraussetzung-f%C3%BCr-die-ssh-verbindung">Vorraussetzungen für die
SSH-Verbindung</a>), kann eine einfache SSH-Verbindung mit folgendem
Befehl aufgebaut werden: <code>ssh &lt;user&gt;@&lt;server&gt;</code>
Dabei ist <code>&lt;user&gt;</code> der Username am entferten Gerät und
<code>&lt;server&gt;</code> ist die Adresse des Servers. Die Adresse
kann entweder in Form einer IP-Adresse (z.B. 192.168.178.10) oder als
Hostname (z.B. mein-cloudserver) angegeben werden. Die Variante mit dem
Hostnamen funktioniert jedoch nur, wenn dieser im lokalen Netzwerk
bekannt ist (z.B. in einem Heimnetzwerk im Router eingezeigt wird).</p>
<div id="ssh-verbindung" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="ssh-verbindung" class="callout-inner">
<h3 class="callout-title">SSH-Verbindung</h3>
<div class="callout-content">
<ul>
<li>So bauen Sie eine einfache SSH-Verbindung auf:
<strong><code>ssh &lt;user&gt;@&lt;server&gt;</code></strong>
</li>
</ul>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="schlüsselauthentifikation">Schlüsselauthentifikation<a class="anchor" aria-label="anchor" href="#schl%C3%BCsselauthentifikation"></a>
</h2>
<hr class="half-width">
<p>Die einfache SSH-Verbindung genügt zwar schon, um das entfernte
System zu verwalten. Allerdings kann eine angreifende Person versuchen,
den Usernamen und das Passwort zu erraten und damit Zugriff auf den
Server erlangen (leider sind Passwörter häufig nicht allzu kreativ
erdacht). Um dies zu verhindern, kann die Verbindung zusätzlich
gesichert werden:</p>
<ul>
<li><p>am Client, indem statt Passwörtern kaum zu erratende Schlüssel
zur Anmeldung genutzt werden</p></li>
<li><p>am Server, indem zu häufige Fehlanmeldungen zu einem Blockieren
führen</p></li>
</ul>
<p>Die Anmeldung per Schlüssel erfolgt mit einem
<strong>Schlüsselpaar</strong>. Ein solches Schlüsselpaar besteht aus
einem <strong>privaten</strong> und einem <strong>öffentlichen
Schlüssel</strong>. Während der öffentliche Schlüsse herausgegeben
werden kann, muss der private Schlüssel privat bleiben und sollte das
<strong>eigene Gerät niemals verlassen</strong>. Vereinfacht kann man
sich das Konzept wie ein Vorhängeschloss und den dazugehörigen Schlüssel
vorstellen. Das Schloss ist in dieser Analogie der öffentliche Schlüssel
und wird in geöffnetem Zustand an den Server übergeben. Dieser
“verschließt” damit die Tür zum SSH-Server. Zwar können alle sehen, dass
Ihr (öffentliches) Schloss an der Tür hängt, aber nur Sie können mit
Ihrem privaten Schlüssel die Tür wieder öffnen.</p>
<p>Aufgrund der komplexen krytpographischen Struktur der Schlüssel sind
diese deutlich schwerer bis gar nicht zu erraten. Zusätzlich empfiehlt
es sich, den privaten Schlüssel mit einer Passphrase vor unbfugtem
Zugriff zu schützen. Dann muss jedes mal, wenn der private Schlüssel
genutzt wird, ein zusätzliches Passwort eingegeben werden.</p>
<div id="schlüsselauthentifikation-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="schlüsselauthentifikation-1" class="callout-inner">
<h3 class="callout-title">Schlüsselauthentifikation</h3>
<div class="callout-content">
<p>Für eine sichere SSH-Verbindung empfiehlt es sich, auf Passwörter zu
verzichten und sich stattdessen mit einem Schlüsselpaar zu
authentifizieren.</p>
<p>Ist ein Schlüsselpaar erzeugt, erfolgt die Verbindung wie folgt:
<code>ssh &lt;user&gt;@&lt;server&gt; -i &lt;Pfad-zum-privaten-schlüssel&gt;</code>.
Mit dem Befehlsparameter <em>-i</em> wird der Pfad zum privaten
Schlüssel am Client angegeben.</p>
<p>Mehr zur Schlüsselauthenfikation finden Sie z.B. bei <a href="https://www.manageengine.com/key-manager/information-center/what-is-ssh-key-management.html" class="external-link">ManageEngine</a>
(hier v.a. die ersten drei Absätze).</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="schlüsselpaar-erstellen">Schlüsselpaar erstellen<a class="anchor" aria-label="anchor" href="#schl%C3%BCsselpaar-erstellen"></a>
</h3>
<p>Die Erstellung eines Schlüsselpaars erfolgt am Client. Dazu wird auf
der Kommandozeile (“Eingabeaufforderung” unter Windows) folgender Befehl
abgesetzt:
<code>ssh-keygen -t &lt;Schlüsseltyp&gt; -b &lt;Schlüssellänge&gt;</code>
Es müssen Angaben zum Speicherort und der Passphrase gemacht werden.
Wird kein Speicherort angegeben, wird das Schlüsselpaar im Ordner .ssh
des Benutzerverzeichnisses gespeichert.</p>
<p>Es stehen unterschiedliche Schlüsseltypen- und -längen zur
Verfügung:</p>
<ul>
<li><p>RSA: weit verbreitet, kann mit sehr viel Rechenaufwand evtl.
geknackt werden (siehe letzter Absatz <a href="https://www.onlinesicherheit.gv.at/Services/News/RSA-Verschluesselung-Sicherheit.html" class="external-link">dieses
Artikels</a>). Als Schlüssellänge sollte 4096 bit gewählt
werden.</p></li>
<li><p>ecdsa: ist ein neueres Verfahren, das aber kurze Schlüssel
nutzt.</p></li>
<li><p>ed25519: ist ein neues Verfahren, das auf sog. elliptische Kurven
setzt und als am sichersten gilt. Dieses Verfahren empfehle ich zu
nutzen.</p></li>
</ul>
<p>Zur Wahl des Schlüsseltyps gibt es bei <a href="https://goteleport.com/blog/comparing-ssh-keys/#rsa-vs-dsa-vs-ecdsa-vs-eddsa" class="external-link">goteleport.com</a>
eine informative Vergleichstabelle.</p>
<div id="wichitg" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="wichitg" class="callout-inner">
<h3 class="callout-title"><strong>WICHITG</strong></h3>
<div class="callout-content">
<p>Das Schlüsselpaar muss <strong>am Client</strong> erstellt werden.
Sonst ist der private Schlüssel bereits mit der Erstellung auf einem
fremden Gerät und damit kompromittiert.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="schlüssel-übertragen">Schlüssel übertragen<a class="anchor" aria-label="anchor" href="#schl%C3%BCssel-%C3%BCbertragen"></a>
</h3>
<p>Ist das Schlüsselpaar erzeugt, muss der <strong>öffentliche</strong>
(und nur der öffentliche!) Schlüssel zum Server übertragen werden (nur
zur Erinnerung: nur der <strong>öffentliche</strong> Schlüssel wird
übertragen). Dies kann je nach Betriebssystem des Clients
unterschiedlich bewerkstelligt werden.</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-1" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-1" type="button" role="tab" aria-controls="nav-tabpanel-1-1" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-1">
  Windows
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-2" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-2" type="button" role="tab" aria-controls="nav-tabpanel-1-2" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-2">
  Mac
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-3" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-3" type="button" role="tab" aria-controls="nav-tabpanel-1-3" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-3">
  Linux
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-1" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-1-1">
<p>Unter Windows muss das Programm scp genutzt werden, mit welchem über
eine SSH-Verbindung Dateien (in diesem Fall der öffentliche Schlüssel)
übertragen werden können:</p>
<p>Übertragung:
<code>scp &lt;öffentlicher-schlüssel.pub&gt; &lt;username&gt;@&lt;server&gt;:/home/&lt;username&gt;/Desktop</code></p>
<p>SSH-Verbindung zum Server aufbauen:
<code>ssh &lt;username&gt;@&lt;server&gt;</code></p>
<p>Verzeichnis erstellen: <code>mkdir .ssh</code></p>
<p>Datei für zugelassenen Schlüssel erstellen:
<code>touch .ssh/authorized_keys</code></p>
<p>Öffentlichen Schlüssel in Datei kopieren:
<code>cat Desktop/&lt;öffentlicher-schlüssel.pub&gt; &gt;&gt; .ssh/authorized_keys</code></p>
<p>Überprüfung: <code>cat .ssh/authorized_keys</code></p>
<p>SSH-Verbindung verlassen: <code>exit</code></p>
<p>SSH-Verbindung mit privatem Schlüssel testen:
<code>ssh &lt;username&gt;@&lt;server&gt; -i .ssh\&lt;privater-schlüssel&gt;</code></p>
</div>
<div id="nav-tabpanel-1-2" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-2">
<p>Mit macOS kann das Programm <em>ssh-copy-id</em> genutzt werden:
<code>ssh-copy-id -i &lt;öffentlicher-schlüssel.pub&gt; &lt;username&gt;@&lt;server&gt;</code></p>
<p>SSH-Verbindung mit privatem Schlüssel testen:
<code>ssh &lt;username&gt;@&lt;server&gt; -i .ssh/&lt;privater-schlüssel&gt;</code></p>
</div>
<div id="nav-tabpanel-1-3" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-3">
<p>Mit Linux kann das Programm <em>ssh-copy-id</em> genutzt werden:
<code>ssh-copy-id -i &lt;öffentlicher-schlüssel.pub&gt; &lt;username&gt;@&lt;server&gt;</code></p>
<p>SSH-Verbindung mit privatem Schlüssel testen:
<code>ssh &lt;username&gt;@&lt;server&gt; -i .ssh/&lt;privater-schlüssel&gt;</code></p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="konfiguration-des-ssh-servers">Konfiguration des SSH-Servers<a class="anchor" aria-label="anchor" href="#konfiguration-des-ssh-servers"></a>
</h2>
<hr class="half-width">
<p>Um die Sicherheit des SSH-Servers weiter zu erhöhen, sollten einige
Einstellungen am Server vorgenommen werden. Dies kann nach erfolgreicher
SSH-Verbindung getan werden. Die Konfigurationsdatei für den SSH-Server
findet sich unter <code>/etc/ssh/sshd_config</code> und kann mit dem
<em>nano</em>-Editor bearbeitet werden.</p>
<p>Folgende Änderungen sollten an der Konfigurationsdatei vorgenommen
werden:</p>
<ul>
<li><p>Nur spezifischen Usern eine SSH-Verbindung erlauben (neue Zeile
ergänzen): <code>AllowUsers &lt;username&gt;</code></p></li>
<li><p>Anmeldung mit Passwort verbieten und nur per Schlüssel erlauben
(vorhande Zeilen ändern):</p></li>
</ul>
<pre><code>PasswordAuthentication no
PubkeyAuthentication yes
KbdInteractiveAuthentication no
UsePAM no</code></pre>
<ul>
<li><p>Standardport ändern: <code>#Port 22</code> ändern zu
<code>Port &lt;eine Nummer größer 1024&gt;</code></p></li>
<li><p>Root-User-Anmeldungen verbieten:
<code>PermitRootLogin no</code></p></li>
<li><p>Zeit für erfolgreiche Anmeldeversuche auf 30 Sekunden limitieren:
<code>LoginGraceTime 30</code></p></li>
<li><p>Leere Passwörter verbieten:
<code>PermitEmptyPasswords no</code></p></li>
<li><p>Abmeldung bei Inaktivität: <code>ClientAliveInterval 300</code>
und <code>ClientAliveCountMax 0</code></p></li>
</ul>
<p>Nach Änderungen an der Konfiguration eines Programms muss dieses in
der Regel <strong>neu gestartet</strong> werden, um die neue
Konfiguration zu übernehmen. Dies geschieht für den SSH-Server mit dem
Befehl <code>sudo systemctl restart sshd.service</code> (siehe dazu auch
das <a href="#programme-mit-systemd-steuern">Callout zu systemd</a>)</p>
<p>Weitere Anpassungen des SSH-Servers sind je nach eigenem
Sicherheitsbedürfnis möglich. Z.B. finden sich bei <a href="https://www.cyberciti.biz/tips/linux-unix-bsd-openssh-server-best-practices.html" class="external-link">cyberciti.biz</a>
einige weitere Möglichkeiten.</p>
<p>Möchte man sich nun per SSH anmelden, müssen die vorgenommenen
Änderungen berücksichtigt werden. V.a. muss die geänderte Portnummer
angegeben werden:
<code>ssh -p &lt;Portnummer&gt; -i &lt;Pfad-zum-privaten-Schlüssel&gt; &lt;user&gt;@&lt;server&gt;</code></p>
<div id="programme-mit-systemd-steuern" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="programme-mit-systemd-steuern" class="callout-inner">
<h3 class="callout-title">Programme mit systemd Steuern</h3>
<div class="callout-content">
<p>Programme können unter Debian-basierten Systemen mit dem
Systemd-Dienst gesteuert werden. Voraussetzung dafür ist, dass eine sog.
Unit-Datei vorhanden ist (i.d.R. unter <code>/etc/systemd/system</code>
zu finden). Die Dienste können v.a. gestartet, gestoppt, neugestartet
und geprüft werden. Der Systemd-Dienst wird mit dem Befehl
<code>systemctl</code> (kurz für systemcontrol) bedient:</p>
<ul>
<li><p>Programm starten:
<code>sudo systemctl start &lt;Servicename&gt;</code></p></li>
<li><p>Programm stoppen:
<code>sudo systemctl stop &lt;Servicename&gt;</code></p></li>
<li><p>Programm neustarten
<code>sudo systemctl restart &lt;Servicename&gt;</code></p></li>
<li><p>Status überprüfen:
<code>sudo systemctl status &lt;Servicename&gt;</code></p></li>
<li><p>Ein Programm zum Autostart hinzufügen:
<code>sudo systemctl daemon-reload &amp;&amp; sudo systemctl enable &lt;Servicename&gt;</code></p></li>
</ul>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>das SSH-Protokoll erlaubt den Zugriff auf die Kommandozeile
entfernter Computer</p></li>
<li><p>zur Erhöhung der Sicherheit empfiehlt sich die Nutzung eines
Schlüsselpaares anstatt eines Passworts</p></li>
<li><p>zur Reduzierung der Angriffsfläche sollte die Konfiguration des
SSH-Servers angepasst werden</p></li>
<li><p>ein privater (SSH-)Schlüssel darf niemals das eigene Gerät
verlassen</p></li>
<li><p>der Aufbau der SSH-Verbindung geschieht wie folgt:
<code>ssh -p &lt;Portnummer&gt; -i &lt;Pfad-zum-privaten-Schlüssel&gt; &lt;user&gt;@&lt;server&gt;</code></p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-05-sicherheit-1"><p>Content from <a href="05-sicherheit-1.html">Sicherheit: Benutzer und Dateirechte</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/05-sicherheit-1.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Wer darf was auf meinem System?</p></li>
<li><p>Welche Benutzer gibt es unter Linux?</p></li>
<li><p>Was sind Dateirechte?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Grundlagen der Benutzerverwaltung unter Linux</p></li>
<li><p>Dateirechte verstehen und anpassen</p></li>
<li><p>Befehle <code>chmod</code>, <code>chown</code>,
<code>adduser</code>, <code>deluser</code> und <code>usermod</code>
kennen lernen</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="benutzerverwaltung">Benutzerverwaltung<a class="anchor" aria-label="anchor" href="#benutzerverwaltung"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="benutzerkategorien">Benutzerkategorien<a class="anchor" aria-label="anchor" href="#benutzerkategorien"></a>
</h3>
<p>Jeder User-Account in Linux besteht aus einem Loginnamen, einer
User-ID, ggf. einem beschreibendem Namen und weiteren Metainformationen
(z.B. Adresse, Telefonnummer etc). Auf einem üblichen Linux-System gibt
es drei Typen von Benutzerkonten:</p>
<ol style="list-style-type: decimal">
<li><p><strong>root</strong>: der Root-Account ist der
Systemadministrator und hat damit die meisten Rechte im System. Er ist
vergleichbar mit dem “Administrator”-Konto in Windows. Die User-ID des
root-Accounts ist immer die 1.</p></li>
<li><p><strong>Standardaccount</strong>: bei der Installation des
Raspberry Pi OS wurde bereits ein erster Standardaccount erstellt.
Standardaccounts sind i.d.R. mit echten Personen in Verbindung zu
bringen, haben ein Benutzerverzeichnis unter <code>/home/</code> und
können sich mit einem Passwort am System anmelden. Der erste
Standardbenutzer erhält die User-ID 1000. Für alle weiteren wird die ID
jeweils um 1 erhöht. Ein Standardaccount kann administrative Rechte
erhalten. Wurden ihm diese erteilt, können mit dem <a href="#sudo"><code>sudo</code>-Befehl</a> die eigenen Rechte eskaliert
werden, d.h. Befehle mit administrativen Rechten ausgeführt
werden.</p></li>
<li><p><strong>Systemaccount</strong>: Auf einem frisch installierten
Linuxsystem gibt es bereits zahlreiche Systemaccounts. Sie haben i.d.R.
User-IDs <code>&lt;</code> 1000. Systemuser sind nicht mit echten
Personen zu verbinden und können sich nicht interaktiv am System
anmelden. Ein Systemaccount ist im Normalfall für eine explizite Aufgabe
vorhanden. Z.B. ist der Account <em>www-data</em> für die Steuerung
eines Webservers gedacht.</p></li>
</ol>
<p>Sämtliche Benutzeraccounts des Systems können der Datei
<code>/etc/passwd</code> entnommen werden (z.B. öffnen mit
<code>less /etc/passwd</code>).</p>
<p>Möchte man einen neuen Account erstellen, nutzt man den Befehl
<code>adduser</code>. Um z.B. den Account “Linus” hinzuzufügen lautet
der Befehl wie folgt: <code>sudo adduser linus</code> Anschließend kann
das Passwort sowie weitere Metainformationen des Accounts gesetzt
werden. Es wird automatisch ein Homeverzeichnis für den User erstellt.
Möchte man dies nicht, kann der Parameter <code>--no-create-home</code>
dem Befehl angehängt werden.</p>
</div>
<div class="section level3">
<h3 id="gruppen">Gruppen<a class="anchor" aria-label="anchor" href="#gruppen"></a>
</h3>
<p>Neben einzelnen Accounts gibt es auch Gruppen, um mehrere Accounts
zusammen zu fassen. Standardmäßig ist jeder Account (System- und
Standardaccounts) auch Mitglied in seiner eigenen Gruppe. So ist z.B.
der Systemaccount <em>www-data</em> auch Mitglied in der Gruppe
<em>www-data</em>. Ein Account hat dabei immer die Rechte, die ihm
selbst erteilt wurden plus die Rechte, die den Gruppen erteilt wurden,
in welchen er Mitglied ist. Wird ein Recht an einer Stelle verweigert,
so hat dies Vorrang vor einer Erlaubnis an anderer Stelle.</p>
<p>Um zu sehen in welchen Gruppen man Mitglied ist, kann der Befehl
<code>id</code> genutzt werden. Der erste Standardbenutzer auf dem
Raspberry Pi OS ist in mehreren Gruppen Mitglied. Um alle Gruppen und
deren Mitglieder zu sehen kann die Datei <code>/etc/groups</code>
geöffnet werden.</p>
<p>Möchte man einen Account einer Account-Gruppe hinzufügen, nutzt man
den <code>usermod</code>-Befehl (kurz für user modification):
<code>sudo usermod -aG &lt;Gruppenname&gt; &lt;Username&gt;</code>
Möchte man einem Account administrative Rechte erteilen, muss dieser der
<em>sudo</em>-Gruppe hinzugefügt werden:
<code>sudo usermod -aG sudo &lt;Username&gt;</code></p>
</div>
<div class="section level3">
<h3 id="sudo">sudo<a class="anchor" aria-label="anchor" href="#sudo"></a>
</h3>
<p>Mit dem <code>sudo</code>-Befehl können die eigenen Benutzerrechte
eskaliert werden. Das heißt, Befehle mit erhöhten, also administrativen,
Rechten ausgeführt werden. Dazu muss lediglich das
<code>sudo</code>-Kommando vor den Befehl gestellt werden. Um z.B. einen
neuen Account zu erstellen, muss vor den entsprechenden Befehl das
<em>sudo</em> gestellt werden:
<code>sudo adduser &lt;username&gt;</code></p>
<div id="der-sudo-befehl" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="der-sudo-befehl" class="callout-inner">
<h3 class="callout-title">Der <code>sudo</code>-Befehl</h3>
<div class="callout-content">
<p>Um Befehle mit erhöhten Rechten auszuführen muss das
<code>sudo</code>-Kommando vor den Befehl gestellt werden, z.B.
<code>sudo adduser &lt;username&gt;</code></p>
</div>
</div>
</div>
<p>Der <code>sudo</code>-Befehl wird auch genutzt, um zwischen Accounts
zu wechseln oder Befehle mit den Rechten eines anderen Accounts
auszuführen. Um z.B. in den <em>Root</em>-Account zu wechseln genügt das
Kommando <code>sudo -i</code>. Anschließend befindet man sich auf der
Kommandozeile des Root-Accounts und alle Befehle werden mit Root-Rechten
ausgeführt. Dementsprechend sollte man hier Vorsicht walten lassen. Um
wieder zur vorhergehenden Kommandozeile des Standardaccounts zu kommen
wird die Root-Befehlszeile mit dem Befehl <code>exit</code>
verlassen.</p>
<p>Möchte man einen Befehl mit den Rechten eines anderen Accounts
ausführen geschieht dies wie folgt:
<code>sudo -u &lt;username&gt; &lt;Befehl&gt;</code> Um z.B. mit den
Rechten des Accounts <em>www-data</em> die Datei <em>startpage.html</em>
zu öffnen lautet der Befehl
<code>sudo -u www-data nano startpage.html</code></p>
<div class="section level4">
<h4 id="passwortabfrage-bei-sudo-befehl">Passwortabfrage bei sudo-Befehl<a class="anchor" aria-label="anchor" href="#passwortabfrage-bei-sudo-befehl"></a>
</h4>
<p>Um zu verhindern, dass der sudo-Befehl ohne die Kenntnis des
Passworts ausgeführt wird (z.B. wenn ein Angreifer einen Weg ins System
gefunden hat und nun Zugriff auf den Account hat), sollte das System so
konfiguriert werden, dass für den <code>sudo</code>-Befehl immer ein
Passwort verlangt wird. Dieses wird nach erstmaliger Eingabe für die
aktuelle Sitzung zwischengespeichert. Dazu muss die Datei
<code>/etc/sudoers.d/010_&lt;username&gt;-nopasswd</code> mit dem
<em>visudo</em>-Programm geöffnet werden:
<code>sudo visudo /etc/sudoers.d/010_&lt;username&gt;-nopasswd</code>
und wie folgt angepasst werden:</p>
<p>aus</p>
<pre><code>&lt;username&gt; ALL=(ALL) NOPASSWD: ALL</code></pre>
<p>wird</p>
<pre><code>&lt;username&gt; ALL=(ALL) PASSWD: ALL</code></pre>
<p>Dabei muss <code>&lt;username&gt;</code> durch den eigenen Usernamen
ersetzt werden. Siehe dazu auch die <a href="https://www.raspberrypi.com/documentation/computers/configuration.html#require-a-password-for-sudo-commands" class="external-link">offizielle
Raspberry-Pi-Dokumentation</a>.</p>
<div id="benutzerverwaltung-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="benutzerverwaltung-1" class="callout-inner">
<h3 class="callout-title">Benutzerverwaltung</h3>
<div class="callout-content">
<p>Sie sind mit Ihrem Standardaccount am System angemeldet, dieser hat
bereits administrative Rechte. Nun wollen Sie Ihrem System den neuen
Account <em>Linus</em> hinzufügen. Dieser Account soll ebenfalls
administrative Rechte erhalten. Wie lauten die korrekten Befehle?</p>
<ol style="list-style-type: decimal">
<li><p><code>sudo adduser linus</code> und
<code>sudo visudo /etc/sudoers.d/010_pi-nopasswd</code></p></li>
<li><p><code>adduser linus</code> und
<code>usermod -aG linus sudo</code></p></li>
<li><p><code>sudo adduser linus</code> und
<code>sudo usermod -aG sudo linus</code></p></li>
<li><p><code>sudo visudo linus</code> und
<code>sudo usermod -aG www-data linus</code></p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ul>
<li>Antwort 3 ist die richtige Lösung.</li>
</ul>
<p>Antwort 1 fügt zwar den User korrekt hinzu, aber der zweite Teil
ändert allenfalls Eintellungen für den Account Pi.</p>
<p>Bei Antwort 2 fehlt das <code>sudo</code>-Kommando vor den
eigentlichen Befehlen und beim usermod-Befehl sind user und Gruppe
vertauscht.</p>
<p>Bei Antwort 4 macht der erste Teil gar keinen Sinn und der zweite ist
zwar technisch korrekt, führt aber nicht zum gewollten Ziel.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="dateirechte">Dateirechte<a class="anchor" aria-label="anchor" href="#dateirechte"></a>
</h2>
<hr class="half-width">
<p>Jede Datei des Systems ist einem Besitzer und einer Gruppe
zugeordnet. Darüber kann gesteuert werden, wer auf welche Dateien mit
welchen Rechten zugreifen darf. Die genauen Rechte werden über den
sogenannten <strong><em>mode</em></strong> gesteuert. Der <em>mode</em>
gibt für jede Datei an, welche Rechte der Besitzer, die besitzende
Gruppe und “andere Accounts” haben. Andere Accounts sind dabei alle
anderen Accounts des Systems, auch Gastaccounts oder Systemaccounts.</p>
<p>Mit dem Befehl <code>ls -l &lt;Dateipfad&gt;</code> können die
Inhalte eines Verzeichnisses und deren Berechtigungen angezeigt werden.
Ohne Pfadangabe wird das aktuelle Verzeichnis gewählt. Die Ausgabe des
Befehls <code>ls -l /home/linus</code> könnte z.B. wie folgt
aussehen:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">total</span> 4</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">drwxrwxr-x</span> 2 linus linus 4096 Aug 21 15:35 Ordner1</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="ex">-rw-rw-r--</span> 1 linus linus   15 Aug 21 15:34 testdatei.txt</span></code></pre>
</div>
<p>Dies ist wie folgt zu verstehen:</p>
<ul>
<li><p><span style="color:rgb(165,30,55)"><strong>d</strong></span>rwxrwxr-x = es
handelt sich um ein Verzeichnis (d für directory, l für Link, - für
Datei)</p></li>
<li><p>d<span style="color:rgb(165,30,55)"><strong>rwx</strong></span>rwxr-x = der
Besitzer hat Lese- Schreib -und Ausführberechtigungen</p></li>
<li><p>drwx<span style="color:rgb(165,30,55)"><strong>rwx</strong></span>r-x = die
besitzende Gruppe hat Lese- Schreib -und Ausführberechtigungen</p></li>
<li><p>drwxrwx<span style="color:rgb(165,30,55)"><strong>r-x</strong></span> = alle anderen
haben nur Lese- und Ausführberechtigungen</p></li>
<li><p><span style="color:rgb(165,30,55)"><strong>linus</strong></span>
linus = die Datei/das Verzeichnis gehört dem User
<em>linus</em></p></li>
<li><p>linus <span style="color:rgb(165,30,55)"><strong>linus</strong></span> = die
Datei/das Verzeichnis gehört der Gruppe <em>linus</em></p></li>
<li><p><span style="color:rgb(165,30,55)"><strong>4096</strong></span> =
Dateigröße in Bytes</p></li>
<li><p><span style="color:rgb(165,30,55)"><strong>Aug 21
15:35</strong></span> = Änderungszeit</p></li>
<li><p><span style="color:rgb(165,30,55)"><strong>Ordner1</strong></span> =
Verzeichnis-/Dateiname</p></li>
</ul>
<p>Der ls-Befehl ist bei <a href="https://wiki.ubuntuusers.de/ls/" class="external-link">Ubuntuusers</a> auch ausführlich
erklärt.</p>
<p>Möchte man den Eigentümer einer Datei oder eines Verzeichnisses
ändern, wird der Befehl <code>chown</code> genutzt (kurz für change
ownership):
<code>chown &lt;neuer besitzer&gt;:&lt;neue Grupppe&gt; &lt;Datei/Verzeichnisname&gt;</code>.
Um z.B. die Datei <em>test.txt</em> dem User und der Gruppe
<em>linus</em> zu übertragen lautet der Befehl wie folgt:
<code>sudo chown linus:linus test.txt</code>. Soll ein gesamtes
Verzeichnis übertragen werden, wird der Parameter <code>-R</code>
(rekursiv) genutzt: <code>sudo chown -R linus:linus Ordner1</code></p>
<p>Möchte man den <em>mode</em> ändern (also die Rechte für Besitzer und
Gruppe), nutzt man den Befehl <code>chmod</code> (kurz für change mode):
<code>sudo chmod &lt;Modus&gt; &lt;Datei/Verzeichnis&gt;</code> Der
Modus setzt sich dabei stets aus drei Angaben zusammen:</p>
<ol style="list-style-type: decimal">
<li>
<p>Angabe für wen etwas geändert wird (Gruppe oder Account)</p>
<ul>
<li><p><code>u</code> = user</p></li>
<li><p><code>g</code> = group</p></li>
<li><p><code>o</code> other (=alle anderen)</p></li>
</ul>
</li>
<li>
<p>Angabe, ob ein Recht erteilt oder entzogen werden soll</p>
<ul>
<li><p><code>+</code> = Recht erteilen</p></li>
<li><p><code>-</code> = Recht entziehen</p></li>
</ul>
</li>
<li>
<p>Angabe zum betroffenen Recht.</p>
<ul>
<li><p><code>r</code> = read (Leseberechtigung)</p></li>
<li><p><code>w</code> = write (Schreibbrechtigung)</p></li>
<li><p><code>e</code> = execute (Ausführen von Dateien oder
Verzeichnisinhalt von Ordnern anzeigen lassen)</p></li>
</ul>
</li>
</ol>
<p>Eine ausführliche Erklärung zu Dateirechten findet sich wieder bei <a href="https://wiki.ubuntuusers.de/Rechte/" class="external-link">Ubuntuusers</a></p>
<div class="section level4">
<h4 id="beispiel">Beispiel<a class="anchor" aria-label="anchor" href="#beispiel"></a>
</h4>
<p>Die Datei <em>test.txt</em> gehört dem User <em>linus</em> und der
Gruppe <em>www-data</em>. Um nun dem User Lese- Schreib- und
Ausführberechtigung zu erteilen, der Gruppe aber nur Leserechte, lauten
die Befehle wie folgt: <code>sudo chmod u+rwx testdatei.txt</code> für
die Userberechtigung und <code>sudo chmod g+r testdatei.txt</code> für
die Gruppenberechtigung. Möchte man der Gruppe www-data wieder das
Leserecht entziehen, lautet der Befehl wie folgt:
<code>sudo chmod g-r testdatei.txt</code></p>
<div id="dateiberechtigungen" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="dateiberechtigungen" class="callout-inner">
<h3 class="callout-title">Dateiberechtigungen</h3>
<div class="callout-content">
<p>Sie wollen mit Ihrem Standardaccount (dieser ist Mitglied der
sudo-Gruppe) im Verzeichnis <code>/opt/</code> den neuen Ordner
<code>webservice</code> erstellen. Der Ordner soll dem User
<em>linus</em> und der Gruppe <em>www-data</em> gehören. Der User soll
volle Rechte haben, die Gruppe soll lesen und ausführen dürfen, alle
anderen sollen keine Rechte erhalten. Wie lauten die korrekten
Befehle?</p>
<ol style="list-style-type: decimal">
<li><ul>
<li><p><code>mkdir /opt/webservice</code></p></li>
<li><p><code>chown linus:www-data /opt/webservice</code></p></li>
<li><p><code>chmod 750</code></p></li>
</ul></li>
<li><ul>
<li><p><code>sudo mkdir /opt/webservice</code></p></li>
<li><p><code>sudo chown linus:www-data /opt/webservice</code></p></li>
<li><p><code>sudo chmod u+rwx</code></p></li>
<li><p><code>sudo chmod g+r</code></p></li>
<li><p><code>sudo chmod o-rwx</code></p></li>
</ul></li>
<li><ul>
<li><p><code>sudo touch /opt/webservice</code></p></li>
<li><p><code>sudo chmod linus:www-data /opt/webservice</code></p></li>
<li><p><code>sudo chown u+rwx</code></p></li>
<li><p><code>sudo chown g+r</code></p></li>
<li><p><code>sudo chown o-rwx</code></p></li>
</ul></li>
<li><ul>
<li><p><code>sudo mkdir /opt/webservice</code></p></li>
<li><p><code>sudo chown linus:www-data /opt/webservice</code></p></li>
<li><p><code>chmod linus:+rwx</code></p></li>
<li><p><code>chmod www-data:+r</code></p></li>
<li><p><code>chmod others:-rwx</code></p></li>
</ul></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<ul>
<li>Antwort 2 ist korrekt. Die drei <code>chmod</code>-Befehle könnten
noch durch <code>sudo chmod 750</code> zusammengefasst werden, siehe
dazu den <a href="https://wiki.ubuntuusers.de/Rechte/#Darstellungsarten" class="external-link">Ubuntuusers-Artikel
zu Dateirechten</a>
</li>
</ul>
<p>Antwort 1 schlägt fehl, da keine administrativen Rechte genutzt
werden</p>
<p>Antwort 3 erstellt eine Datei anstatt eines Verzeichnisses. Außerdem
sind die Befehle <code>chmod</code> und <code>chown</code>
vertauscht.</p>
<p>In Antwort 4 ist der <code>chmod</code>-Befehl fehlerhaft</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>der <em>root</em>-Account ist der Administrator des
Systems</p></li>
<li><p>Mitglieder der <em>sudo</em>-Gruppe haben administrative Rechte,
welche sie mit dem <code>sudo</code>-Kommando nutzen können</p></li>
<li><p>Dateien und Ordner sind immer einem Benutzer und einer Gruppe
zugeordnet. Die Besitzverhältnisse können mit <code>chown</code>
geändert werden.</p></li>
<li><p>Dateien und Ordner haben einen <em>mode</em>, welcher die Rechte
von Besitzer und besitzender Gruppe steuert, er kann mit
<code>chmod</code> geändert werden</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-06-sicherheit-ii"><p>Content from <a href="06-sicherheit-ii.html">Sicherheit: Firewall und Fail2Ban</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/06-sicherheit-ii.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Wie kommunizieren Computer im Netzwerk?</p></li>
<li><p>Wie schütze ich meinen Server im Netzwerk?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Grundlagen der Netzwerkkommunikation verstehen</p></li>
<li><p>Eine einfache Firewall einrichten</p></li>
<li><p>Fehlerhafte Logins mit Fail2Ban überwachen</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="netzwerkkommunikation">Netzwerkkommunikation<a class="anchor" aria-label="anchor" href="#netzwerkkommunikation"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="osi-referenz-modell">OSI-Referenz-Modell<a class="anchor" aria-label="anchor" href="#osi-referenz-modell"></a>
</h3>
<p>Um allgemeine Leitlinien für Hersteller von Hard- und Software zu
etablieren, wurde das OSI-Referenz-Modell entwickelt, welches die
Kommunikationsabläufe in Computernetzwerken definiert. Gemäß dem Modell
läuft ein Datenpaket beim Sender durch sieben Kommunikationsschichten
und beim Empfänger wieder durch die selben Schichten, allerdings in
umgekehrter Reihenfolge. Jede dieser Schichten hat klar definierte
Aufgaben und spezifische Protokolle. Ein Datenpaket wird dabei in einer
Schicht verarbeitet, z.B. in der obersten Schicht
(<em>Anwendungsschicht</em>) per HTTP abgerufen und dann an die nächste
Schicht übergeben. Dort werden weitere Schritte unternommen. Z.B. könnte
das jetzt fertig geschnürte HTTP-Paket zu einem HTTPS-Paket
verschlüsselt werden. Am untersten Ende (auf der
<em>Bitübertragungsschicht</em>) wird schließlich nur noch festgelegt,
wie der Strom über die Leitung fließt.</p>
<p>Da auf jeder Schicht beim Sender weitere Informationen zum Datenpaket
hinzugefügt werden (z.B. eine Veschlüsselung oder die IP-Adresse des
Empfängers) wird das Datenpaket immer größer (sog. Overhead). Beim
Empfänger wird das Paket wieder Schritt für Schritt “ausgepackt”.</p>
<p>Eine ausführliche Erklärung zum OSI-Modell inkl. Video findet sich
bei <a href="https://studyflix.de/informatik/osi-modell-5524" class="external-link">Studyflix</a>.</p>
</div>
<div class="section level3">
<h3 id="ip-basierte-netzwerke">IP-basierte Netzwerke<a class="anchor" aria-label="anchor" href="#ip-basierte-netzwerke"></a>
</h3>
<p>Um Kommunikationspartner im Netzwerk zu identifizieren, besitzt jedes
Netzwerkfähige Gerät (genauer gesagt: jedes Netzwerinterface) eine
Hardwareadresse: die <strong>MAC-Adresse</strong>. Die MAC-Adresse ist
auf Schicht 2 des OSI-Modells definiert. Um nun zu definieren, wo sich
diese MAC-Adresse im Netzwerk befindet, werden in Schicht 3 des
OSI-Modells <strong>IP-Adressen</strong> eingeführt. Mit IP-Adressen
werden zunächst logische Netzwerksegmente definiert. Dabei wird jedes
Netzwerk mit einer IP-Adresse beschrieben. Diese Netzwerkadresse ist der
Startpunkt des Netzwerkes (z.B. <code>192.168.178.0</code>). Mit der
Subnetzmaske wird die Anzahl an möglichen Adressen innerhalb des
Netzwerks festlegt (z.B. <code>255.255.255.0</code> oder in Kurzform
<code>/24</code> für ein Netzwerk mit max. 254 Geräten). Innerhalb eines
Netzwerks werden einzelne Geräte durch eine IP-Adresse definiert (z.B.
192.168.178.25). Wandert das Gerät in ein anderes Netzwerksegment erhält
es eine andere IP-Adresse.</p>
<p>Um eine Kommunikation zwischen verschiedenen Netzwerken (z.B. einem
Heimnetzwerk mit der Adresse 192.168.178.0 und der Subnetzmaske
255.255.255.0 und dem Internet) zu ermöglichen, wird ein Standardgateway
benötigt. Dies ist i.d.R. die IP-Adresse des Routers. An diesen werden
alle Pakete geschickt, die keine Adresse im lokalen Netzwerk haben, und
werden dann z.B. ins Internet weiter geleitet.</p>
<p>Es werden unterschiedliche Typen von Netzwerken unterschieden:
Private Netzwerke und öffentliche Netzwerke. Private Netzwerke sind
nicht öffentlich erreichbar und sind durch Router und Firewalls von
öffentlichen Netzwerken getrennt. Dadurch können private Netzwerke mit
derselben IP-Adresskonfiguration mehrfach existieren, da sie sich
gegenseitig nicht “sehen”.</p>
<p>Folgende Adressbereiche für private Netzwerke gibt es:</p>
<table class="table">
<caption>Private Adressbereiche und spezielle Netzwerke</caption>
<colgroup>
<col width="28%">
<col width="16%">
<col width="11%">
<col width="43%">
</colgroup>
<thead><tr class="header">
<th>Netzadressbereich</th>
<th align="left">Subnetzmaske</th>
<th align="left">Max. Anzahl Geräte</th>
<th>Bedeutung</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>10.0.0.0 bis 10.255.255.0</td>
<td align="left">255.0.0.0</td>
<td align="left">16777216</td>
<td>Privates Netzwerk</td>
</tr>
<tr class="even">
<td>172.16.0.0 bis 172.31.255.255</td>
<td align="left">255.240.0.0</td>
<td align="left">1048576</td>
<td>Privates Netzwerk</td>
</tr>
<tr class="odd">
<td>192.168.0.0 bis 192.168.255.255</td>
<td align="left">255.255.0.0</td>
<td align="left">256</td>
<td>Privates Netzwerk</td>
</tr>
<tr class="even">
<td>169.254.0.0 bis 169.254.255.255</td>
<td align="left">255.255.0.0</td>
<td align="left">65536</td>
<td>Link Local/APIPA = Standardbereich, wenn automatische
Adresszuweisung fehlschlägt</td>
</tr>
<tr class="odd">
<td>127.0.0.1 bis 127.255.255.254</td>
<td align="left">255.0.0.0</td>
<td align="left">16777216</td>
<td>Loopback-Adresse für Kommunikation innerhalb eines Geräts</td>
</tr>
</tbody>
</table>
<div id="ip-adressen" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ip-adressen" class="callout-inner">
<h3 class="callout-title">IP-Adressen</h3>
<div class="callout-content">
<p>Werden zentrale Dienste betrieben oder genutzt, muss man sich auch
mit dem zugrunde liegenden Netzwerk befassen. Informieren Sie sich
deshalb über Ihr Netzwerk:</p>
<ul>
<li><p>Welche IP-Adresse hat Ihr Computer?</p></li>
<li><p>Wie lautet die Subnetzmaske?</p></li>
<li><p>Welche IP-Adressen können Geräte in Ihrem Netzwerk
erhalten?</p></li>
<li><p>Welche IP-Adressen hat Ihr Router?</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Typische Adressen könnten wie folgt lauten:</p>
<ul>
<li><p>IP-Adresse: 192.168.178.25</p></li>
<li><p>Subnetzmaske: 255.255.255.0</p></li>
<li><p>Daraus folgt der Adressbereich 192.168.178.1 bis 192.168.178.254
(die erste Adresse ist als Netzwerkadresse und die letzte als sogenannte
Broadcastadresse reserviert und nicht für Geräte verfügbar).</p></li>
<li><p>Router geben sich meistens selbst die erste Adresse im Netzwerk,
in diesem Beispiel also 192.168.178.1. Zusätzlich erhält der Router auch
eine IP-Adresse im Netzwerk des Internetanbieters. Erst dadurch, dass
der Router in beiden Netzwerken eine Adresse hat, kann er auch
Datenpakete zwischen den Netzwerken verteilen.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="ports">Ports<a class="anchor" aria-label="anchor" href="#ports"></a>
</h3>
<p>Ist ein Datenpaket innerhalb eines IP-Netzwerks an einem Host (also
einem Gerät) angekommen, muss noch geklärt werden, wohin das Paket
innerhalb des Geräts gehört. Da auf einem Computer viele Programme
gleichzeitig aktiv sind, muss entschieden werden, für welches der
Programme ein Paket gedacht ist. Dazu werden <strong>Ports</strong>
genutzt. Ein Programm, welches Daten aus dem Netzwerk empfangen soll,
nutzt dabei einen bestimmten Port. Kommt am Gerät ein Datenpaket an, das
mit dem Port des Programms adressiert ist, wird das Paket an das
entsprechende Programm geleitet und von diesem verarbeitet. Zum Beispiel
“lauscht” der SSH-Server standardmäßig auf Port 22 für eingehenden
Datenverkehr. Wir haben diesen Port in <a href="04-remote-access.html">Lektion 4</a> manuell abgeändert.</p>
<p>Einige Ports sind fest für bestimmte Programme definiert und sollten
nicht von anderen Programmen oder manuell belegt werden. Andere Ports
können jedoch von Systemadministratoren frei genutzt werden. Die
Portnummern reichen von 0 bis 65.535. Eine Auflistung aller Ports findet
sich bei <a href="https://de.wikipedia.org/wiki/Liste_der_standardisierten_Ports" class="external-link">Wikipedia</a>.</p>
<p>Ein Port kann auf einem Gerät offen oder geschlossen sein, z.B. kann
eine Firewall die Kommunikation über einen Port blockieren. Außerdem
muss ein Prozess hinter einem Port “hören”, damit eine Kommunikation
aufgebaut werden kann.</p>
<p>Um zu sehen, welche Prozesse auf welchen Ports hören, kann der Befehl
<code>netstat -tulp</code> ausgeführt werden. Vorher muss dafür das
Paket <em>net-tools</em> installiert werden.</p>
</div>
</section><section><h2 class="section-heading" id="firewall">Firewall<a class="anchor" aria-label="anchor" href="#firewall"></a>
</h2>
<hr class="half-width">
<p>Um Kommunikation in einem Netzwerk zu kontrollieren, werden Firewalls
eingesetzt. Zu unterscheiden ist hierbei zwischen <em>Hardware- und
Desktopfirewalls.</em> Eine Hardware- oder auch externe Firewall ist in
der Regel ein dediziertes Gerät, welches primär unterschiedliche
Netzwerke trennt. In einfacher Form kommt ein Heimrouter wie eine
Fritz.Box dieser Aufgabe nach. Denn der Router trennt mit seiner
Firewall das Internet vom Heimnetz und verhindert dadurch, dass aus dem
Internet auf Geräte im Heimnetzwerk zugegriffen werden kann. In
komplexeren Netzwerken (z.B. in Unternehmen) werden professionellere
Geräte eingesetzt, welche mehr Funktionalität bieten.</p>
<p>Eine Desktop- oder auch personal firewall dagegen ist meistens in
Form von Software auf einem Gerät installiert. Unter Microsoft Windows
wäre dies die Windows Defender Firewall, die den PC vor Zugriffen aus
einem angeschlossenen Netzwerk schützt. Unter Linux kann dafür die
<strong>uncomplicated firewall</strong> (kurz: UFW) genutzt werden.</p>
<div class="section level3">
<h3 id="funktionsweise">Funktionsweise<a class="anchor" aria-label="anchor" href="#funktionsweise"></a>
</h3>
<p>Vereinfacht kann die Funktionsweise einer Firewall in mehrere
Bereiche unterteilt werden. Dabei unterstützt nicht jede Firewall alle
dieser Funktionen.</p>
<ul>
<li><p>Paketfilter: filtert nach Adressen der Datenpakete (IP-Adressen,
MAC-Adressen, Ports, URLs) -&gt; <strong>Wer darf
wohin?</strong></p></li>
<li><p>Content/Proxy/Deep Packet-Filter: filtert nach dem Inhalt und
kann so spezifische Inhalte blockieren. Z.B. kann Malware erkannt werden
-&gt; <strong>Was darf unterwegs sein?</strong></p></li>
<li><p>Kombinierte Filter: durch die Kombination verschiedener Kriterien
wie Uhrzeit, Herkunft der Anfrage, Ziel der Anfrage oder die Häufigkeit
der Anfrage kann Datenverkehr blockiert oder erlaubt werden -&gt;
<strong>wie darf etwas unterwegs sein?</strong></p></li>
<li><p>Geoblocking: häufig bieten Firewalls auch die Möglichkeit,
Anfragen aus bestimmten Ländern zu blockieren. Allerdings können
Angreifer solche Blockaden umgehen, indem sie Ihre Anfragen über Server
in nicht blockierten Ländern leiten. Dennoch kann ein Geoblocking
bisweilen massenhafte und wenig zielgerichtete Angriffsversuche
unterbinden. -&gt; <strong>Woher darf etwas kommen?</strong></p></li>
</ul>
<p>Ist ein Filterkriterium erfüllt, wird eine Aktion ausgeführt. Wird
ein Paket <strong>verworfen</strong> (drop oder deny), wird es schlicht
nicht weitergeleitet. Der Absender erhält darüber keine Auskunft. Wird
ein Paket <strong>zurückgewiesen</strong> (deny oder reject) wird das
Paket ebenfalls nicht weitergeleitet, der Absender wird allerdings
direkt über den Kommunikationsabbruch informiert. Wird das Paket
<strong>aktezptiert</strong> wird es an die Zieladresse
weitergeleitet.</p>
</div>
<div class="section level3">
<h3 id="allgemeine-tips-zur-firewall">Allgemeine Tips zur Firewall<a class="anchor" aria-label="anchor" href="#allgemeine-tips-zur-firewall"></a>
</h3>
<ul>
<li><p>die Firewall sollte immer aktiv sein</p></li>
<li><p>standardmäßig sollten eingehende Verbindungen blockiert
werden</p></li>
<li><p>eingehende Verbindungen sollten nur für einzelne Ports und
Anwendungen geöffnet werden</p></li>
<li><p>Sicherheit durch alternative Ports (wie beim SSH-Server) bringt
nur ein wenig (siehe dazu den Wikipedia-Artikel zu <a href="https://de.wikipedia.org/wiki/Security_through_obscurity" class="external-link">Security
through obscurity</a>)</p></li>
<li><p>ein im Netzwerk exponiertes Programm (inkl. dem Betriebssystem)
muss immer aktuell gehalten werden</p></li>
<li><p>die Kommunikation sollte über verschlüsselte Protokolle
stattfinden (TLS, SSH, HTTPS…)</p></li>
<li><p>für noch mehr Sicherheit kann gesorgt werden, wenn auch der
ausgehende Datenverkehr gefiltert wird und nur explizit notwendige
Anfragen, z.B. für Softwareupdates, zugelassen werden aber Anfragen ins
lokale Netzwerk unterbunden werden. Siehe dazu ein <a href="https://www.linux-tips-and-tricks.de/en/raspberry/430-secure-raspberry-pi-against-internet-attacks-and-disable-attacks-into-the-local-network-with-a-firewall-using-iptables" class="external-link">Beispiel</a>
mit der IP-Tables-Firewall</p></li>
<li><p>Für Fortgeschrittene: mittels Port-knocking kann die Firewall nur
kurzzeitig und explizit geöffnet werden und nach dem Ende der
Kommunikation wieder geschlossen werden. Siehe dazu z.B. <a href="https://www.linuxbabe.com/security/secure-ssh-service-port-knocking-debian-ubuntu" class="external-link">dieses
Tutorial</a> im Netz.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="umsetzung-am-raspberry-pi">Umsetzung am Raspberry Pi<a class="anchor" aria-label="anchor" href="#umsetzung-am-raspberry-pi"></a>
</h3>
<ul>
<li><p>Installation: <code>sudo apt-get install ufw</code></p></li>
<li><p>Regel hinzufügen: <code>sudo ufw allow &lt;Portnummer&gt;</code>
oder <code>sudo ufw deny &lt;Portnummer&gt;</code></p></li>
<li><p>Standardregel für eingehenden Verkehr:
<code>sudo ufw default deny incoming</code></p></li>
<li><p>Standardregel für ausgehenden Verkehr:
<code>sudo ufw default allow outgoing</code></p></li>
<li><p>Zugriff auf SSH-Port nur aus dem lokalen Netzwerk zulassen
(Netzwerkadresse anpassen!):
<code>sudo ufw allow from 192.168.178.0/24 to any port 22</code></p></li>
<li><p>aktivieren: <code>sudo ufw enable</code></p></li>
<li><p>Status anzeigen lassen: <code>sudo ufw status</code></p></li>
<li><p>Status mit Nummer anzeigen lassen:
<code>sudo ufw status numbered</code></p></li>
<li><p>Regel löschen:
<code>sudo ufw delete &lt;Nummer-der-Regel&gt;</code></p></li>
</ul>
<p>Im Netz finden sich zahlreiche Anleitungen für die UFW.
Empfehlenswert finde ich die Anleitungen von <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-20-04-de" class="external-link">DigitalOcean</a>
und <a href="https://pimylifeup.com/raspberry-pi-ufw/" class="external-link">PiMyLifeUp</a></p>
</div>
</section><section><h2 class="section-heading" id="fail2ban">Fail2Ban<a class="anchor" aria-label="anchor" href="#fail2ban"></a>
</h2>
<hr class="half-width">
<p>Nachdem in der (uncomplicated) Firewall ein Port geöffnet wurde, wird
die Kommunikation mit dem hinter dem Port wartenden Dienst aufgebaut.
Jedoch ist es empfehlenswert diese Kommunikation weiterhin im Blick zu
behalten.</p>
<p>Für einfache Szenarien kann das Programm <strong>Fail2Ban</strong>
genutzt werden, um unerwünschte Eindringversuche zu erkennen und zu
blockieren. Ein typischer Angriffsversuch, welcher mit Fail2Ban
abgefangen werden kann, ist eine Brute-Force-Attacke, bei welcher durch
massenhafte Anfragen versucht wird, Benutzername und Passwort zu
erraten. Die dabei unweigerlich zahlreich auftretenden Fehlversuche
werden in einer Protokolldatei im System notiert. Durch die Überwachung
dieser Protokolldatei (auch als Logdatei bezeichnet) kann Fail2Ban die
Absenderadresse der massenhaften Loginversuche erkennen und blockieren,
indem die Adresse der Firewall als zu blockierende Adresse mitgeteilt
wird.</p>
<p>Zu Fail2Ban gibt es im Netz verschiedne Anleitungen. Z.B. im
offiziellen <a href="https://www.raspberrypi.com/documentation/computers/configuration.html#block-suspicious-activity-with-fail2ban" class="external-link">Raspberry
Pi Handbuch</a> oder wieder bei <a href="https://pimylifeup.com/raspberry-pi-fail2ban/" class="external-link">PiMyLifeUp</a>.</p>
<div class="section level3">
<h3 id="umsetzung-am-raspberry-pi-1">Umsetzung am Raspberry Pi:<a class="anchor" aria-label="anchor" href="#umsetzung-am-raspberry-pi-1"></a>
</h3>
<ul>
<li><p>Installation: <code>sudo apt-get install fail2ban</code></p></li>
<li><p>Aktivierung:
<code>sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local</code></p></li>
<li>
<p>Beispielkonfiguration der Standardparameter mittels
<code>sudo nano /etc/fail2ban/jail.local</code></p>
<ul>
<li><p>Standard Sperrzeit: <code>bantime = 20m</code></p></li>
<li><p>Standardanzahl möglicher Fehlversuche:
<code>maxretry = 3</code></p></li>
<li><p>Standardzeit für “maxretry”: <code>findtime = 10m</code></p></li>
</ul>
</li>
<li>
<p>Zu überwachende Services/Ports werden am Ende der Datei
<code>/etc/fail2ban/jail.local</code> mit <code>[&lt;Name&gt;]</code>
definiert und mit Detaileinstellungen konfiguriert:</p>
<ul>
<li><p>Aktivierung: <code>enabled = true</code></p></li>
<li><p>Angabe des Ports:
<code>port = &lt;Portnummer des Services</code></p></li>
<li><p>Angabe der zu überwachenden Logdatei:
<code>logpath = &lt;Pfad zur Logdatei&gt;</code></p></li>
<li><p>Angabe des Filters, mit dem die Logdatei geprüft wird:
<code>filter = &lt;Name der Datei im Verzeichnis /etc/fail2ban/filter.d/&gt;</code></p></li>
</ul>
</li>
<li><p>Beispiel für den SSH-Server:</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#Standardeinstellungen vornehmen</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">bantime</span> = 60m </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">findtime</span> = 15m</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="ex">maxretry</span> = 3 </span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># Im Bereich [sshd]</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="ex">[sshd]</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="ex">enabeld</span> = true</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="ex">port</span> = <span class="op">&lt;</span>ssh-port<span class="op">&gt;</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="ex">logpath</span> = %<span class="er">(</span><span class="ex">sshd_log</span><span class="kw">)</span><span class="ex">s</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="ex">backend</span> = systemd</span></code></pre>
</div>
<div id="netzwerksicherheit" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="netzwerksicherheit" class="callout-inner">
<h3 class="callout-title">Netzwerksicherheit</h3>
<div class="callout-content">
<p>Sie sollen für Ihre Arbeitsgruppe einen kleinen Server mit diversen
Diensten betreiben (z.B. einen Cloudserver). Wie gewährleisten Sie die
Netzwerksicherheit, um unbefugten Zugriff auf den Server zu
verhindern?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Einige wichtige und grundlegende Maßnahmen können sein:</p>
<ul>
<li><p>Firewall auf dem Server aktivieren</p></li>
<li><p>Eingehende Verbindungen blockieren</p></li>
<li><p>nur einzelne Ports für die notwendigen Dienste und nur innerhalb
des lokalen Netzwerkes freigeben</p></li>
<li><p>Mit Fail2Ban oder vergleichbaren Tools fehlerhafte Loginversuche
überwachen</p></li>
<li><p>Regelmäßige Wartung: Sowohl der Server als auch alle anderen
Netzwerkkomponenten (Router, Switche etc) müssen stets mit aktueller
Soft- und oder Firmware ausgestattet werden.</p></li>
<li><p>der SSH-Serverdienst sollte entsprechend <a href="04-remote-access.html">Kapitel 4</a> konfiguriert werden</p></li>
<li><p>Noch mehr Sicherheit erhalten Sie durch eine
Netzwerksegmentierung: sie trennen das Netzwerk in mehrere logische
Bereiche auf, zwischen denen ein Router mit Firewall
vermittelt.</p></li>
</ul>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>Computer kommunizieren im Netzwerk nach Standards, das
OSI-Schichten-Modell stellt einen Leitrahmen für diese Standards
dar</p></li>
<li><p>Versendete Daten im Netzwerk haben immer einen Absender- und
einen Empfänger (in Form von MAC-Adresse, Netzwerk-ID, IP-Adresse und
Port)</p></li>
<li><p>Mit einer Firewall können Ports geöffnet und geschlossen
werden</p></li>
<li><p>Mit Fail2Ban können fehlerhafte Loginversuche festgestellt und
blockiert werden</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-07-installationsvorbereitung-1"><p>Content from <a href="07-installationsvorbereitung-1.html">Installationsvorbereitung 1</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/07-installationsvorbereitung-1.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Wie kann ich Datenverlust vermeiden?</p></li>
<li><p>Wie kann ich meinen Speicherplatz erweitern?</p></li>
<li><p>Wie beginne ich die Installation von Nextcloud?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Backups des gesamten Betriebssystems erstellen</p></li>
<li><p>Dateisysteme erstellen und einbinden</p></li>
<li><p>Programmkomponenten von Nextcloud verstehen</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="systembackup">Systembackup<a class="anchor" aria-label="anchor" href="#systembackup"></a>
</h2>
<hr class="half-width">
<p>Nachdem der Raspberry Pi in den bisherigen Lektionen grundlegend
eingerichtet wurde, empfiehlt es sich nun den aktuellen Stand zu
sichern. Dadurch besteht später die Möglichkeit diese Sicherung wieder
herzustellen für den Fall, dass bei der weiteren Arbeit etwas schief
geht.</p>
<p>Um das gesamte System zu sichern, muss die SD-Karte (bzw. der
Datenträger auf welchem das System installiert ist) geklont werden.
Dabei wird ein Image aller Partitionen erstellt. Dieses kann später wie
das Image eines Betriebssystems neu auf die SD-Karte installiert werden.
Um alle Daten sauber kopieren zu können, muss der Raspberry Pi
heruntergefahren werden und anschließend wird SD-Karte mit Hilfe eines
anderen Computers kopiert. Je nach Betriebssystem dieses anderen
Computers bestehen unterschiedliche Möglichkeiten. Nachfolgend werden
für jedes Betriebsystem eine Möglichkeit vorgestellt.</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-1" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-1" type="button" role="tab" aria-controls="nav-tabpanel-1-1" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-1">
  Windows
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-2" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-2" type="button" role="tab" aria-controls="nav-tabpanel-1-2" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-2">
  Linux
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-3" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-3" type="button" role="tab" aria-controls="nav-tabpanel-1-3" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-3">
  MacOS
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-1" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-1-1">
<p>Unter Windows kann das Programm Win32 Disk Imager genutzt werden. Das
Programm ist etwas in die Jahre gekommen, funktioniert aber noch. Das
Programm kann bei <a href="https://sourceforge.net/projects/win32diskimager/" class="external-link">Sourceforge</a>
heruntergeladen werden. Nach der Installation wird die SD-Karte mit dem
PC verbunden und anschließend in Win32 Disk Imager als
<em>Datenträger</em> ausgewählt, ein Speicherpfad für das Backup
angegeben (Dateiendung: .img) und der Datenträger eingelesen.
Anschließend ist die Backup-Datei genau so groß wie der gesamte
gesicherte Datenträger, da auch der freie Speicherplatz mitgesichert
wurde. Deshalb empfiehlt es sich die Datei mit 7Zip oder anderen
Kompressionsprogrammen zu komprimieren.</p>
<figure><img src="../fig/07_Win32_Disk_Imager.png" alt="Screenshot des Win32 Disk Imagers. Mit Nummern werden die einzelen Schritte hervorgehoben, die nötig sind, um ein Backup zu erstellen. 1. Speicherpfad angeben, zweitens Datenträger wählen, drittens Lesen-Button betätigen" class="figure mx-auto d-block"><div class="figcaption">SD-karte mit Win 32 Disk Imager sichern: 1.
Speicherpfad angeben, 2. Datenträger wählen, 3. Lesen-Button
betätigen</div>
</figure>
</div>
<div id="nav-tabpanel-1-2" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-2">
<p>Für Linux steht das Kommandozeilen-Programm <strong>dd</strong> zu
Verfügung. Damit kann das Image erstellt und gleichzeitig kopiert
werden. Oder die Schritte werden nach einander ausgeführt.</p>
<ul>
<li>In einem Schritt:
<code>dd if=/dev/sdb | gzip &gt; /Home/User/Desktop/backup.gz</code>
</li>
</ul>
<p>Dabei ist <em>/dev/sdb</em> der Pfad zur Gerätedatei der SD-Karte</p>
<ul>
<li>In zwei Schritten (evtl. sinnvoll, wenn die Geschwindigkeit zu
langsam ist, benötigt aber mehr (temporären) Speicherplatz):
<code>dd if=/dev/sdb of=/Home/User/Desktop/backup.img bs=1M</code> und
<code>gzip /Home/User/Desktop/backup.img</code>
</li>
</ul>
<p>Eine Anleitung zu dd findet sich z.B. bei <a href="https://www.bitblokes.de/sd-karte-des-raspberry-pi-sichern-dd-oder-partclone/" class="external-link">Bitblokes.de</a></p>
</div>
<div id="nav-tabpanel-1-3" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-3">
<p>Für MacOS steht das Kommandozeilen-Programm <strong>dd</strong> zu
Verfügung. Damit kann das Image erstellt und gleichzeitig kopiert
werden. Oder die Schritte werden nach einander ausgeführt.</p>
<ul>
<li>In einem Schritt:
<code>dd if=/dev/sdb | gzip &gt; /Home/User/Desktop/backup.gz</code>
</li>
</ul>
<p>Dabei ist <em>/dev/sdb</em> der Pfad zur Gerätedatei der SD-Karte</p>
<ul>
<li>In zwei Schritten (evtl. sinnvoll, wenn die Geschwindigkeit zu
langsam ist, benötigt aber mehr (temporären) Speicherplatz):
<code>dd if=/dev/sdb of=/Home/User/Desktop/backup.img bs=1M</code> und
<code>gzip /Home/User/Desktop/backup.img</code>
</li>
</ul>
<p>Eine Anleitung zu dd findet sich z.B. bei <a href="https://www.bitblokes.de/sd-karte-des-raspberry-pi-sichern-dd-oder-partclone/" class="external-link">Bitblokes.de</a></p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="externer-speicher">Externer Speicher<a class="anchor" aria-label="anchor" href="#externer-speicher"></a>
</h2>
<hr class="half-width">
<p>Aktuell verfügt der Raspberry Pi nur über den Speicherplatz auf der
SD-Karte. Dieser Speicherplatz kann schnell ausgehen, wenn größere
Datenmengen im Cloudserver gespeichert werden sollen. Außerdem ist eine
SD-Karte kein verlässliches Speichermedium. Deshalb kann es
empfehlenswert sein, mit Hilfe zusätzlicher Speichermedien den
Speicherplatz zu erweitern.</p>
<p>An den USB-Ports können externe Datenträger angeschlossen werden.
Dies können USB-Sticks, HDD-Festplatten (mit eigener Stromversorgung)
oder USB-SSD-Festplatten sein. Der Raspberry Pi 5 bietet außerdem über
die PCIe 2.0-Schnittstelle die Möglichkeit mit Hilfe eines
M.2-Zusatzmoduls eine NVMe-SSD anzuschließen (Details dazu siehe <a href="https://www.raspberrypi.com/products/m2-hat-plus/" class="external-link">Raspberrypi.com</a>).</p>
<div class="section level3">
<h3 id="festplatten-einbinden-mounten">Festplatten einbinden (<em>mounten</em>):<a class="anchor" aria-label="anchor" href="#festplatten-einbinden-mounten"></a>
</h3>
<p>Damit der externer Datenträger vom Betriebssystem verwendet werden
kann, muss dieser an einer zu definierenden Stelle des Verzeichnissbaums
eingebunden werden. Dieser Vorgang wird als <strong>mounten</strong>
oder <strong>einhängen</strong> bezeichnet. Dies erfolgt zunächst
einmalig und nachdem ein Dateisystem auf dem Datenträgererstellt wurde
dauerhaft:</p>
<ul>
<li><p>Aktuelle Laufwerke identifizieren: <code>lsblk</code></p></li>
<li><p>Externen Datenträger verbinden</p></li>
<li><p>erneut Laufwerke identifizieren: <code>lsblk</code> Der neue
Datenträger sollte auftauchen und mit einem Pfad ähnlich
<code>/dev/sda</code> oder <code>/dev/nvme/</code> erscheinen</p></li>
<li><p>Partition erstellen: <code>sudo fdisk /dev/sda</code> (dabei muss
/dev/sda an den eigenen Datenträger angepasst werden)</p></li>
<li><p>Im folgenden interaktiven Dialog von fdisk wird mit
<code>g</code> eine GPT-Partitionstabelle erstellt, mit <code>n</code>
eine neue Partition und mit <code>w</code> werden die Änderungen auf den
Datenträger geschrieben</p></li>
<li><p>Auf der neuen Partition ein (linuxkompatibles ext4-)Dateisystem
erstellen: <code>sudo mkfs.ext4 /dev/sda</code> (Pfade wieder
anpassen)</p></li>
<li><p>Mountpoint (Einhängepunkt für den Datenträger) erstellen:
<code>sudo mkdir /mnt/data</code> (Pfad ggf. nach eigenen Wünschen
anpassen)</p></li>
<li><p>Datenträger mounten:
<code>sudo mount /dev/sda1 /mnt/data</code></p></li>
</ul>
<p>Zu diesem Vorgang finden sich im Netz auch diverse Anleitungen, z.B.
bei <a href="https://basic-tutorials.de/ratgeber/software/usb-datentraeger-mit-dem-raspberry-pi-formatieren-und-verbinden/" class="external-link">basic-tutorials.de</a></p>
<p>Beim Elektronikkompendium findet sich noch mehr zum Thema <a href="https://www.elektronik-kompendium.de/sites/com/0610291.htm" class="external-link">Festplatten</a>,
<a href="https://www.elektronik-kompendium.de/sites/com/0705011.htm" class="external-link">Partitionen</a>
und <a href="https://www.elektronik-kompendium.de/sites/raspberry-pi/2102191.htm" class="external-link">Mounting</a>.</p>
<p>Nachdem das Dateisystem erstellt und einmalig gemountet ist, muss
dies noch dauerhaft gemacht werden. Denn das mounten über
<code>mount /dev/sdx</code> geht bei einem Neustart des Gerätes verloren
und Referenzen, z.B. aus dem Cloudserver, auf den externen Datenträger
wären ungültig. Um Datenträger dauerhaft unter dem gleichen Dateipfad
verfügbar zu machen, müssen diese Datenträger mit ihrem <em>unversal
unique identifier</em>, oder kurz <strong>UUID</strong> in der Datei
<strong><code>/etc/fstab</code></strong> eingetragen werden:</p>
<ul>
<li><p>UUID herausfinden und notieren oder in die Zwischenablage
kopieren: <code>sudo blkid</code></p></li>
<li><p>In der Datei <code>/etc/fstab</code> eine neue Zeile
ergänzen:</p></li>
</ul>
<pre><code>UUID=&lt;kopierte UUID&gt; /&lt;Pfad&gt;/&lt;zum&gt;/&lt;Mountpoint&gt;   ext4    auto,nofail,noatime,users,rw    0   0</code></pre>
<p>Dadurch wird der Datenträger bei jedem Neustart und beim ausführen
des Befehls <code>sudo mount -av</code> im angegeben Pfad eingehängt. Es
wird außerdem das Dateisystem genannt (ext4) und einige Optionen
mitgegeben. z.B. bedeutet die Option <em>nofail</em>, dass das
Betriebssystem auch dann startet, wenn der externe Datenträger nicht
angeschlossen ist.</p>
<ul>
<li><p>Nachdem der Eintrag in der <em>fstab-Datei</em> erstellt ist,
wird das mounten getestet: <code>sudo mount -av</code></p></li>
<li><p>Nach einem Neustart kann mit <code>sudo df -h</code> überprüft
werden, ob der externe Datenträger richtig eingebunden wurde.</p></li>
</ul>
<p>Weitere Anleitungen zum dauerhaften einbindinden von Datenträgern
finden sich z.B. beim <a href="https://www.elektronik-kompendium.de/sites/raspberry-pi/2012181.htm" class="external-link">Elektronikkompendium</a>
oder bei <a href="https://pimylifeup.com/raspberry-pi-mount-usb-drive/" class="external-link">PiMyLifeUp</a>.</p>
</div>
</section><section><h2 class="section-heading" id="grundlagen-der-installation">Grundlagen der Installation<a class="anchor" aria-label="anchor" href="#grundlagen-der-installation"></a>
</h2>
<hr class="half-width">
<p>Vor jeder (größeren) Installation, sollte das Handbuch der Software
studiert werden. Da in diesem Kurs die Software Nextcloud als
Dateispeicher- und Kollaborationsdienst installiert werden soll, sollte
das <a href="https://docs.nextcloud.com/server/latest/admin_manual/" class="external-link">Nextcloud
Administration Manual</a> studiert werden.</p>
<div id="installationsvarianten" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="installationsvarianten" class="callout-inner">
<h3 class="callout-title">Installationsvarianten</h3>
<div class="callout-content">
<p>Informieren Sie sich über die Installationsvarianten von Nextcloud.
Ein Einstiegspunkt ist das Kapitel <a href="https://docs.nextcloud.com/server/stable/admin_manual/installation/source_installation.html" class="external-link">Installation
on Linux</a>. Empfehlenswert ist auch das Lesen des Kapitels <a href="https://docs.nextcloud.com/server/stable/admin_manual/installation/example_ubuntu.html" class="external-link">Example
installation on Ubuntu 22.04 LTS</a>.</p>
<p>Welche der im Handbuch erwähnten Installationsvarianten erscheint
Ihnen für das Raspberry Pi Projekt am sinnvollsten?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Für den Raspberry Pi gibt es ein von der Community betriebens
Projekt: <a href="https://nextcloudpi.com/" class="external-link">NextcloudPi</a>. Damit kann
sehr schnell auf einem Raspberry Pi (oder vergleichbaren Systemen) ein
Nextcloud-Server installiert werden. Der Nachteil ist jedoch eine etwas
eingeschränkte Konfigurierbarkeit, da hier alles sozusagen “auf einen
Klick” gemacht wird. Dadurch ist auch der Lernerffekt deutlich
verringert.</p>
<p>Grundlegend sind auch die Optionen mit Docker eine gute Option. Hier
steht ein offizielles Image zur Verfügung (<a href="https://github.com/nextcloud/all-in-one#nextcloud-all-in-one" class="external-link">Nextcloud
AIO</a>), das allerdings auch wieder vorgefertigt und daher weniger
Anpassbar ist. Da Docker jedoch noch einmal eine weitere
Komplexitätsschicht hinzufügt und v.a. dann interessant ist, wenn auf
einem Computer mehrere Dienste betrieben werden, wird diese Variante
hier nicht weiter verfolgt.</p>
<p>Als empfehlenswerte Variante für diesen Kurs wird die manuelle
Installation gewählt. Dies hat den Vorteil, dass damit das gesamte
System nach den eigenen Wünschen angepasst werden kann und dadurch auch
ein hoher Lerneffekt zustande kommt.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="komponenten">Komponenten<a class="anchor" aria-label="anchor" href="#komponenten"></a>
</h3>
<p>Der Nextcloud-Server besteht aus mehreren Komponenten. Nextcloud
selbst ist dabei nur ein Teil. Für die Funktionalität werden jedoch noch
eine Datenbank, ein Webserver und ein Datenverzeichnis benötigt.
Außerdem kann später mithilfe von Apps die Funktionalität erweitert
werden.</p>
<table class="table">
<caption>Nextcloud-Komponenten</caption>
<colgroup>
<col width="25%">
<col width="25%">
<col width="48%">
</colgroup>
<thead><tr class="header">
<th>Komponente</th>
<th>Funktion</th>
<th>Hinweis</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Nextcloud-Server</td>
<td>die Hauptsoftware</td>
<td>Kernprogramm zur Datenverwaltung und Steuerung</td>
</tr>
<tr class="even">
<td>Datenbank</td>
<td>Speichert Benutzer, History, Metadaten u.v.m.</td>
<td>SQLite für Testzwecke, MariaDB oder PostgreSQL für produktiven
Einsatz</td>
</tr>
<tr class="odd">
<td>Webserver</td>
<td>Koordiniert Kommunikation</td>
<td>z.B. Apache oder NGINX; steuert Anfragen und Antworten,
verschlüsselt die Kommunikation</td>
</tr>
<tr class="even">
<td>Datenverzeichnis</td>
<td>Speicherort der Clouddaten</td>
<td>Es sind verschiedene Verzeichnisse und Speichertechnologien
möglich</td>
</tr>
<tr class="odd">
<td>Apps</td>
<td>Funktionserweiterung</td>
<td>Zahlreiche Möglichkeiten im <a href="https://apps.nextcloud.com/" class="external-link">Nextcloud App store</a>
</td>
</tr>
</tbody>
</table>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>Zur Sicherung des gesamten Systems kann die SD-Karte an einem
zweiten PC geklont werden</p></li>
<li><p>Datenträger können unter Linux an einer beliebigen Stelle des
Verzeichnisses Baumes eingehängt werden</p></li>
<li><p>Einmaliges mounten erfolgt mit dem <code>mount</code>-Befehl,
dauerhaftes mounten durch Eintragung in der Datei
<code>/etc/fstab</code></p></li>
<li><p>Nextcloud bietet unterschiedliche Installationsvarianten- und
Komponenten. In diesem Kurs wird die manuelle Installation mit MariaDB
und Apache gewählt.</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-08-installationsvorbereitung-2"><p>Content from <a href="08-installationsvorbereitung-2.html">Installationsvorbereitung 2</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/08-installationsvorbereitung-2.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Wie kann ich meinen Raspberry Pi im Internet erreichen?</p></li>
<li><p>Wie erhalte ich einen Domainnamen/eine URL für meinen
Server?</p></li>
<li><p>Wie ermögliche ich Zugriff vom Internet in mein
Heimnetzwerk?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Portweiterleitungen am Router einrichten</p></li>
<li><p>DDNS: eigene URL trotz dynamischer IP-Adressen</p></li>
<li><p>Webserver im Heimnetzwerk betreiben</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="externe-erreichbarkeit">Externe Erreichbarkeit<a class="anchor" aria-label="anchor" href="#externe-erreichbarkeit"></a>
</h2>
<hr class="half-width">
<p>Aktuell befindet sich der Raspberry Pi in einem Heimnetzwerk. Dort
ist er mit einem Router verbunden. Dieser Router ist mit dem Netzwerk
des Internetanbieters verbunden, welches wiederum eine Verbindung “ins
Internet” hat. Das folgende Schaubild zeigt den aktuellen Aufbau:</p>
<figure><img src="../fig/08_network-setup.png" alt="Diese Abbilung zeigt den Aufbau eines Heimnetzwerks. Zu sehen sind ein Computer mit der IP-Adresse 192.168.178.26. Dieser ist mit einem Router mit der IP-Adresse 192.168.178.1 verbunden. Am Router ist ein Raspberry Pi angeschlossen, dieser hat die IP-Adresse 192.168.178.25. Der Router ist mit dem Internet verbunden und hat die externe IP-Adresse 93.236.170.179" class="figure mx-auto d-block"><div class="figcaption">Netzwerksetup im Heimnetzwerk</div>
</figure><div id="externe-erreichbarkeit-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="externe-erreichbarkeit-1" class="callout-inner">
<h3 class="callout-title">Externe Erreichbarkeit</h3>
<div class="callout-content">
<p>Sie kennen nun das aktuelle Netzwerksetup. Ihr Raspberry Pi hat auch
eine Internetverbindung und mit Ihrem PC können Sie per SSH auf Ihren
Raspberry Pi zugreifen. Aber wie ist der Raspberry Pi aus dem Internet
erreichbar?</p>
<ol style="list-style-type: decimal">
<li><p>Unter 192.168.178.25</p></li>
<li><p>Unter 93.236.170.179</p></li>
<li><p>Er ist gar nicht erreichbar</p></li>
<li><p>Unter 192.168.178.1</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ul>
<li>Antwort 3 ist die richtige</li>
</ul>
<p>Da der Router aktuell keine Anfragen von außen nach innen durchlässt,
ist das Heimnetzwerk nicht aus dem Internet erreichbar. Würde der Router
Anfragen durchlassen, wären sämtlich Geräte im Heimnetzwerk im Internet
exponiert und gefährdet. Der Router selbst ist dagegen unter der Adresse
93.236.170.179 erreichbar, wird aber aus Sicherheitsgründen nicht auf
Anfragen antworten.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="portweiterleitung">Portweiterleitung<a class="anchor" aria-label="anchor" href="#portweiterleitung"></a>
</h3>
<p>Damit der Router bestimmte Anfragen aus dem Internet annimmt und an
ein bestimmtes Gerät im Heimnetzwerk weiterleitet, muss dem Router
mitgeteilt werden, welche Art von Anfragen (auf welchem Port) er
annehmen soll und an welches Gerät (welche MAC-Adresse) diese
weitergeleitet werden sollen. Die entsprechenden Einstellungen variieren
von Gerät zu Gerät. Häufig heißen die entsprechenden Funktionen
<em>Portforwarding</em>, <em>Portweiterleitungen</em> oder
<em>Freigaben</em>. Nicht jeder Router unterstützt diese Funktionalität.
Insbesondere die günstigen Heimrouter, die Internetprovider kostenlos
zur Verfügung stellen sind hier häufig in Ihrer Funktionalität
eingeschränkt.</p>
<figure><img src="../fig/08_fritzbox-portweiterleitung-komplett.png" class="figure mx-auto d-block"><div class="figcaption">Portweiterleitung unter Fritz.OS auf einem
Fritz.Box-Router der Firma AVM einrichten</div>
</figure><p>Zu beachten ist auch, dass manche Internetanbieter das
DS-Lite-Verfahren (Dual Stack Lite) nutzen. Dabei teilt sich der eigene
Router ein Netzwerk (und damit eine öffentliche IP-Adresse) mit anderen
Kunden des Internetanbieters. Das macht es (nahezu) unmöglich, den
Router aus dem Internet zu erreichen. Eine Abbhilfe kann hier das
IPv6-Protokoll sein, da hier nicht der Router die öffentliche IP-Adresse
erhält, sondern jedes einzelne Gerät eine weltweit einzigartige
IPv6-Adresse hat und somit direkt im Internet erreichbar sein kann.</p>
</div>
<div class="section level3">
<h3 id="ddns-dynamic-domain-name-system">DDNS: Dynamic domain name system<a class="anchor" aria-label="anchor" href="#ddns-dynamic-domain-name-system"></a>
</h3>
<p>Der Router nimmt nun anfragen aus dem Internet an und leitet diese an
den Raspberry Pi weiter. Der Router (und damit der Raspberry Pi) ist
aber bislang nur unter seiner IP-Adresse erreichbar. Diese ist jedoch
schwer zu merken und ändert sich für Privatkunden in Deutschland in der
Regel einmal täglich aufgrund einer nächtlichen Zwangstrennung durch den
Internetanbieter. Wer einen Dienst (hier ein Nextcloud-Server) stets
unter derselben Adresse und einer URL erreichen will, kann dazu auf das
dynamic domain name system (kurz: <strong>DDNS</strong>) zurück
greifen.</p>
<p>DDNS funktioniert unter Zuhilfenahme eines externen Dienstleisters.
Bei diesem wird eine (Sub)Domain beantragt, z.B.
<em>server.dns-anbieter.de</em>. Auf dem Raspberry Pi kann das Programm
<strong>DDClient</strong> installiert werden. Dieses kontaktiert
regelmäßig eine Internetseite und erhält von dieser die eigene
öffentliche IP-Adresse als Echo zurück. Dadurch erfährt DDClient, unter
welcher IP-Adresse der Raspberry Pi erreichbar ist und ob diese sich
geändert hat. Diese IP-Adresse schickt DDClient an den DDNS-Anbieter,
bei welchem die eigene Domain beantragt wurde. Dieser Anbieter wiederum
trägt die IP-Adresse in seinem DNS ein.</p>
<div id="dns" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="dns" class="callout-inner">
<h3 class="callout-title">DNS</h3>
<div class="callout-content">
<p><strong>DNS</strong> kann als Telefonbuch des Internets verstanden
werden, in welchem IP-Adressen in Domainnamen übersetzt werden, z.B.
wird die IP-Adresse 49.13.55.174. in <a href="https://wikipedia.de" class="external-link">wikipedia.de</a> übersetzt. Mehr zum Thema
DNS findet sich z.B. beim <a href="https://www.elektronik-kompendium.de/sites/net/0901141.htm" class="external-link">Elektronikkompendium</a>.</p>
</div>
</div>
</div>
<p>Ruft ein Computer die Adresse <em>server.dns-anbieter.de</em> auf,
wird im DNS des DDNS-Anbieters die tagesaktuelle öffentliche IP-Adresse
des Heimnetzwerks ausgelesen und übermittelt. Dadurch wird die Anfrage
an die richtige IP-Adresse geschickt.</p>
<p>Es gibt verschiedene Anbieter für DDNS-Dienste. Gut geeignet sind
z.B. <a href="https://noip.com" class="external-link">No-IP</a> oder <a href="https://www.ddnss.de/" class="external-link">DDNSS</a>. Auch viele Heimrouter bieten
über den Hersteller eine Möglichkeit für DDNS an (z.B. AVM mit
Fritz.Box-Routern).</p>
</div>
<div class="section level3">
<h3 id="umsetzung-ddns-am-raspberry-pi">Umsetzung DDNS am Raspberry Pi<a class="anchor" aria-label="anchor" href="#umsetzung-ddns-am-raspberry-pi"></a>
</h3>
<p>Für die Implementierung des DDNS-Verfahrens am Raspberry Pi wird wie
folgt vorgegangen:</p>
<ul>
<li><p>Account bei einem DDNS-Anbieter registrieren</p></li>
<li><p>Im Falle von <em>No-IP</em> muss im <a href="https://noip.com" class="external-link">Webportal</a> des Anbieters ein Benutzername
festgelegt werden</p></li>
<li><p>Beim gewählten Anbieter muss ein Domainname reserviert werden
(A-Record für IPv4 oder AAAA-Record für IPv6)</p></li>
<li>
<p>ddclient auf dem Raspberry Pi installieren und konfigurieren:
<code>sudo apt-get install ddclient</code></p>
<ul>
<li><p>Im Anschließenden Dialog wird im Falle von No-IP <em>no-ip</em>
gewählt, ansonsten <em>anderer</em></p></li>
<li><p>als Benutzername und Passwort werden die Zugangsdaten des
DDNS-Anbieters eingetragen</p></li>
<li><p>als <em>IP-Adressen-Ermittlungsmethode</em> wird
<em>Web-basierter IP-Ermittlungsdienst</em> gewählt</p></li>
<li><p>der zu aktualisierende Rechner ist der beim DDNS-Anbieter
reservierte Domainnamen</p></li>
</ul>
</li>
</ul>
<figure><img src="../fig/08_ddclient01.png" alt="Konfigurationsdialog von DDClient. Es stehen mehrere DDNS-Anbieter zur Auswahl. Hervorgehoben ist no-ip.com" class="figure mx-auto d-block"><div class="figcaption">DDClient konfigurieren 1: Anbieter
auswählen</div>
</figure><figure><img src="../fig/08_ddclient02.png" alt="Konfigurationsdialog von DDClient: festlegen der IP-Ermittlungsmethode, hervorgehoben ist die Option web-basierter IP-Ermittlungsdienst" class="figure mx-auto d-block"><div class="figcaption">DDClient konfigurieren 2:
Ermittlungsmehode</div>
</figure><figure><img src="../fig/08_ddclient03.png" alt="Konfigurationsdialog von DDClient: eingabe des Domainnamens, als Platzhalter ist server.ddns-anbieter.de zu sehen" class="figure mx-auto d-block"><div class="figcaption">DDClient konfigurieren 3: Domainname</div>
</figure><p>Nach der Installation sollte die <strong>Konfigurationsdatei</strong>
überprüft und ggf. angepasst werden:
<code>sudo nano /etc/ddclient.conf</code>. Je nach DDNS-Anbieter sieht
die Konfigurationsdatei unterschiedlich aus.</p>
<ul>
<li>DDNSS.de:</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#für ddnss.de</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="va">protocol</span><span class="op">=</span>dyndns2</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="va">use</span><span class="op">=</span>web, <span class="va">web</span><span class="op">=</span>https://api.ipify.org/ </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="va">server</span><span class="op">=</span>ddnss.de</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="va">login</span><span class="op">=&lt;</span>DDNSSLoginName<span class="op">&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="va">password</span><span class="op">=</span><span class="st">'&lt;Passwort&gt;'</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="op">&lt;</span>domainname<span class="op">&gt;</span>.ddnss.de</span></code></pre>
</div>
<ul>
<li>NO-IP:</li>
</ul>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#NO-IP.com</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="va">protocol</span><span class="op">=</span>noip</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="va">use</span><span class="op">=</span>web, <span class="va">web</span><span class="op">=</span>http://ip1.dynupdate.no-ip.com/</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="va">login</span><span class="op">=&lt;</span>noip-username<span class="op">&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="va">password</span><span class="op">=</span>’<span class="op">&lt;</span>noip-passwort<span class="op">&gt;</span>’</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="op">&lt;</span>noip-Domainname<span class="op">&gt;</span></span></code></pre>
</div>
<div id="externe-erreichbarkeit-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="externe-erreichbarkeit-2" class="callout-inner">
<h3 class="callout-title">Externe Erreichbarkeit</h3>
<div class="callout-content">
<p>Sie haben die Portweiterleitung am Router und die DDNS-Konfiguration
am Raspberry Pi abgeschlossen. Wie ist der Raspberry Pi nun aus dem
Internet erreichbar?</p>
<ol style="list-style-type: decimal">
<li><p>Unter 192.168.178.25</p></li>
<li><p>Unter 93.236.170.179</p></li>
<li><p>Er ist nach wie vor nicht erreichbar</p></li>
<li><p>Unter server.ddns-anbieter.de</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ul>
<li>Antwort 3 ist die richtige</li>
</ul>
<p>Zwar ist das Heimnetzwerk nun unter der DDNS-Domain (im Beispiel
server.ddns-anbieter.de) erreichbar, der Router lässt Anfragen von Außen
nach Innen durch und leitet sie auch an den Raspberry Pi weiter. Dessen
<strong>Firewall</strong> blockiert aber aktuell noch alle Verbindungen
außer der SSH-Verbindung, weshalb die Anfrage wieder nicht ans Ziel
gelangt.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="firewall-anpassen">Firewall anpassen<a class="anchor" aria-label="anchor" href="#firewall-anpassen"></a>
</h3>
<p>Um Zugriffe auf Ressourcen des Raspberry Pi zu erlauben (z.B. HTTP
und HTTPS-Verkehr für einen Webserver), muss dessen Firewall angepasst
werden. Um zu testen, ob die Kommunikation grundlegend funktioniert,
wird zunächst der Port 80 für unverschlüsselten HTTP-Datenverkehr
geöffnet, sowohl als Portweiterleitung am Router, als auch in der
Firewall des Raspberry Pi. Am Raspberry Pi wird dazu der UFW-Befehl
genutzt: <code>sudo ufw allow 80</code></p>
</div>
</section><section><h2 class="section-heading" id="apache-webserver-installieren">Apache Webserver installieren<a class="anchor" aria-label="anchor" href="#apache-webserver-installieren"></a>
</h2>
<hr class="half-width">
<p>Noch wird am Raspberry Pi kein Dienst auf Anfragen mit Port 80
reagieren. Um die Kommunikation zu testen wird der Webserver
<em>Apache2</em> installiert, der auch im weiteren Projektverlauf
genutzt wird: <code>sudo apt-get install apache2</code></p>
<div class="section level3">
<h3 id="installation-und-verzeichnisse">Installation und Verzeichnisse<a class="anchor" aria-label="anchor" href="#installation-und-verzeichnisse"></a>
</h3>
<p>Nach der Installation sind bereits einige Konfigurationsverzeichnisse
vorhanden:</p>
<ul>
<li><p>Virtual-Host-Konfiguration: für jede Internetseite, die der
Apache-Webserver ausliefern soll, wird eine Konfigurationsdatei unter
<code>/etc/apache2/sites-available</code> erstellt. Zu Beginn befindet
sich dort bereits die Apache-Standard-Konfigurationsdatei, welche zum
testen genügt.</p></li>
<li><p>Website-Daten: die Dateien (z.B. die HTML-Dokumente) der Website
selbst liegen im sogenannten <em>Document-Root</em>, welches
Standardmäßig unter <code>/var/www/html/</code>zu finden ist, aber für
jede Internetseite individuell angepasst werden kann (in der
Virtual-Host-Konfigurationsdatei).</p></li>
<li><p>Log-Dateien: Log-Dateien des Apache-Webservers finden sich
meistens unter <code>/var/log/apache2/</code>. Der Pfad kann aber in der
Virtual-Host-Datei angepasst werden.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="test-der-externen-erreichbarkeit">Test der externen Erreichbarkeit<a class="anchor" aria-label="anchor" href="#test-der-externen-erreichbarkeit"></a>
</h3>
<p>Da der Apache-Webserver nach der Installation bereits eine
Standardwebsite zu Verfügung stellt, kann die Erreichbarkeit des
Webserver direkt getestet werden. Dabei empfiehlt es sich, den Test
Stück um Stück zu eskalieren:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Stufe: Erreichbarkeit vom Raspberry Pi selbst testen: in der
Kommandozeile mit <code>curl localhost</code> (als Antwort wird ein
HTML-Dokument auf der Kommandozeile ausgegeben) oder mit verbundenem
Bildschirm im Browser durch Eingabe von localhost in der Adresszeile.
Funktioniert Stufe 1, ist gewährleistet, dass der Apache-Webserver
funktionert.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Stufe: Erreichbarkeit im Heimnetzwerk: Lokale IP-Adresse des
Raspberry Pi (im Beispiel die 192.168.178.25) in der Adresszeile des
Browsers am PC/Notebook eingeben. Es sollte die Apache Standardseite
zurück geliefert werden. Funktioniert Stufe 2, ist gewährleistet, dass
der Zugriff auf den Webserver nicht von der Raspberry Pi Firewall
blockiert wird (zunmindest nicht aus dem Heimnetzwerk heraus).</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Stufe: Erreichbarkeit im Internet: gewählte DDNS-Domain (im Beispiel
server.ddns-anbieter.de) am Smartphone ohne WLAN-Verbindung aufrufen. Es
solte dasselbe Ergebnis wie in Stufe 2 erreicht werden. Funktioniert
auch Stufe 3, ist gewährleistet, dass sowohl die DDNS-Konfiguration
funktioniert, als auch die Portweiterleitung.</li>
</ol></li>
</ul>
<p>Schlägt eine der Stufen fehl, muss zuerst nach dem Fehler gesucht
werden. Vermutlich liegt es an einer Fehlerhaften Konfiguration der
Firewall, der Portweiterleitung oder von DDClient.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>Um den Raspberry Pi aus dem Internet zu erreichen müssen mehrere
Schritte unternommen werden.</p></li>
<li><p>es muss eine DDNS-Domain reserveriert werden und ein DDNS-Dienst
auf dem Raspberry Pi konfiguriert werden.</p></li>
<li><p>es muss eine Portweiterleitung auf dem Router des Heimnetzwerks
eingerichtet werden. Dies muss vom Internetanbieter unterstützt
werden.</p></li>
<li><p>die Firewall des Raspberry Pi muss angepasst werden.</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-09-installationsvorbereitung-3"><p>Content from <a href="09-installationsvorbereitung-3.html">Installationsvorbereitung 3</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/09-installationsvorbereitung-3.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Welche weiteren Vorbereitungen sind nötig?</p></li>
<li><p>Wie installiere und konfiguriere ich einen
Datenbankserver?</p></li>
<li><p>Wie konfiguriere ich einen Webserver?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Abhängigkeiten installieren: PHP, Datenbank und
Webserver</p></li>
<li><p>Datenbanken mit MariaDB erstellen</p></li>
<li><p>Individuelle Website mit dem Apache-Webserver bereit
stellen</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="abhängigkeiten">Abhängigkeiten<a class="anchor" aria-label="anchor" href="#abh%C3%A4ngigkeiten"></a>
</h2>
<hr class="half-width">
<p>Für das korrekte Funktionieren benötigen die meisten Programme dritte
Programme, auf deren Funktionen sie zugreifen. Im Falle von
Webanwendungen wie Nextcloud sind das vor allem ein Webserver (Apache2
in unserem Fall), ein Datenbankmanagementsystem (siehe <a href="../09-installationsvorbereitung-3.Rmd/#Datenbank">Datenbank</a>) und
verschiedene Module der Skriptsprache PHP.</p>
<p>Dem <a href="https://docs.nextcloud.com/server/latest/admin_manual/" class="external-link">Nextcloud-Handbuch</a>
kann entnommen werden, dass einige PHP-Module benötigt werden, einige
weitere je nach Einsatzzweck empfohlen sind. Die <a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/example_ubuntu.html" class="external-link">Beispielinstallation
unter Ubuntu 22.04</a> listet auch die genauen Installationsbefehle
auf:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">sudo</span> apt update <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> apt upgrade</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">sudo</span> apt install apache2 mariadb-server libapache2-mod-php php-gd php-mysql <span class="dt">\</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>php-curl php-mbstring php-intl php-gmp php-bcmath php-xml php-imagick php-zip</span></code></pre>
</div>
<p>Es empfiehlt sich jedoch, die genauen Anforderungen zu studieren und
den obigen Befehl ggf. den eigenen und aktuellen Bedingungen
anzupassen.</p>
</section><section><h2 class="section-heading" id="datenbank">Datenbank<a class="anchor" aria-label="anchor" href="#datenbank"></a>
</h2>
<hr class="half-width">
<p>Für die Speicherung von z.B. Userinformationen,
Zugangsberechtigungen, Metadaten oder Referenzen auf die im Dateisystem
gespeicherten Dateien benötigt Nextcloud eine Datenbank. Um eine
Datenbank zu betreiben wird ein Datenbankmanagementsystem (kurz:
<strong>DBMS</strong>) benötigt. Unter Debian-Linuxvarianten empfiehlt
sich entweder PostgreSQL oder MariaDB. In diesem Kurs wird
<strong>MariaDB</strong> genutzt. Da MariaDB ein Open-Source-Ableger von
MySQL ist, können alle für MySQL gültigen Befehle auch für MariaDB
genutzt werden.</p>
<p>Die Installation von MariaDB ist bereits mit den Abhängigkeiten
erfolgt. Falls nicht, lautet der Befehl:
<code>sudo apt-get install mariadb-server</code></p>
<p>Um sich mit dem Datenbankmanagementsystem MariaDB zu verbinden, kann
entweder der Befehl <code>mariadb</code> oder dessen Alias
<code>mysql</code> genutzt werden.</p>
<div class="section level3">
<h3 id="authentifizierung-am-dbms">Authentifizierung am DBMS<a class="anchor" aria-label="anchor" href="#authentifizierung-am-dbms"></a>
</h3>
<p>Um unautorisierten Zugriff auf Datenbanken zu verhindern, stellt
MariaDB <a href="https://mariadb.com/kb/en/authentication-plugins/" class="external-link">unterschiedliche
Möglichkeiten</a> zur Anmeldung am DBMS bereit. Die einfachste ist dabei
die Möglichkeit, einen auf dem Betriebssystem vorhandenen User zu nutzen
(<a href="https://mariadb.com/kb/en/authentication-plugin-unix-socket/" class="external-link">Unix-Socket-Plugin</a>).
Standardmäßig hat der Root-Account des Betriebssystems auch Root-Rechte
in MariaDB. Daraus folgt, dass bei einer Anmeldung mit dem
Linux-Root-Account auch Root-Rechte in MariaDB erhalten werden:
<code>sudo mariadb</code>. Möchte man sich dagegen mit einem User
anmelden, der im DBMS gespeichert ist (<a href="https://mariadb.com/kb/en/authentication-plugin-mysql_native_password/" class="external-link">mysql_native_paassword-Plugin</a>),
muss dies explizit mit dem Parameter <code>-u &lt;username&gt;</code>
angegeben werden: <code>mysql -u &lt;username&gt;</code> Hat der
angegebene User nicht die nötigen Rechte im DBMS, schlägt die Anmeldung
fehl.</p>
<p>Um einen User zum DBMS hinzuzufügen, wird wie folgt vorgegangen:</p>
<ul>
<li><p>mit Root-Rechten anmelden: <code>sudo mysql</code></p></li>
<li><p>User erstellen, welcher sich per Passwort am lokalen DBMS
anmelden kann:
<code>CREATE USER '&lt;username&gt;'@'localhost' IDENTIFIED BY '&lt;password&gt;';</code></p></li>
<li><p>Vom DBMS abmelden: <code>quit</code></p></li>
<li><p>Mit dem neu erstellten User anmelden:
<code>mysql -u &lt;username&gt; -p</code></p></li>
<li><p>Passwort eingeben</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="datenbank-erstellen">Datenbank erstellen<a class="anchor" aria-label="anchor" href="#datenbank-erstellen"></a>
</h3>
<p>Um eine neue Datenbank zu erstellen wird der Befehl
<code>create database</code> innerhalb der interaktiven
MariaDB-Kommandozeile genutzt. Anschließend können mit dem
<code>GRANT</code>-Befehl einem User Schreib- und Leserechte für die
Datenbank erteilt werden.</p>
<p>Es gilt als <em>Best-Practice</em> für jeden Webservice einen eigenen
User zu erstellen, welcher nur diejenigen Rechte erhält, die unbedingt
nötig sind, um den Service zu betreiben. Auf jeden Fall sollte kein
Webservice mit Root-Rechten auf das DBMS zugreifen.</p>
<p>Im Falle von Nextcloud wird zunächst mit Root-Rechten ein User
erstellt, eine Datenbank erstellt und dem User anschließend die
notwendigen Rechte erteilt:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="kw">CREATE</span> <span class="fu">USER</span> <span class="st">'&lt;username&gt;'</span>@<span class="st">'localhost'</span> <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> <span class="st">'&lt;password&gt;'</span>;</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> <span class="op">&lt;</span>datenbankname<span class="op">&gt;</span> <span class="dt">CHARACTER</span> <span class="kw">SET</span> utf8mb4 COLLATE utf8mb4_general_ci;</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">ALL</span> <span class="kw">PRIVILEGES</span> <span class="kw">ON</span> <span class="op">&lt;</span>datenbankname<span class="op">&gt;</span>.<span class="op">*</span> <span class="kw">TO</span> <span class="st">'&lt;username&gt;'</span>@<span class="st">'localhost'</span>;</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="kw">FLUSH</span> <span class="kw">PRIVILEGES</span>;</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>quit;</span></code></pre>
</div>
<p><code>&lt;username&gt;</code>, <code>&lt;password&gt;</code> und
<code>&lt;datenbankname&gt;</code> sind jeweils durch eigene Werte zu
ersetzen.</p>
<p>Siehe dazu auch das <a href="https://docs.nextcloud.com/server/stable/admin_manual/installation/example_ubuntu.html" class="external-link">Handbuch</a></p>
<p>Anschließend sollte der Login und der Zugriff auf die erstellte
Datenbank getestet werden:
<code>mysql -u &lt;username&gt; -p &lt;datenbankname&gt;</code></p>
</div>
</section><section><h2 class="section-heading" id="softwaredownload">Softwaredownload<a class="anchor" aria-label="anchor" href="#softwaredownload"></a>
</h2>
<hr class="half-width">
<p>Da nun alle Vorbereitungen abgeschlossen sind, kann die Software
heruntergeladen und der Download mittels eines Hashwertes überprüft
werden:</p>
<pre><code>wget https://download.nextcloud.com/server/releases/latest.tar.bz2
wget https://download.nextcloud.com/server/releases/latest.tar.bz2.sha256
sha256sum -c latest.tar.bz2.sha256 &lt; latest.tar.bz2</code></pre>
<div id="hashwerte" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="hashwerte" class="callout-inner">
<h3 class="callout-title">Hashwerte:</h3>
<div class="callout-content">
<p>Um die Korrektheit eines Downloads zu überprüfen, kann dessen
Hashwert überprüft werden. Ein Hashwert ist ein Wert, der durch einen
Algorithmus aus einer Datei abgeleitet wird. Wird die Datei verändert,
verändert sich auch der Hashwert. Dadurch kann überprüft werden, ob eine
heruntergeladene Datei noch immer der Datei entspricht, die ursprünglich
zur Verfügung gestellt wurde oder ob die Datei auf dem Weg abgefangen
und verändert wurde.</p>
<p>Mehr zu Hashwerten findet sich z.B. in diesen beiden YouTube-Videos:
<a href="https://www.youtube.com/watch?v=VmVFe5gr_5A" class="external-link">1</a> und <a href="https://www.youtube.com/watch?v=shs0KM3wKv8" class="external-link">2</a></p>
</div>
</div>
</div>
<p>Nach dem Download muss die Software entpackt und in das Document-Root
der Website kopiert werden (standardmäßig
<code>/var/www/&lt;servicename&gt;</code>).</p>
<div id="dateiarbeit" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="dateiarbeit" class="callout-inner">
<h3 class="callout-title">Dateiarbeit</h3>
<div class="callout-content">
<p>Was machen die folgenden Befehle:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">sudo</span> tar <span class="at">-xjvf</span> latest.tar.bz2 <span class="at">-C</span> /var/www</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="at">-R</span> www-data:www-data /var/www/nextcloud</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Der tar-Befehl entpackt das heruntergeladene und komprimierte Archiv
(<em>latest.tar.bz2</em>) in das Verzeichnis <code>/var/www</code></p>
<p>Der chown-Befehl überträgt das entpackte Verzeichnis dem User und der
Gruppe www-data. Dies ist wichtig, damit der Webserver später auf die
Dateien zugreifen kann.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="website-grundkonfiguration">Website Grundkonfiguration<a class="anchor" aria-label="anchor" href="#website-grundkonfiguration"></a>
</h2>
<hr class="half-width">
<p>Nach dem Download der Dateien müssen diese als Website durch den
Webserver bereit gestellt werden. Dazu muss für Apache2 eine neue
Konfigurationsdatei für die Website erstellt werden:
<code>sudo nano /etc/apache2/sites-available/nextcloud.conf</code></p>
<p>In einer ersten sehr einfachen Version kann diese wie folgt
aussehen:</p>
<pre class="apacheconf"><code>&lt;VirtualHost *:80&gt;
  DocumentRoot /var/www/nextcloud/
  ServerName  server.ddns-provider.de

  &lt;Directory /var/www/nextcloud/&gt;
    Require all granted
    AllowOverride All
    Options FollowSymLinks MultiViews

    &lt;IfModule mod_dav.c&gt;
      Dav off
    &lt;/IfModule&gt;
  &lt;/Directory&gt;
&lt;/VirtualHost&gt;</code></pre>
<div id="apache-konfiguration" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="apache-konfiguration" class="callout-inner">
<h3 class="callout-title">Apache-Konfiguration</h3>
<div class="callout-content">
<p>Schauen Sie sich den oben gezeigten Code der
Apache-Konfigurationsdatei an. Können Sie die Einstellungen verstehen?
Welche Einstellungen müssen Sie an Ihr Setup anpassen?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Webserver sind eine komplexe Angelegenheit, die sehr viele
Möglichkeiten zur Konfiguration bieten. Um alle Möglichkeiten zu kennen
und zu verstehen, wäre ein eigener Kurs nötig. Idealerweise stellen die
Hersteller des zu installierenden Webservices eigene Informationen zur
Konfiguration bereit, da je nach Service unterschiedliche
Konfigurationen nötig sind. Die wichtigsten Parameter im obigem
Code-Beispiel sind:</p>
<p>DocumentRoot: Stammverzeichnis, in welchem sich die Website-Daten
befinden.</p>
<p>ServerName: Webadresse, unter der die Website erreichbar sein
soll</p>
<p>Die anderen Optionen können dem <a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/source_installation.html" class="external-link">Handbuch</a>
entnommen werden.</p>
</div>
</div>
</div>
</div>
<p>Ist die Konfigurationsdatei erstellt, muss dem Webserver mitgeteilt
werden, dass diese aktiviert werden soll:
<code>sudo a2ensite nextcloud.conf</code> Anschließend befindet sich im
Verzeichnis <code>/etc/apache2/sites-enabled/</code> ein Link auf die
Datei <code>/etc/apache2/sites-available/nextcloud.conf</code></p>
<p>Der Apache-Webserver kann durch Module in seiner Funktion erweitert
werden. Diese müssen aktiviert werden, damit sie verfügbar sind. Für
Nextcloud sollten die Module <em>mod_rewrite</em>, <em>mod_headers</em>,
<em>mod_env</em>, <em>mod_dir</em> und <em>mod_mime</em> aktiviert
werden: <code>sudo a2enmod rewrite headers env dir mime</code></p>
<p>Anschließend muss Apache2 neugestartet werden:
<code>sudo systemctl restart apache2.service</code></p>
</section><section><h2 class="section-heading" id="abschließende-schritte">Abschließende Schritte<a class="anchor" aria-label="anchor" href="#abschlie%C3%9Fende-schritte"></a>
</h2>
<hr class="half-width">
<p>Vor der Installation von Nextcloud muss eine (leere)
Konfigurationsdatei für Nextcloud erstellt werden:
<code>sudo touch /var/www/nextcloud/config/config.php</code></p>
<div class="section level3">
<h3 id="datenverzeichnis">Datenverzeichnis<a class="anchor" aria-label="anchor" href="#datenverzeichnis"></a>
</h3>
<p>Um die Dateien, die später in Nextcloud gespeichert werden sollen,
nicht auf dem Hauptlaufwerk des Raspberry Pis (der SD-Karte) zu
speichern, wird auf dem externen Speicher (siehe <a href="07-installationsvorbereitung-1.html">Episode 7:
Installationsvorbereitung 1</a>) ein Verzeichnis erstellt:
<code>sudo mkdir /mnt/data/ncdata</code></p>
<p>Zu Letzt muss sicher gestellt werden, dass der Webserver die nötigen
Zugriffsrechte auf das Document-Root und das Datenverzeichnis hat:</p>
<ul>
<li><p><code>sudo chown -R www-data:www-data /var/www/nextcloud</code></p></li>
<li><p><code>sudo chown -R www-data:www-data /mnt/data/ncdata</code></p></li>
</ul>
<p>Steuert man nun seine beim DDNS-Provider gewählte Domain im Browser
an, erreicht man den Nextcloud-Installationsassistenten. Bevor dieser
gestartet wird, sind aber noch weitere Schritte notwendig.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>Nextcloud benötigt weitere Programme zur Funktion: PHP, Datenbank
und Webserver</p></li>
<li><p>Mit MariaDB muss ein Datenbankuser und eine Datenbank für
Nextcloud erstellt werden</p></li>
<li><p>Die heruntergeladenen Dateien müssen mittels Konfigurationsdatei
durch Apache zur Verfügung gestellt werden</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-10-installationsvorbereitung-4"><p>Content from <a href="10-installationsvorbereitung-4.html">Installationsvorbereitung 4</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/10-installationsvorbereitung-4.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Ist die aktuelle Verbindung zu meiner Cloud sicher?</p></li>
<li><p>Wie kann ich Apache sicherer konfigurieren?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Grundlagen der HTTPS-Verbindung verstehen</p></li>
<li><p>TLS-Zertifikate mit Letsencrypt und Certbot</p></li>
<li><p>Sicherheitsoptimierungen für Websites mit Apache</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="kommunikationsweg">Kommunikationsweg:<a class="anchor" aria-label="anchor" href="#kommunikationsweg"></a>
</h2>
<hr class="half-width">
<p>Aktuell erreichen wir den Webserver, welcher uns die Website für
Nextcloud ausliefert, mit dem HTTP-Protokoll über Port 80. Diese
Verbindung ist unverschlüsselt. Das bedeutet, dass sämtliche Daten (z.B.
Passwörter und Dateien) die zum Server geschickt oder vom Server
verschickt werden, von einem “Zuhörer” auf der Leitung mitgelesen werden
können (das geht z.B. mit dem Tool <a href="https://www.wireshark.org/about.html" class="external-link">Wireshark</a> v.a. im LAN
recht einfach, siehe z.B. diese Anleitung von <a href="https://www.varonis.com/de/blog/verwendung-von-wireshark" class="external-link">Varonis</a>).</p>
<div class="section level3">
<h3 id="grundlagen-der-https-verbindung">Grundlagen der HTTPS-Verbindung<a class="anchor" aria-label="anchor" href="#grundlagen-der-https-verbindung"></a>
</h3>
<p>Um das Auslesen der Verbindung und damit das Abfangen sämtlicher
Kommunikation zu unterbinden, muss die Verbindung verschlüsselt werden.
Um eine HTTP-Verbindung zu verschlüsseln wird diese durch das
TLS-Protokoll zu einer HTTP<strong>S</strong>-Verbindung erweitert.
HTTPS ist heute glücklicherweise der Standard bei den meisten
Internetseiten. Dass Sie eine HTTPS-Verbindung zu einer Seite aufgebaut
haben, erkennen Sie in der Adresszeile Ihres Browsers anhand eines
Schlosssymbols, bei besonders starken Zertifikaten ggf. zusätzlich auch
anhand einer grünen Markierung (siehe die folgende Abbildung).</p>
<figure><img src="../fig/10-https-browser.png" alt="Browseradresszeile mit der Adresse https://uni-tuebingen.de. Durch ein Schlosssymbol wird die https-Verbindung dargestellt." class="figure mx-auto d-block"><div class="figcaption">HTTPS-Verbindung im Browser. das Schloss zeigt
eine verschlüsselte HTTPS-Verbindung an</div>
</figure><p>Die Grundlage des TLS-Protokolls stellen Zertifikate dar, die die
Authentizität der Website bestätigen.</p>
<p>Dazu ein nicht technisches Vergleichsbeispiel: Sie wollen bei einem
Geschäftsvorgang die Identität des Gegenübers überprüfen. Zeigt Ihnen
die Person einen selbst ausgestellten Ausweis, werden Sie diesem
Personalausweis nicht vertrauen. Zeigt die Person jedoch einen Ausweis,
der von einer Behörde ausgestellt wurde, welcher Sie vertrauen, können
Sie auch dem vorgelegten Ausweis vertrauen.</p>
<p>Übertragen auf die HTTPS-Verbindung sieht es wie folgt aus: Ein
Website-Betreiber kann sich selbst ein TLS-Zertifikat ausstellen (unter
Linux z.B. mit dem Programm <em>OpenSSL</em>) und dieses einem
anfragendem Webbrowser oder sonstigem Client präsentieren. Allerdings
kann einem solchen selbst ausgestellten Zertifikat nicht von Dritten
vertraut werden. Der Browser wird die Verbindung als unsicher ablehnen
und eine Warnmeldung zeigen. Damit ein Client dem Zertifikat vertrauen
kann, muss dieses genau wie beim Personalausweis von einer zentralen
Stelle ausgestellt werden. Diese zentralen Stellen (als
<em>Zertifizierungsstellen</em> oder im Englischen als <em>Certificate
Authority</em> bezeichnet) können auf Anfrage ein Zertifikat ausstellen,
sofern die Identität der anfragenden Stelle gewährleistet ist.</p>
<p>Gleichzeitig besitzt die Zertifizierungsstelle selbst ein Zertifikat,
dass deren Identität bestätigt. Dieses Zertifizierungsstellenzertifikat
wiederum ist vom Hersteller Ihres Betriebssystems auf Ihrem PC
hinterlegt und als vertrauenswürdig eingestuft worden. Überprüft Ihr
Browser nun das Zertifikat der Website, stellt er zunächst fest, dass
das präsentierte Zertifikat von einer Zertifizierungsstelle ausgestellt
wurde, welcher er vertraut. Außerdem wird überprüft, ob die aufgerufene
Adresse auch der im Zertifikat hinterlegten Adresse entspricht.</p>
<p>Rufen Sie eine Website auf, die ein falsches Zertifikat präsentiert
(z.B. für die falsche Adresse, ein abgelaufenes oder selbst
ausgestelltes Zertifikat), erhalten Sie eine Warnmeldung. Diese sollten
Sie ernst nehmen, da es auf einen Betrugsversuch hindeuten kann, in
welchem eine angreifende Person sich für die Website ausgibt, die Sie
eigentlich aufrufen wollten (z.B. die Seite Ihres Online-Bankings).</p>
<figure><img src="../fig/10_https-browser-unsecure.png" alt='Browserfenster, dass eine unsichere https-Verbindung zeigt, welche mit einer Warnung angezeigt wird: "Warnung: Mögliches Sicherheitsrisiko erkannt"' class="figure mx-auto d-block"><div class="figcaption">Fehlgeschlagene HTTPS-Verbindung im Browser mit
Sicherheitswarnung: die Verbindung schläg fehl, da die aufgerufne
Adresse (134.2.5.1) nicht der Adresse im Zertifikat entspricht
(ersichtlich nach Klick auf den Erweitert-Button)</div>
</figure>
</div>
<div class="section level3">
<h3 id="tls-verschlüsselung-einrichten">TLS-Verschlüsselung einrichten<a class="anchor" aria-label="anchor" href="#tls-verschl%C3%BCsselung-einrichten"></a>
</h3>
<p>Um die eigene Website per HTTPS erreichen zu können, muss der
Raspberry Pi ein Zertifikat von einer Zertifizierungsstelle erhalten,
die von allen Computern anerkannt ist. Während dies früher nur gegen
Bezahlung möglich war, existiert seit einigen Jahren mit <a href="https://letsencrypt.org/" class="external-link">Letsencrypt</a> ein gemeinnütziger
Anbieter, der kostenlose Zertifikate zur Verfügung stellt. Diese sind
jedoch nur drei Monate gültig und müssen dann verlängert werden.</p>
<p>Um ein solches Zertifikat zu erhalten, muss man gegenüber Letsencrypt
nachweisen, dass man die Eigentümerschaft über die Domain, für welche
das Zertifikat angefragt wird, hat. Das heißt: wenn Sie für die Adresse
<em>server.ddns-provider.de</em> ein Zertifikat erhalten wollen, müssen
Sie nachweisen, dass sie den Webserver, der die Seite
<em>server.ddns-provider.de</em> ausliefert, verwalten. Diesen Nachweis
erbringen Sie nicht manuell, sondern mit Hilfe des Programms
<strong>Certbot</strong>. Mit diesem Programm werden automatisiert
einige Informationen zwischen Ihrem Webserver und den Servern von
Letsencrypt ausgetauscht, anhand deren die Eigentümerrschaft
nachgewiesen werden kann. Anschließend wird das Zertifikat ausgestellt
und kann in den Einstellungen der Website integriert werden.</p>
<div class="section level4">
<h4 id="zertifikat-erhalten">Zertifikat erhalten:<a class="anchor" aria-label="anchor" href="#zertifikat-erhalten"></a>
</h4>
<ul>
<li>
<p>Snapd (alternative Paketverwaltung) <a href="https://snapcraft.io/docs/installing-snap-on-raspbian" class="external-link">installieren</a>:</p>
<ul>
<li><p>Installation: <code>sudo apt install snapd</code></p></li>
<li><p>Neustart: <code>sudo reboot</code></p></li>
<li><p>Kernpakete installieren:
<code>sudo snap install core; sudo snap refresh core</code></p></li>
<li><p>Certbot installieren:
<code>sudo snap install --classic certbot</code></p></li>
<li><p>Certbot-Befehle im System bekannt geben:
<code>sudo ln -s /snap/bin/certbot /usr/bin/certbot</code></p></li>
</ul>
</li>
<li><p>Überprüfen, ob der Webserver über HTTP auf Port 80 aus dem
Internet erreichbar ist (vgl. <a href="08-installationsvorbereitung-2.html#Test%20der%20externen%20Erreichbarkeit">Lektion
8: Test der externen Erreichbarkeit</a>)</p></li>
<li><p>Zertifikatsausstellung testen:
<code>sudo certbot certonly --apache -d &lt;server.ddns-provider.de&gt; --dry-run</code>
(Achtung: eigene Domain einsetzen)</p></li>
<li><p>Wenn der Test erfolgreich war, kann die Zertifikatsausstellung
durchgeführt werden:
<code>sudo certbot certonly --apache -d &lt;server.ddns-provider.de&gt;</code>
(Achtung: eigene Domain einsetzen)</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="system-von-http-auf-https-umstellen">System von HTTP auf HTTPS umstellen:<a class="anchor" aria-label="anchor" href="#system-von-http-auf-https-umstellen"></a>
</h4>
<ul>
<li><p>Wurde das Zertifikat erhalten, wird im Router die
<strong>Portweiterleitung</strong> für Port 80 gelöscht und stattdessen
für Port 443 (Standardport für HTTPS-Verbindungen) eingerichtet.
Anschließend wird auch am Raspberry Pi in der <strong>Firewall</strong>
Port 80 geschlossen und Port 443 geöffnet.</p></li>
<li><p>Apache-Webserver auf HTTPS umstellen: die Konfigurationsdatei der
Webiste unter <code>/etc/apache2/sites-available/nextcloud.conf</code>
muss angepasst werden</p></li>
</ul>
<pre class="apacheconf"><code>&lt;VirtualHost *:80&gt;
  DocumentRoot /var/www/nextcloud/
  ServerName  server.ddns-provider.de

  RewriteEngine on
  RewriteCond %{SERVER_NAME} =server.ddns-provider.de
  RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
&lt;/VirtualHost&gt;


&lt;IfModule mod_ssl.c&gt;
&lt;VirtualHost *:443&gt;
  DocumentRoot /var/www/nextcloud/
  ServerName  server.ddns-provider.de
  &lt;IfModule mod_headers.c&gt;
      Header always set Strict-Transport-Security "max-age=15552000; includeSubDomains"
    &lt;/IfModule&gt;
  &lt;Directory /var/www/nextcloud/&gt;
    Require all granted
    AllowOverride All
    Options FollowSymLinks MultiViews
    LimitRequestBody 2147483647
    &lt;IfModule mod_dav.c&gt;
      Dav off
    &lt;/IfModule&gt;
  &lt;/Directory&gt;

SSLCertificateFile /etc/letsencrypt/live/server.ddns-provider.de/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/server.ddns-provider.de/privkey.pem
Include /etc/letsencrypt/options-ssl-apache.conf
&lt;/VirtualHost&gt;
&lt;/IfModule&gt;</code></pre>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Aufgabe</h3>
<div class="callout-content">
<p>Schauen Sie sich auch diese Apache-Konfigurationsdatei genau an und
überlegen Sie sich, was die Einstellungen bewirken und welche Optionen
Sie an Ihr Setup anpassen sollten.</p>
</div>
</div>
</div>
<ul>
<li><p>SSL-Modul in Apache aktivieren:
<code>sudo a2enmod ssl</code></p></li>
<li><p>Wie nach jeder Änderung an den Konfigurationsdateien muss Apache
neugestartet werden:
<code>sudo systemctl restart apache2.service</code></p></li>
<li><p>Steuern Sie nun Ihre Website im Browser an, erreichen Sie den
Nextcloudinstallationsassistenten über eine verschlüsselte
HTTPS-Verbindung, erkennbar am Schlosssymbol in der
Adresszeile.</p></li>
<li><p>Überprüfen Sie die Stärke Ihrer HTTPS-Verbindung mit <a href="https://www.ssllabs.com/ssltest/" class="external-link">SSLLabs</a>. Dort tragen Sie
Ihre Adresse ein, setzen aber den Haken bei “Do not show the results on
the boards”. Sie sollten ein A+-Ergebnis erhalten. Schauen Sie sich aber
auch die Details des Berichts an. Evtl. sind dort noch Schwachstellen
gelistet, die Sie verbessern können.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="fehlerbehebung">Fehlerbehebung<a class="anchor" aria-label="anchor" href="#fehlerbehebung"></a>
</h4>
<p>Sollte die HTTPS-Verbindung nicht erfolgreich sein, müssen Sie sich
auf die Fehlersuche begeben. Hier einige Punkte, welche Sie überprüfen
können:</p>
<ul>
<li><p>Ist der Raspberry Pi via localhost und im Heimnetzwerk unter
seiner IP-Adresse über Port 443 erreichbar?</p></li>
<li><p>Läuft der Apache-Webserver? Überprüfen Sie dessen Status mit
<code>sudo systemctl status apache2.service</code>. Evtl. werden Ihnen
hier bereits Fehlermeldungen angezeigt. Sie können außerdem die
Apache-Log-Dateien unter <code>/var/log/apache2/</code> und das
komplette Journal mit <code>sudo journalctl -xeu apache2</code>
untersuchen.</p></li>
<li><p>Wurde das TLS-Zertifikat ordnungsgemäß ausgestellt? Überprüfen
Sie, ob unter dem Pfad
`/etc/letsencrypt/live/&lt;server.ddns-provider.de&gt;/ die Dateien
<em>fullchain.pem</em> und <em>privkey.pem</em> vorhanden sind.</p></li>
<li><p>Ist die Portweiterleitung in Ihrem Router richtig
eingestellt?</p></li>
<li><p>Funktioniert DDClient?
(<code>sudo systemctl status ddlcient</code> und
<code>sudo ddclient --query</code>)</p></li>
<li><p>Hat Ihr DDNS-Provider die richtige IP-Adresse für Ihre Domain
eingetragen? Melden Sie sich dazu im Webportal Ihres DDNS-Providers
an.</p></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>Unverschlüsselte HTTP-Verbindungen müssen vermieden
werden.</p></li>
<li><p>Für verschlüsselte HTTPS-Verbindungen wird ein TLS-Zertifikat
benötigt.</p></li>
<li><p>Mit Certbot können kostenlose Zertifikate von Letsencrypt
erhalten werden.</p></li>
<li><p>Für eine HTTPS-Verbindung müssen die Konfiguration des
Webservers, der Firewall und des Routers angepasst werden.</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>
</section></section><section id="aio-11-konfiguration-1"><p>Content from <a href="11-konfiguration-1.html">Installation und Konfiguration</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/11-konfiguration-1.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Wie installiere ich Nextcloud?</p></li>
<li><p>Wie kann ich die Installation anpassen?</p></li>
<li><p>Wie kann die Leistung optimiert werden?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Nextcloud im Webbrowser installieren</p></li>
<li><p>Nextcloud im Browser verwalten</p></li>
<li><p>Nextcloud über die CMD verwalten</p></li>
<li><p>Caching konfigurieren</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<hr class="half-width">
<p>Nachdem in den vorhergehenden Lektionen die Installationsdateien
heruntergeladen und jetzt durch Apache über eine HTTPS-Verbindung zur
Verfügung gestellt werden, kann die eigentliche Installation beginnen.
Dazu ruft man die eigene Domain im Webbrowser auf. Dort wird der
Installationsassistent von Nextcloud (“Installation wizard”)
erreicht.</p>
<p>Im Assistenten muss ein <strong>Adminstrator-Konto</strong> für
Nextcloud mit Username und Passwort angelegt werden. Es müssen außerdem
die Zugangsdaten für die in <a href="09-installationsvorbereitung-3.html">Lektion 9</a> erstellte
<strong>Datenbank</strong> eingegeben werden. Da auch das
<strong>Datenverzeichnis</strong> in einem angepassten Pfad auf dem
externen Speicher liegen soll (z.B. <code>/mnt/data/ncdata</code>), muss
auch der Standardpfad für das Datenverzeichnis angepasst werden.</p>
<p>Mehr zum Installationsassistenten findet sich im <a href="https://docs.nextcloud.com/server/stable/admin_manual/installation/installation_wizard.html" class="external-link">Handbuch</a>.</p>
</section><section><h2 class="section-heading" id="konfiguration">Konfiguration<a class="anchor" aria-label="anchor" href="#konfiguration"></a>
</h2>
<hr class="half-width">
<p>Nach der Installation kann und sollte die Nextcloudinstanz weiter
konfiguriert werden, um das System zu optimieren und seinen Bedürfnissen
anzupassen. Dafür bietet Nextcloud drei unterschiedliche Möglichkeiten
an, die teilweise dieselben Konfigurationsmöglichkeiten anbieten,
teilweise aber auch unterschiedliche.</p>
<ul>
<li><p>Konfiguration über die Weboberfläche</p></li>
<li><p>Konfiguration auf der Kommandozeile mit dem OCC-Tool</p></li>
<li><p>Konfiguration in der Datei
<code>/var/www/nextcloud/config/config.php</code></p></li>
</ul>
<div class="section level3">
<h3 id="weboberfläche">Weboberfläche<a class="anchor" aria-label="anchor" href="#weboberfl%C3%A4che"></a>
</h3>
<p>Meldet man sich in der Weboberfläche mit dem bei der Installation
erstellten Administrator-Account an, können in den
Verwaltungseinstellungen (erreichbar bei Klick auf das User-Icon in der
rechten oberen Ecke) verschiedene administrative Tätigkeiten vorgenommen
werden, sowie Fehlermeldungen und Systemberichte eingesehen werden.</p>
<figure><img src="../fig/11_Konfiguration_web.png" alt='Screenshot, welcher die Weboberfläche eines Nextcloud-Servers zeigt. Zu sehen ist darauf das geöffnete Kontextmenü nach Klick auf das Usericon. Der Maus-Cursor zeigt auf den Punkt "Verwaltungseinstellungen' class="figure mx-auto d-block"><div class="figcaption">Verwaltungseinstellungen in der Weboberfläche
öffnen</div>
</figure><p>In der Übersicht der Verwaltungseinstellungen werden Warnmeldungen
und Installationsprobleme angezeigt. Diese Warn- und Fehlermeldungen
sollten direkt nach der Installation ausführlich untersucht und behoben
werden. Dabei hilft meistens schon die Fehlermeldung als solches, das
Handbuch oder eine Internetrecherche weiter.</p>
<p>Ebensfalls wird in der Übersicht die aktuelle Version angezeigt und
auf evtl. vorhandene Aktualisierungen hingewiesen.</p>
<figure><img src="../fig/11_Konfguration_%C3%9Cbersicht.png" alt='Screeshot der die Übersicht der Verwaltungseinstellungen zeigt. Zu sehen sind die Punkte "Sicherheits- und Einrichtungswarnungen", "Version" und "Aktualisieren"' class="figure mx-auto d-block"><div class="figcaption">Übersicht der Verwaltungseinstellungen mit
Warnmeldungen und Aktualisierungsinformationen</div>
</figure><p>Sind alle Installationsfehler behoben, kann der Reiter
<em>Grundeinstellungen</em> betrachtet werden. Da Nextcloud im
Hintergrund regelmäßig verschiedene Aufgaben durchführt (z.B.
Dateiscans, Prüfung auf Aktualsierungen oder Papierkorbleerungen), muss
ein Tool für das Ausführen dieser Aufgaben festgelegt werden. Hierfür
wird <em>cron</em> empfohlen. Mit <em>cron</em> können auf Linuxsystemen
Aufgaben (sog. Cron-Jobs) definiert und zu bestimmten Zeitpunkten
ausgeführt werden. Dafür muss ein Eintrag in der Crontabelle des Users
angelegt werden, welcher die Aufgabe ausführen soll. Für die Erstellung
des Cronjobs für Nextcloud, wird die Crontabelle des www-data-Users mit
dem Befehl <code>sudo crontab -u www-data -e</code> bearbeitet und
folgender Eintrag ergänzt:
<code>*/5  *  *  *  * php -f /var/www/nextcloud/cron.php</code> Siehe
dazu auch das <a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/background_jobs_configuration.html#cron" class="external-link">Handbuch</a></p>
<p>Als weiterer Punkt der Grundeinstellungen empfiehlt es sich, einen
E-Mail-Server zu definieren, über welchen der Nextcloud-Server
Benachrichtungen verschicken kann. Dazu müssen die Zugangsdaten eines
Postausgangsservers (SMTP) angegeben werden. Für E-Mailadressen der
Universität Tübingen lassen sich die Einstellungen im <a href="https://faq.zdv.uni-tuebingen.de/otrs/public.pl?Action=PublicFAQZoom;ItemID=29" class="external-link">Wiki
des ZDV</a> nachlesen. Zu beachten ist, dass die Zugangsdaten im
Klartext in der Nextcloud-Konfigurationsdatei
(<code>/var/www/nextcloud/config/config.php</code>) stehen.</p>
</div>
<div class="section level3">
<h3 id="occ-tool">occ-Tool<a class="anchor" aria-label="anchor" href="#occ-tool"></a>
</h3>
<p>Zwar kann in der Weboberfläche schon einiges eingestellt werden,
häufig müssen Operationen aber über die Kommmandozeile erledigt werden.
Dafür steht das nextcloudintegrierte Programm <em>occ</em> zur
Verfügung. Die Nutzung des Programms ist im <a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/occ_command.html" class="external-link">Handbuch</a>
ausführlich beschrieben. In unserem Setup kann es wie folgt aufgerufen
werden:
<code>sudo -u www-data php /var/www/nextcloud/occ &lt;occ-Befehl&gt;</code>
Dabei steht eine Vielzahl an Befehlen zur Verfügung, die im Handbuch
beschrieben sind. Um z.B. ein Upgrade zu starten lautet der Befehl
<code>sudo -u www-data php /var/www/nextcloud/occ upgrade</code>
(Details siehe <a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/occ_command.html#command-line-upgrade-label" class="external-link">hier</a>).
Häufig müssen nach einem Upgrade auch <a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/occ_command.html#database-add-indices-label" class="external-link">Einträge
in der Datenbank</a> angepasst werden:
<code>sudo -u www-data php /var/www/nextcloud/occ db:add-missing-indices</code></p>
</div>
<div class="section level3">
<h3 id="konfigurationsdatei">Konfigurationsdatei<a class="anchor" aria-label="anchor" href="#konfigurationsdatei"></a>
</h3>
<p>Eine Weitere Möglichkeit der Konfiguration stellt die
Konfigurationsdatei <code>/var/www/nextcloud/config/config.php</code>
dar. Diese kann mit dem nano-Editor direkt bearbeitet werden. Allerdings
ist hierbei stets auf die korrekte PHP-Syntax zu achten. Wird das
occ-Tool genutzt, kümmert sich dieses um die Änderung der
Konfigurationsdatei. Allerdings sind nicht alle Konfigurationswerte
durch eigene occ-Befehle implementiert, weshalb die occ-Befehle für
manche Anpassungen komplex werden und das direkte Editieren der Datei
einfacher erscheint.</p>
</div>
</section><section><h2 class="section-heading" id="caching">Caching<a class="anchor" aria-label="anchor" href="#caching"></a>
</h2>
<hr class="half-width">
<p>Bei jedem Aufruf der Nextcloud-Website werden im Hintergrund Prozesse
gestartet (z.B. Skripte ausgeführt) und Dateien bereitgestellt. Um das
Laden der Seite zu beschleunigen, ist es empfehlenswert einen
Caching-Dienst zu nutzten. Dieser speichert einmal bereitgestellte
Dateien oder Skripte für einen gewissen Zeitraum zwischen, wodurch diese
bei erneutem Abruf schneller zur Verfügung stehen.</p>
<p>Nextcloud bietet unterschiedliche Caching-Implementationen an. Je
nachdem, wie groß der eigene Server ist, werden unterschiedliche <a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/caching_configuration.html" class="external-link">Lösungen
empfohlen</a>. Im Kurs nutzen wir die Lösung für <a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/caching_configuration.html#organizations-with-single-server" class="external-link">Organisationen
mit einzelnem Server</a>.</p>
<div class="section level3">
<h3 id="umsetzung">Umsetzung:<a class="anchor" aria-label="anchor" href="#umsetzung"></a>
</h3>
<ul>
<li><p>Caching-Dienst Redis und dessen PHP-Erweiterungen installieren:
<code>sudo apt install redis-server php-redis php-apcu</code></p></li>
<li><p>Nextloud-Konfigurationsdatei ergänzen:
<code>sudo nano /var/www/nextcloud/config/config.php</code></p></li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PHP<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode php" tabindex="0"><code class="sourceCode php"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="st">'memcache.local'</span> =&gt; <span class="st">'\OC\Memcache\APCu'</span><span class="ot">,</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="st">'memcache.distributed'</span> =&gt; <span class="st">'\OC\Memcache\Redis'</span><span class="ot">,</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="st">'memcache.locking'</span> =&gt; <span class="st">'\OC\Memcache\Redis'</span><span class="ot">,</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="st">'redis'</span> =&gt; [</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="st">'host'</span> =&gt; <span class="st">'/var/run/redis/redis-server.sock'</span><span class="ot">,</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="st">'port'</span> =&gt; <span class="dv">0</span><span class="ot">,</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="st">'timeout'</span> =&gt; <span class="fl">0.0</span><span class="ot">,</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>]<span class="ot">,</span></span></code></pre>
</div>
<ul>
<li>Redis Konfigurationsdatei anpassen:
<code>sudo nano /etc/redis/redis.conf</code>
</li>
</ul>
<pre><code>#[...]
port 0
#[...]
unixsocket /var/run/redis/redis-server.sock
unixsocketperm 770</code></pre>
<ul>
<li>PHP anpassen: In <code>/etc/php/8.2/cli/php.ini</code> und
<code>/etc/php/8.2/apache2/php.ini</code> folgende Angabe ergänzen:</li>
</ul>
<pre><code><span><span class="va">apc.enable_cli</span><span class="op">=</span><span class="fl">1</span></span></code></pre>
<ul>
<li><p>Berechtigungen für UNIX-Socket-Datei anpassen:
<code>sudo usermod -a -G redis www-data</code></p></li>
<li><p>Dienste neu starten:
<code>sudo systemctl restart apache2 &amp;&amp; sudo systemctl restart redis-server</code></p></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>Die Installation von Nextcloud kann im Webbrowser
erfolgen</p></li>
<li><p>Im Anschluss an die Installation muss das System auf Fehler
überprüft werden</p></li>
<li><p>Die Konfiguration des Servers kann im Browser, mit dem
occ-Programm oder mit der Konfigurationsdatei erfolgen</p></li>
<li><p>Für eine bessere Leistung empfiehlt sich die Implementierung
eines Caching-Dienstes</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-12-backup"><p>Content from <a href="12-backup.html">Backup</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/12-backup.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Was ist beim Thema Backup zu beachten?</p></li>
<li><p>Muss ich meinen Nextcloud-Server sichern?</p></li>
<li><p>Wie kann ich eine Backupstrategie aufsetzen?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Grundlagen zum Thema Backup lernen</p></li>
<li><p>Anwendung der Grundlagen auf das eigene System</p></li>
<li><p>Erstellen und ausführen von Skripten</p></li>
<li><p>Cronjobs zur automatischen Skriptausführung nutzen</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="grundlagen">Grundlagen<a class="anchor" aria-label="anchor" href="#grundlagen"></a>
</h2>
<hr class="half-width">
<p>Bereits in <a href="07-installationsvorbereitung-1.html">Kapitel
7</a> wurde auf die Notwendigkeit eines Backups eingegangen und die
gesamte Festplatte (bzw. SD-Karte) gesichert. Dadurch besteht eine
Möglichkeit, jederzeit den Stand zum Zeitpunkt von Kapitel 7
wiederherzustellen. Auch jetzt ist es empfehlenswert, ein Backup des
gesamten Systems zu erstellen.</p>
<p>Im laufenden Betrieb eignet sich das Sichern des gesamten Systems
weniger, da einerseits ein manuelles Eingreifen nötig ist und
andererseits auch große Datenmengen anfallen. Deshalb wird in diesem
Kapitel ein Verfahren aufgezeigt, welches es ermöglicht, im laufenden
Betrieb automatisiert Backups zu erstellen.</p>
<div class="section level3">
<h3 id="was-muss-gesichert-werden">Was muss gesichert werden?<a class="anchor" aria-label="anchor" href="#was-muss-gesichert-werden"></a>
</h3>
<p>Welche Inhalte eines Systems gesichert werden sollen, ist von den
eigenen Bedürfnissen abhängig. Es kann jedoch zwischen drei
Hauptkategorien an Daten unterschieden werden:</p>
<ul>
<li><p>Dateien (Bilder,Dokumente, Videos, Emails…)</p></li>
<li><p>Programme und Lizenzen (Installationsdateien, Konfigurationen,
ganze Installationen)</p></li>
<li><p>System (Betriebssystem mit (allen?) Konfigurationen)</p></li>
</ul>
<p>In vielen Fällen wird die Sicherung der Dateien ausreichen, da
Programme und System mit etwas Zeitaufwand wieder neu aufgesetzt werden
können. In zeitkritischen Umgebungen, wenn ein defektes System schnell
wieder verfügbar sein muss, empfiehlt es sich aber, dass gesamte System
zu sichern.</p>
</div>
<div class="section level3">
<h3 id="wie-muss-gesichert-werden">Wie muss gesichert werden?<a class="anchor" aria-label="anchor" href="#wie-muss-gesichert-werden"></a>
</h3>
<p>Es kann zwischen drei Varianten einer Sicherung unterschieden
werden:</p>
<ul>
<li><p>Vollsicherung</p></li>
<li><p>Differentielle Sicherung</p></li>
<li><p>Inkrementelle Sicherung</p></li>
</ul>
<p>Bei der <strong>Vollsicherung</strong> werden zu jeder Sicherungszeit
(z.B. täglich oder wöchentlich) alle Daten gesichert. Der Vorteil dieser
Variante ist, dass für eine Wiederherstellung der Daten nur die letzte
Sicherungsversion benötigt wird. Der Nachteil liegt im großen Speicher-
und Zeitbedarf, da bei jeder Sicherung alle Daten kopiert werden müssen,
also sowohl die ursprünglichen Daten, als auch die Daten, die seit der
letzten Sicherung neu hinzugekommen sind.</p>
<figure><img src="../fig/12_vollsicherung.png" alt="Diagramm, welches für jeden Wochentag einen Wert für den Speicherbedarf der Vollsicherung in TB anzeigt. Montags werden 4 TB benötigt. Mit jeder weiteren Sicherung erhöht sich der Betrag um neu hinzugekommene Daten. Am Ende der Woche werden 8,5 TB benötigt" class="figure mx-auto d-block"><div class="figcaption">Speicherbedarf einer täglichen Vollsicherung im
Wochenverlauf mit täglich steigendem Speicherbedarf</div>
</figure><p>Bei der <strong>differentiellen Sicherung</strong> wird zur ersten
Sicherungszeit eine Vollsicherung durchgeführt. Anschließend wird jeden
Tag eine Sicherung erstellt, welche alle seit der letzten Vollsicherung
geänderten oder neu erstellten Daten enthält. Der Vorteil dieser
Variante besteht darin, dass bei einer Wiederherstellung nur die letzte
Vollsicherung und die letzte differentielle Sicherung benötigt werden.
Der Nachteil liegt wie bei der Vollsicherung darin, dass nach wie vor
ein großer Speicherplatzbedarf besteht und die Daten dupliziert
vorliegen.</p>
<figure><img src="../fig/12_differentiell.png" alt="Diagramm, welches für jeden Wochentag einen Wert für den Speicherbedarf der differentiellen Sicherung in TB anzeigt. Montags werden 4 TB benötigt. Dienstags wird nur 1 TB für neue Daten benötigt. Jede weitere Sicherung benötigt jeweils den Bedarf des Vortags plus neu hinzugekommen Daten. Am Wochenende beträgt der Bedarf 4,7 TB" class="figure mx-auto d-block"><div class="figcaption">Speicherbedarf einer täglichen differentiellen
Sicherung im Wochenverlauf</div>
</figure><p>Bei der <strong>inkrementellen Sicherung</strong> werden jeden Tag
nur diejenigen Daten gesichert, die an diesem Tag geändert bzw. neu
hinzugekommen sind. Der Vorteil der inkrementellen Variante besteht
darin, dass vergleichsweise wenig Zeit und Speicherplatz benötigt wird,
da nur zu Beginn eine Vollsicherung erstellt wird und zu jeder weiteren
Sicherungszeit nur die Änderungen gesichert werden. Der Nachteil besteht
darin, dass im Falle einer Wiederherstellung die letzte Vollsicherung
und alle inkrementellen Zwischensicherungen benötigt werden.</p>
<figure><img src="../fig/12_inkrementell.png" alt="Diagramm, welches für jeden Wochentag einen Wert für den Speicherbedarf der inkrementellen Sicherung in TB anzeigt. Montags werden 4 TB benötigt. Dienstags wird nur 1 TB für neue Daten benötigt. Jede weitere Sicherung benötigt nur den Bedarf der an diesem Tag neu hinzugekommen Daten." class="figure mx-auto d-block"><div class="figcaption">Speicherbedarf einer täglichen inkrementellen
Sicherung im Wochenverlauf</div>
</figure><p>Neben der Art der Sicherung, muss auch überlegt werden, wie die
einzelnen Sicherungsversionen aufgehoben werden. Im obigen Beispiel zu
einer täglichen inkrementellen Sicherung und einer wöchentlichen
Vollsicherung können z.B. die Vollsicherung und die inkrementellen
Zwischensicherungen nur solange aufgehoben werden, bis eine neue
Vollsicherung erstellt wurde. Möchte man jedoch gewährleisten, auch auf
einen Datenstand von vor 6 Monaten zurück gehen zu können, sollten die
Sicherungen länger aufgehoben werden. Z.B. könnte dann eine monatliche
Vollsicherung in jeweils sechs Versionen aufbewahrt werden. Wird eine
siebte Version erstellt, wird die älteste gelöscht.</p>
<p>Ein bekanntes Schema zur Versionierung von Sicherungen ist das
Generationenprinzip (auch als Großvater-Vater-Sohn-Prinzip bezeichnet).
Bei diesem Prinzip werden täglich Backups erstellt. Diese werden eine
Woche lang aufbewahrt. Anschließend werden die täglichen Versionen zu
einem Wochenbackup zusammengefasst. Die wöchentlichen Backups werden für
einen Monat aufbewahrt und nach einem Monat zu einer Monatssicherung
zusammen gefasst. Diese monatlichen Sicherungen werden für 12 Monate
aufbewahrt. Dadurch bestehen für die letzten sieben Tage jeweils
tägliche Versionen, für den letzten Monat wöchentliche Versionen und für
das letzte Jahr noch monatliche Versionen. Graphisch ist dieses
Verfahren <a href="https://images.vogel.de/infodienste/smimagedata/1/4/1/6/5/9/53.jpg" class="external-link">hier</a>
dargestellt.</p>
</div>
<div class="section level3">
<h3 id="wo-muss-gesichert-werden">Wo muss gesichert werden?<a class="anchor" aria-label="anchor" href="#wo-muss-gesichert-werden"></a>
</h3>
<p>Ist geklärt, was und wie gesichert werden soll, muss noch geklärt
werden, wo gespeichert werden soll. Grundlegend sollten Sicherungen
nicht auf demselben physischen Datenträger wie die Originaldaten
gespeichert werden. Die <strong>3-2-1-Regel</strong> gilt als ein guter
Richtwert: 3 Kopien auf 2 unterschiedlichen Medien, 1 Offsite-Kopie.
Speichert man auf unterschiedlichen Medien, hat man mehr Felxibilität
bei der Wiederherstellung. Die Offsite-Kopie an einem anderen Ort wird
wichtig, wenn am ursprünglichen Serverstandort ein größerer Schaden
Eintritt (z.B. Feuer, Wasser, Kurzschluss oder Einbruch).</p>
<p>Mehr zum Thema Datensicherung findet sich z.B. auch bei <a href="https://wiki.ubuntuusers.de/Datensicherung/" class="external-link">Ubuntuusers</a> oder
bei <a href="https://www.netzwelt.de/sicherheit/backup/backup-arten-erklaert.html" class="external-link">Netzwelt</a>.</p>
</div>
</section><section><h2 class="section-heading" id="der-eigene-backupplan">Der eigene Backupplan<a class="anchor" aria-label="anchor" href="#der-eigene-backupplan"></a>
</h2>
<hr class="half-width">
<p>Die zuvor dargestellten Methoden und Standards sind nicht immer
einfach umzusetzen. Das ist mit ein Grund dafür, dass in vielen Fällen
keine Sicherungen gemacht werden, da der Aufwand für die Implementierung
einer Sicherungsstrategie zu groß erscheint. Deshalb ist es insbesondere
für Heimanwender und kleinere Organisationen mit wenig zeitkritischen
Daten oftmals besser ein mittelmäßiges Backup zu haben als gar keines
und dafür nicht alle der zuvor genannten Regeln zu befolgen.</p>
<div id="backup-für-den-nextcloud-server" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="backup-für-den-nextcloud-server" class="callout-inner">
<h3 class="callout-title">Backup für den Nextcloud-Server</h3>
<div class="callout-content">
<p>Überlegen Sie sich, wie Sie Ihren Nextcloud-Server sichern können.
Was (welche Daten) sollten Sie sichern? Wie sichern Sie (mit welcher
Variante)? Suchen Sie im Internet nach Programmen oder Workflows, um
eine Nextcloud-Instanz zu sichern. Wo speichern Sie die Sicherungen?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Das <a href="https://docs.nextcloud.com/server/stable/admin_manual/maintenance/backup.html" class="external-link">Handbuch</a>
listet die grundlegenden Schritte auf, um den Nextcloud-Server zu
sichern: 1. das Konfigurationsverzeichnis unter
<code>/var/www/nextcloud/config</code>, 2. das Datenverzeichnis, z.B.
unter <code>/mnt/data/ncdata</code>, 3. der Theme-Folder unter
<code>/var/www/nextcloud/themes</code> (nur wichtig wenn eigene Themes
genutzt werden) und 4. die Nextcloud-Datenbank des MariaDB-Servers.</p>
<p>Sinnvollerweise wird man eine inkrementelle Sicherung wählen, um Zeit
und Speicherplatz zu sparen. Während das Handbuch zwar die einzelnen
manuellen Schritte aufzeigt (Maintanance-Modus aktivieren, Ordner mit
rsync sichern, Datenbank mit mysqldump sichern) gibt es viele Tools mit
denen Nextcloud gesichert werden kann. Z.B. <a href="https://www.c-rieger.de/backup-mit-de-duplizierung/" class="external-link">Borg-Backup</a>,
<a href="https://www.youtube.com/watch?v=7ZayfpZsgk0" class="external-link">Duplicati</a> oder
die Nextcloud-integrierte <a href="https://apps.nextcloud.com/apps/backup" class="external-link">Backup-App</a>. Eine
weitere Möglichkeit besteht im schreiben eines eigenen Skripts (eines
Mini-Programms), welches leicht an die eigenen Bedürfnisse angepasst
werden kann.</p>
<p>Die Sicherungen können zunächst auf einer zweiten Festplatte, die am
Raspberry Pi eingebunden ist, gespeichert werden. Mehr Unabhängigkeit
vom Hauptsystem erhält man, wenn man die Sicherung über das Netzwerk auf
einem zweiten Gerät speichert. Das kann z.B. per <a href="https://wiki.ubuntuusers.de/Samba_Server/" class="external-link">Netzlaufwerk im
Heimnetz</a> geschehen oder per SSH auf entfernte Rechner (<a href="https://medium.com/@techfocuspro/raspberry-pi-remote-backup-ensuring-your-datas-safety-4b50848f4817" class="external-link">medium.com</a>
oder <a href="https://bioslevel.com/article/backing-up-to-a-remote-server-with-ssh-and-rsync/" class="external-link">bioslevel.com</a>).</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="backupscript-erstellen">Backupscript erstellen<a class="anchor" aria-label="anchor" href="#backupscript-erstellen"></a>
</h2>
<hr class="half-width">
<p>Eine verhältnismäßig simple Backup-Lösung für Nextcloud ist ein
Bash-Skript, in welchem die Befehle aus dem Handbuch eingetragen werden
und welches dann zeitgesteuert ausgeführt wird.</p>
<div class="section level3">
<h3 id="bash-skripting">Bash-Skripting<a class="anchor" aria-label="anchor" href="#bash-skripting"></a>
</h3>
<p>Ohne den Anspruch auf Vollständigkeit zu erheben sei kurz auf die
absoluten Grundlagen des Bash-Skriptings eingegangen. Beim
Bash-Skripting werden die Befehle, die man normalerweise nach einander
auf der Kommandozeile tippt, gesammelt in eine Textdatei geschrieben,
ein sogenanntes Bash-Skript. Dieses wird immer mit der Shebang
bezeichneten Syntax in der ersten Zeile eingeleitet:
<code>#!/bin/bash</code></p>
<p>Anschließend können Befehle wie auf der Kommandozeile geschrieben
werden, das Skript gespeichert und mit <code>sudo chmod ug+x</code>
ausführbar gemacht werden.</p>
<p>Beispiel:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># Das ist ein Kommentar. Der wird ignoriert</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Mit echo kann Text ausgegeben werden</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="bu">echo</span> Hallo Welt</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># Mit touch kann eine neue Datei text.txt erstellt werden</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">touch</span> text.txt</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># mit find kann nach Dateien gesucht werden</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">find</span> . text.<span class="pp">*</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co"># mit rm können Dateien gelöscht werden</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">rm</span> text.txt</span></code></pre>
</div>
<p>Bei Ubuntuusers findet sich ein <a href="https://wiki.ubuntuusers.de/Shell/Bash-Skripting-Guide_f%C3%BCr_Anf%C3%A4nger/" class="external-link">Skripting-Guide</a>
mit mehr Details</p>
</div>
<div class="section level3">
<h3 id="nextcloud-backup-mit-bash-skript">Nextcloud-Backup mit Bash-Skript<a class="anchor" aria-label="anchor" href="#nextcloud-backup-mit-bash-skript"></a>
</h3>
<p>Für einen Nextcloud-Server könnte ein Skript in den Grundzügen wie
folgt aussehen (keine Garantie auf Korrektheit oder
Vollständigkeit):</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Backup-Zielverzeinis als Variable definieren</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="va">backup_dir</span><span class="op">=</span><span class="st">'/mnt/data/backup_nextcloud'</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Backup-Quellen als Variable definieren</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="va">data_dir</span><span class="op">=</span><span class="st">'/mnt/data/nextcloud/'</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="va">themes_dir</span><span class="op">=</span><span class="st">'/var/www/nextcloud/themes'</span> </span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="va">config_dir</span><span class="op">=</span><span class="st">'/var/www/nextcloud/config'</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#Zeitstempel als Variable</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="va">datetime</span><span class="op">=</span><span class="st">"</span><span class="va">$(</span><span class="fu">date</span> +<span class="st">'%Y-%m-%d_%H-%M-%S'</span><span class="va">)</span><span class="st">"</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#Link zum letzten Backup definieren</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="va">latest_link</span><span class="op">=</span><span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/latest"</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co"># Pfade erstellen</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">## Backup-Verzeichnis</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="va">$backup_dir</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"erstelle Backupverzeichnis </span><span class="va">$backup_dir</span><span class="st">"</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    <span class="fu">mkdir</span> <span class="va">$backup_dir</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    </span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="cf">elif</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="va">$backup_dir</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st"> existiert bereits"</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="cf">fi</span>    </span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">##Unterverzeichnisse</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/data"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>    	<span class="bu">echo</span> <span class="st">"erstelle Unterverzeichnis "</span>Data<span class="st">""</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>    	<span class="fu">mkdir</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/data"</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/data"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>	<span class="bu">echo</span> <span class="st">" Unterverzeichnis "</span>Data<span class="st">" existiert bereits"</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>    <span class="cf">fi</span> </span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/config"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>    	<span class="bu">echo</span> <span class="st">"erstelle Unterverzeichnis "</span>config<span class="st">""</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>    	<span class="fu">mkdir</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/config"</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/config"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>	<span class="bu">echo</span> <span class="st">" Unterverzeichnis "</span>config<span class="st">" existiert bereits"</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/themes"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">"erstelle Unterverzeichnis "</span>themes<span class="st">""</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>        <span class="fu">mkdir</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/themes"</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/themes"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">" Unterverzeichnis "</span>themes<span class="st">" existiert bereits"</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/databases"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>    	<span class="bu">echo</span> <span class="st">"erstelle Unterverzeichnis "</span>databases<span class="st">""</span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a>    	<span class="fu">mkdir</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/databases"</span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="st">"</span><span class="va">$backup_dir</span><span class="st">/databases"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a>	<span class="bu">echo</span> <span class="st">" Unterverzeichnis "</span>databases<span class="st">" existiert bereits"</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="co">## Latest-Verzeichnis</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="va">$latest_link</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"erstelle Latest-verzeichnis </span><span class="va">$latest_link</span><span class="st">"</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a>    <span class="fu">mkdir</span> <span class="va">$latest_link</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a><span class="cf">elif</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="va">$latest_link</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"</span><span class="va">$latest_link</span><span class="st"> existiert bereits"</span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a><span class="co">#Latest-Links erstellen</span></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/data/</span><span class="va">${datetime}</span><span class="st">"</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/data"</span></span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/config/</span><span class="va">${datetime}</span><span class="st">"</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/config"</span></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/themes/</span><span class="va">${datetime}</span><span class="st">"</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/themes"</span></span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a><span class="co"># Nextcloud in den Maintenance mode versetzen</span></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> www-data php /var/www/nextcloud/occ maintenance:mode <span class="at">--on</span></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a><span class="co"># Inkrementelles Backup der Daten erstellen:</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"trying backup data directory"</span></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a><span class="fu">rsync</span> <span class="at">-Aax</span> <span class="at">--delete</span>  <span class="st">"</span><span class="va">${data_dir}</span><span class="st">"</span> <span class="dt">\</span></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a>    <span class="at">--link-dest</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/data"</span> <span class="dt">\</span></span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a>     <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/data/</span><span class="va">${datetime}</span><span class="st">"</span></span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a></span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a><span class="co"># Inkrementelles Backup des Konfigurationsverzeichnisses durchführen</span></span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a><span class="fu">rsync</span> <span class="at">-Aax</span> <span class="at">--delete</span> <span class="at">--exclude</span> <span class="st">'ccnet.sock'</span> <span class="st">"</span><span class="va">${config_dir}</span><span class="st">"</span> <span class="dt">\</span></span>
<span id="cb2-74"><a href="#cb2-74" tabindex="-1"></a>    <span class="at">--link-dest</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/config"</span> <span class="dt">\</span></span>
<span id="cb2-75"><a href="#cb2-75" tabindex="-1"></a>    <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/config/</span><span class="va">${datetime}</span><span class="st">"</span></span>
<span id="cb2-76"><a href="#cb2-76" tabindex="-1"></a></span>
<span id="cb2-77"><a href="#cb2-77" tabindex="-1"></a><span class="fu">rsync</span> <span class="at">-Aax</span> <span class="at">--delete</span> <span class="st">"</span><span class="va">${themes_dir}</span><span class="st">"</span> <span class="dt">\</span></span>
<span id="cb2-78"><a href="#cb2-78" tabindex="-1"></a>    <span class="at">--link-dest</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/themes"</span> <span class="dt">\</span></span>
<span id="cb2-79"><a href="#cb2-79" tabindex="-1"></a>    <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/themes/</span><span class="va">${datetime}</span><span class="st">"</span></span>
<span id="cb2-80"><a href="#cb2-80" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" tabindex="-1"></a><span class="co">#Latest-Verweis aktualisieren</span></span>
<span id="cb2-82"><a href="#cb2-82" tabindex="-1"></a><span class="fu">rm</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/data"</span></span>
<span id="cb2-83"><a href="#cb2-83" tabindex="-1"></a><span class="fu">rm</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/config"</span></span>
<span id="cb2-84"><a href="#cb2-84" tabindex="-1"></a><span class="fu">rm</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/themes"</span></span>
<span id="cb2-85"><a href="#cb2-85" tabindex="-1"></a></span>
<span id="cb2-86"><a href="#cb2-86" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/data/</span><span class="va">${datetime}</span><span class="st">"</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/data"</span></span>
<span id="cb2-87"><a href="#cb2-87" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/config/</span><span class="va">${datetime}</span><span class="st">"</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/config"</span></span>
<span id="cb2-88"><a href="#cb2-88" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/themes/</span><span class="va">${datetime}</span><span class="st">"</span> <span class="st">"</span><span class="va">${latest_link}</span><span class="st">/themes"</span></span>
<span id="cb2-89"><a href="#cb2-89" tabindex="-1"></a></span>
<span id="cb2-90"><a href="#cb2-90" tabindex="-1"></a><span class="co"># create mysql database backup:</span></span>
<span id="cb2-91"><a href="#cb2-91" tabindex="-1"></a><span class="fu">sudo</span> mysqldump <span class="at">--single-transaction</span> <span class="at">--default-character-set</span><span class="op">=</span>utf8mb4 <span class="at">-h</span> localhost nextcloud <span class="op">&gt;</span> <span class="st">"</span><span class="va">${backup_dir}</span><span class="st">/databases/"</span>nextcloud-sqlbkp_<span class="kw">`</span><span class="fu">date</span> +<span class="st">"%Y-%m-%d-%H-%M-%S"</span><span class="kw">`</span>.bak</span>
<span id="cb2-92"><a href="#cb2-92" tabindex="-1"></a></span>
<span id="cb2-93"><a href="#cb2-93" tabindex="-1"></a><span class="co"># Maintenance mode beenden</span></span>
<span id="cb2-94"><a href="#cb2-94" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> www-data php /var/www/nextcloud/occ maintenance:mode <span class="at">--off</span></span>
<span id="cb2-95"><a href="#cb2-95" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" tabindex="-1"></a><span class="co">#21 Tage alte Backups suchen und loeschen</span></span>
<span id="cb2-97"><a href="#cb2-97" tabindex="-1"></a><span class="fu">find</span> <span class="va">$backup_dir</span>/data <span class="at">-maxdepth</span> 1 <span class="at">-mtime</span> +21 <span class="at">-type</span> d <span class="at">-exec</span> rm <span class="at">-rf</span> {} +</span>
<span id="cb2-98"><a href="#cb2-98" tabindex="-1"></a><span class="fu">find</span> <span class="va">$backup_dir</span>/config <span class="at">-maxdepth</span> 1 <span class="at">-mtime</span> +21 <span class="at">-type</span> d <span class="at">-exec</span> rm <span class="at">-rf</span> {} +</span>
<span id="cb2-99"><a href="#cb2-99" tabindex="-1"></a><span class="fu">find</span> <span class="va">$backup_dir</span>/themes <span class="at">-maxdepth</span> 1 <span class="at">-mtime</span> +21 <span class="at">-type</span> d <span class="at">-exec</span> rm <span class="at">-rf</span> {} +</span>
<span id="cb2-100"><a href="#cb2-100" tabindex="-1"></a><span class="fu">find</span> <span class="va">$backup_dir</span>/databases <span class="at">-maxdepth</span> 1 <span class="at">-mtime</span> +21 <span class="at">-type</span> f <span class="at">-exec</span> rm {} +</span></code></pre>
</div>
<div id="backup-skript-lesen-und-verstehen" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="backup-skript-lesen-und-verstehen" class="callout-inner">
<h3 class="callout-title">Backup-Skript lesen und verstehen</h3>
<div class="callout-content">
<p>Schauen Sie sich das oben gezeigte Backup-Skript genau an. Können Sie
verstehen, was dieses Skript macht? Welche Parameter müssen Sie
anpassen, damit dieses Skript für Ihr Setup funktioniert? Was sind die
essentiellen Befehle, die ausgeführt werden?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Zeige mir die Lösung </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Von oben nach unten macht das Skript folgendes:</p>
<p>Es werden Variablen für die Backupquelle, das Backupziel und die
aktuelle Zeit definiert.</p>
<p>Es werden leere Verzeichnisse im Backupziel erstellt, sofern diese
noch nicht vorhanden sind.</p>
<p>Es werden Links auf die aktuelle Backupversion erstellt.</p>
<p>Nextcloud wird mit dem occ-Tool in den maintanace-Modus versetzt.</p>
<p>Mit rsync werden die Datenverzeichnisse gesichert.</p>
<p>Mit mysqldump wird die Datenbank gesichert.</p>
<p>Mit dem occ-Tool wird der maintanance-Modus wieder verlassen.</p>
<p>mit dem find-Befehl werden Sicherungsversionen, die älter als 21 Tage
sind, gelöscht.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="cron-und-cronjobs">Cron und Cronjobs<a class="anchor" aria-label="anchor" href="#cron-und-cronjobs"></a>
</h2>
<hr class="half-width">
<p>Hat man ein Skript erstellt, sollte dieses manuell getestet werden,
indem es auf der Kommandozeile aufgerufen wird: <code>./skript.sh</code>
Benötigen die Befehle im Skript sudo-Rechte, muss das Skript auch mit
sudo-Rechten ausegführt werden (ACHTUNG: dann werden alle Befehle mit
root-Rechten ausgeführt): <code>sudo ./skript.sh</code></p>
<p>Ist der manuelle Test erfolgreich verlaufen, kann das Skript mittels
Cron automatisch zu bestimmten Zeiten ausgeführt werden. Wie im
vorherigen Kapitel zur Nextcloud-Konfiguration erwähnt, ist Cron ein
Programm, mit welchem Befehle zu bestimmten Zeiten automatisch
ausgeführt werden. Diese Befehle werden in der Crontabelle gespeichert.
Jeder User des Betriebssystems hat eine eigene Crontabelle. Soll ein
Befehl mit Root-Rechten ausgeführt werden, muss der Befehl in die
Crontabelle des root-Accounts eingetragen werden, Befehle, die durch den
www-data-User ausgeführt werden sollen, gehören in dessen
Cron-Tabelle.</p>
<p>Die Crontabelle eines Users kann wie folgt angezeigt werden:
<code>sudo crontab -u &lt;username&gt; -l</code> Um die Tabelle zu
ändern lautet der Befehl wie folgt:
<code>sudo crontab -u &lt;username&gt; -e</code></p>
<p>Die Einträge für jeden Cron-Job (also jeden auszuführenden Befehl)
sind wie folgt aufgebaut: Zeitangabe für die Ausführung und
auszuführender Befehl. Die Zeitangabe erfolgt dabei in fünf einzelnen
Einheiten: 1. Angabe der Minute (0-59), 2. Angabe der Stunde (0-23), 3.
Angabe des Tages (1-31), 4. Angabe des Monats (1-12) und 5. Angabe des
Wochentages (0-7). Mehr zu cron findet sich z.B. <a href="https://wiki.ubuntuusers.de/Cron/" class="external-link">Ubuntuusers</a>.</p>
<p>Beispiel: um das Skript backup.sh im Verzeichnis
<code>/home/administrator/</code> jeden Montag um 14:30 auszuführen
lautet der Eintrag wie folgt:</p>
<pre><code>30 14 * * 1 sh /home/administrator/backup.sh</code></pre>
<p>Ist der Cronjob erstellt, muss überprüft werden, ob das Skript zur
eingestellten Zeit tatsächlich läuft und das gewünschte Ergebnis
liefert.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Wichtig</h3>
<div class="callout-content">
<p><strong>ACHTUNG:</strong> Das Backupskript wird mit root-Rechten
ausgeführt. Deshalb muss die Datei selbst vor Änderungen durch andere
User geschützt werden. Sonst könnten nicht berechtigte User das Skript
ändern und Befehle mit root-Rechten ausführen lassen (z.B. sich selbst
zur sudo-Gruppe hinzufügen). Deshalb darf das Skript nur durch den
root-User geändert werden:
<code>sudo chown root:root /home/administrator/backup.sh</code> und
<code>sudo chmod 700 /home/administrator/backup.sh</code></p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="restore">Restore<a class="anchor" aria-label="anchor" href="#restore"></a>
</h2>
<hr class="half-width">
<p>Ein Backup ist nur hilfreich, wenn es auch wieder hergestellt werden
kann. Deshalb sollte schon beim erstellen der Sicherung klar sein, wie
die Daten im Ernstfall wieder hergestellt werden könnnen. Im Falle von
Nextcloud können die Dateien im Backup-Verzeichnis gefunden werden. Von
dort können die Dateien wieder an den Ursprungsort kopiert werden (z.B.
mir rsync oder dem cp-Befehl). Die Datenbanksicherung kann wie folgt
wieder hergestellt werden:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>mysql <span class="op">-</span>h localhost <span class="op">-</span>u <span class="op">&lt;</span>username<span class="op">&gt;</span> <span class="op">-</span>p<span class="op">&lt;</span><span class="kw">password</span><span class="op">&gt;</span> <span class="op">-</span>e <span class="ot">"DROP DATABASE nextcloud"</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>mysql <span class="op">-</span>h localhost <span class="op">-</span>u <span class="op">&lt;</span>username<span class="op">&gt;</span> <span class="op">-</span>p<span class="op">&lt;</span><span class="kw">password</span><span class="op">&gt;</span> <span class="op">-</span>e <span class="ot">"CREATE DATABASE nextcloud CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci"</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>mysql <span class="op">-</span>h localhost <span class="op">-</span>u <span class="op">&lt;</span>username<span class="op">&gt;</span> <span class="op">-</span>p<span class="op">&lt;</span><span class="kw">password</span><span class="op">&gt;</span> <span class="op">&lt;</span>db_name<span class="op">&gt;</span> <span class="op">&lt;</span> nextcloud<span class="op">-</span>sqlbkp_2024<span class="op">-</span><span class="dv">10</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">14</span><span class="op">-</span><span class="dv">30</span><span class="op">-</span><span class="fl">44.</span>bak</span></code></pre>
</div>
<p>Das Handbuch schildert den <a href="https://docs.nextcloud.com/server/stable/admin_manual/maintenance/restore.html" class="external-link">Restore-Prozess</a>
ebenfalls.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>inkrementelle Backups sind speicherplatz- und
zeitsparend</p></li>
<li><p>besser ein mittelmäßiges Backup als gar kein Backup</p></li>
<li><p>Per Bash-Skript und cron-Job kann der Nextcloud-Server
automatisch gesichert werden</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-13-konfiguration-2"><p>Content from <a href="13-konfiguration-2.html">Konfiguration 2</a></p>
<hr>
<p>Zuletzt aktualisiert am 2025-04-14 |

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/episodes/13-konfiguration-2.Rmd" class="external-link">Diese Seite bearbeiten <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Geschätzte Zeit: <i aria-hidden="true" data-feather="clock"></i> 135 Minuten</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Alle Lösungen anzeigen " data-collapse="Alle Lösungen ausblenden "> Alle Lösungen anzeigen <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Übersicht</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Fragen</h3>
<ul>
<li><p>Wie kann ich meinen Nextcloud-Server aktualisieren?</p></li>
<li><p>Was kann ich noch für bessere Performance tun?</p></li>
<li><p>Kann ich die Funktionalität erweitern?</p></li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Ziele</h3>
<ul>
<li><p>Upgrade im Browser und per CMD</p></li>
<li><p><em>Pretty URLs</em> konfigurieren</p></li>
<li><p>Server Tuning: Mehr Leistung für das System</p></li>
<li><p>Server Hardening: mehr Sicherheit für das System</p></li>
<li><p>Apps und Integrationen</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="nextcloud-aktualisieren">Nextcloud aktualisieren<a class="anchor" aria-label="anchor" href="#nextcloud-aktualisieren"></a>
</h2>
<hr class="half-width">
<p>Der gesamte Upgrade-Prozess ist im <a href="https://docs.nextcloud.com/server/stable/admin_manual/maintenance/upgrade.html" class="external-link">Handbuch</a>
ausführlich geschildert. Wie vor allen größeren Systemeingriffen,
empfiehlt sich auch vor einem Upgrade ein Backup wie in <a href="12-backup.html">Kapitel 12</a> geschildert.</p>
<p>Ob eine neue Version verfügbar ist, kann der Übersicht in den
Verwaltungseinstellungen entnommen werden (vgl. <a href="11-konfiguration-1.html">Kapitel 11</a>). Die Aktualisierung
erfolgt in Abhängkeit des eigenen Systems auf unterschiedliche Weise. Im
Falle der in diesem Kurs vorgenommenen manuellen Installation kann der
<em>Built-in Updater</em> genutzt werden oder manuell durch Download der
neuen Version das System aktualisiert werden. Im Folgenden wird der
Built-in-Updater als empfohlene Variante genutzt.</p>
<p>Bei der Aktualisierung ist zwischen den unterschiedlichen Versionen
zu differenzieren:</p>
<ul>
<li><p>Major release upgrade: 28.x zu 29.x</p></li>
<li><p>Maintenance release upgrade 28.1 zu 28.2</p></li>
<li><p>Point release upgrade: 28.1.0 zu 28.1.1</p></li>
</ul>
<p>Insbesondere bei einem major release upgrade sollten zuvor die <a href="https://docs.nextcloud.com/server/stable/admin_manual/release_notes/index.html#critical-changes" class="external-link">Release
Notes</a> beachtet werden, um zu überprüfen, ob das Upgrade weitere
Systemanpassungen erforderlich macht.</p>
<p>Sind die Voraussetzungen geklärt, kann der <em>Built-in Updater</em>
entweder im Browser in der Übersicht der Verwaltungseinstellungen oder
über die Kommandozeile mit dem Befehl
<code>sudo -u www-data php /var/www/nextcloud/updater/updater.phar</code>
gestartet werden. Sowohl im Browser, als auch in der Kommandozeile wird
man vom <em>Built-in Updater</em> interaktiv durch den Upgrade-Prozess
geleitet. Dabei werden die neuen Programmdateien heruntergeladen und die
alten durch die neuen ersetzt. Allerdings ist anschließend noch der
eigentliche Migrationsschritt auf Datenbankebene nötig. Dieser Schritt
kann entweder im Browser gestartet werden, wenn am Ende des Upgrades der
Maintanance-Modus deaktiviert wird, oder über die Kommandozeile mit dem
Befehl
<code>sudo -u www-data php /var/www/nextcloud/occ upgrade</code></p>
<p>Im Anschluss an den Migrationsschritt können weitere Schritte nötig
sein, die nur mit dem occ-Tool durchgeführt werden können. Ob und welche
Schritte notwendig sind, wird in der Übersicht der
Verwaltungseinstellungen angezeigt.</p>
</section><section><h2 class="section-heading" id="server-tuning">Server Tuning<a class="anchor" aria-label="anchor" href="#server-tuning"></a>
</h2>
<hr class="half-width">
<p>Um die Leistung und die Benutzerfreundlichkeit des Nextcloud-Servers
zu verbessern, können noch einige Einstellungen vorgenommen werden.</p>
<div class="section level3">
<h3 id="pretty-urls">Pretty URLs<a class="anchor" aria-label="anchor" href="#pretty-urls"></a>
</h3>
<p>Um die URLs der Nextcloud-Instanz abzukürzen und dadurch
verständlicher zu machen, müssen zwei Apache-Module aktiviert werden
(sofern noch nicht geschehen):
<code>sudo a2enmod env &amp;&amp; sudo a2enmod rewrite</code></p>
<p>Anschließend muss die Nextcloud-Konfigurationsdatei mit zwei
Einträgen ergänzt werden:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PHP<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode php" tabindex="0"><code class="sourceCode php"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="st">'overwrite.cli.url'</span> =&gt; <span class="st">'https://server.ddns-provider.de'</span><span class="ot">,</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="st">'htaccess.RewriteBase'</span> =&gt; <span class="st">'/'</span><span class="ot">,</span></span></code></pre>
</div>
<p>Dabei muss die eigene DDNS-URL anstatt des Platzhalters eingetragen
werden. Abschließend muss einmalig die .htaccess-Datei aktulisiert
werden:
<code>sudo -u www-data php /var/www/nextcloud/occ maintenance:update:htaccess</code></p>
<div id="htaccess" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="htaccess" class="callout-inner">
<h3 class="callout-title">.htaccess</h3>
<div class="callout-content">
<p>.htaccess-Dateien können in beliebigen Verzeichnissesn des
Apache-Document-Root liegen. Sie steuern die Zugriffsrechte auf das
jeweilige Verzeichnis und dienen dadurch der Sicherheit einer Website,
indem Sie z.B. verhindern, dass ein Websitebesucher auf Dokumente
zugreifen kann, die andere User hochgeladen haben.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="upload-großer-dateien">Upload großer Dateien<a class="anchor" aria-label="anchor" href="#upload-gro%C3%9Fer-dateien"></a>
</h3>
<p>Möchte man größere Dateien über das Webinterface seines
Nextcloud-Server hochladen, muss der Transport großer Dateien durch das
System, den Webserver und PHP gewährleistet werden. Dabei ist zu
beachten, dass Uploads über einen Nextcloud-Client (z.B. am Desktop-PC)
nicht betroffen sind, da dieser eine große Datei in einzelnen Teilen
hochlädt. Erlaubt man den Upload sehr großer Dateien kann dies die
Systemleistung negativ beeinflussen; User*innen mit bösen Absichten
könnten dadurch sogar den Nextcloud-Server überlasten und dadurch
unbrauchbar machen.</p>
<p>Möchte man die Option dennoch aktivieren (um z.B. größere
ZIP-Dateien, Videodateien oder Festplattenimages im Browser hochladen zu
können), gibt einem das <a href="https://docs.nextcloud.com/server/stable/admin_manual/configuration_files/big_file_upload_configuration.html" class="external-link">Handbuch</a>
Hilfestellung. Die wesentlichen Punkte sind:</p>
<ul>
<li><p>Ausreichend Speicherplatz für alle parallel laufenden Uploads im
Verzeichnis <code>/tmp/</code></p></li>
<li><p>PHP.ini-Dateien (<code>/etc/php/8.2/cli/php.ini</code> und
<code>/etc/php/8.2/apache2/php.ini</code>) bearbeiten:</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PHP<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode php" tabindex="0"><code class="sourceCode php"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>php_value upload_max_filesize <span class="op">&lt;</span>Größe<span class="ot">,</span> z<span class="op">.</span><span class="cn">B</span><span class="op">.</span> <span class="er">10</span>G<span class="op">&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>php_value post_max_size <span class="op">&lt;</span>Größe<span class="ot">,</span> z<span class="op">.</span><span class="cn">B</span><span class="op">.</span> <span class="er">10</span>G<span class="op">&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>[...]</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>php_value max_input_time <span class="op">&lt;</span>Upload<span class="op">-</span>Timout<span class="op">-</span>Zeit in Sekunden<span class="ot">,</span> z<span class="op">.</span><span class="cn">B</span><span class="op">.</span> <span class="dv">3600</span> für eine Stunde<span class="op">&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>php_value max_execution_time <span class="op">&lt;</span>Upload<span class="op">-</span>Timout<span class="op">-</span>Zeit in Sekunden<span class="ot">,</span> z<span class="op">.</span><span class="cn">B</span><span class="op">.</span> <span class="dv">3600</span> für eine Stunde<span class="op">&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>[...]</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>output_buffering <span class="op">=</span> <span class="dv">0</span></span></code></pre>
</div>
<ul>
<li>Evlt. müssen in der Apache-Konfigurationsdatei
(<code>/etc/apache2/sites-available/nextcloud.conf</code>) einige
Timeouts innerhalb des zweiten virtual-host-Bereichs durch Eintragung
und Anpassung der folgenden Zeilen erhöht werden ((siehe Apache-Handbuch
zu den Themen <a href="https://httpd.apache.org/docs/current/mod/mod_reqtimeout.html" class="external-link">requirereadtime</a>,
<a href="https://httpd.apache.org/docs/current/mod/core.html#timeout" class="external-link">TimeOut</a>
und <a href="https://httpd.apache.org/docs/current/mod/core.html#limitrequestbody" class="external-link">LimitRequestBody</a>):</li>
</ul>
<pre><code>RequestReadTimeout header=20-40,MinRate=500 body=20,MinRate=500
LimitRequestBody &lt;Größe in Bytes, z.B. 10737418240 für 10 GiB&gt;
TimeOut &lt;Wert in Sekunden&gt;</code></pre>
<p>Je nach System sind weitere Optimierungen möglich. Das bereits viel
erwähnte <a href="https://docs.nextcloud.com/server/stable/admin_manual/installation/server_tuning.html" class="external-link">Handbuch</a>
gibt Anreize. Viele der dort genannten Punkte wurden in dieser oder
vorheriger Lektionen bereits umgesetzt. Empfehlenswert kann der Einsatz
und die Anpassung von PHP-FPM sein. Für Nextcloud 28 und einen Raspberry
Pi 4 mit 4 GB RAM ist auf <a href="https://intux.de/2023/12/27/php8-2-fpm-fuer-nextcloud-28/" class="external-link">intux.de</a>
eine ausführliche Schilderung zu finden.</p>
</div>
</section><section><h2 class="section-heading" id="server-hardening">Server Hardening<a class="anchor" aria-label="anchor" href="#server-hardening"></a>
</h2>
<hr class="half-width">
<p>Um seinen Nextcloud-Server sicher zu betreiben können weitere
Schritte unternommen werden, welche wieder dem <a href="https://docs.nextcloud.com/server/stable/admin_manual/installation/harden_server.html" class="external-link">Handbuch</a>
entnommen werden können.</p>
<p>Grundlegend ist es wichtig, sein gesamtes System stets aktuell zu
halten, sich regelmäßig über Änderungen auf dem Laufenden zu halten und
neue Sicherheitsempfehlungen umzusetzen.</p>
<p>Um zum Beispiel den <strong>Apache-Webserver</strong> weiter
abzusichern, gibt es im Internet viele Ratschläge. z.B. bei <a href="https://httpd.apache.org/docs/2.4/misc/security_tips.html" class="external-link">Apache
selbst</a>, bei <a href="https://www.tecmint.com/apache-security-tips/" class="external-link">tecmint.com</a>
oder <a href="https://geekflare.com/apache-web-server-hardening-security/" class="external-link">geekflare.com</a>.
Dabei sollte stets auf die Aktualität und Zuverlässigkeit der Tipps
geachtet werden. Außerdem muss die Kompatibilität mit dem
Nextcloud-Server getestet werden.</p>
<div class="section level3">
<h3 id="zufallszahlen-mit-devurandom">Zufallszahlen mit <code>/dev/urandom/</code>
<a class="anchor" aria-label="anchor" href="#zufallszahlen-mit-devurandom"></a>
</h3>
<p>Unter den im Handbuch genannten Sicherheitsempfehlungen kann recht
schnell der Zugriff für PHP auf <code>/dev/random</code> gewährleistet
werden. Dadurch werden bessere Zufallszahlen berechnet, z.B. für
Passwörter. Dazu müssen die PHP.ini-Dateien
(<code>/etc/php/8.2/cli/php.ini</code> und
<code>/etc/php/8.2/apache2/php.ini</code>) bearbeitet werden und
folgende Zeile ergänzt werden:</p>
<pre><code>open_basedir /var/www/nextcloud/:/dev/urandom/:&lt;Pfad-zum-Datenverzeichnis, z.B. /mnt/data/ncdata/&gt;</code></pre>
</div>
<div class="section level3">
<h3 id="fail2ban">Fail2Ban<a class="anchor" aria-label="anchor" href="#fail2ban"></a>
</h3>
<p>Wie auch schon für den SSH-Server kann auch für Nextcloud ein
<em>Jail</em> für Fail2Ban definiert werden, mit welchem zu viele
fehlerhafte Logins detektiert und deren Verursacher geblockt werden
können. Dazu muss in der Fail2Ban-Konfiguratiuonsdatei das Jail defniert
werden und ein Filter erstellt. Das <a href="https://docs.nextcloud.com/server/stable/admin_manual/installation/harden_server.html#setup-fail2ban" class="external-link">Handbuch</a>
zeigt die einzelnen Schritte auf.</p>
</div>
</section><section><h2 class="section-heading" id="weitere-funktionen">Weitere Funktionen<a class="anchor" aria-label="anchor" href="#weitere-funktionen"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="apps">Apps<a class="anchor" aria-label="anchor" href="#apps"></a>
</h3>
<p>Um die Funktionalität des Nextcloud-Server zu erweitern können Apps
installiert werden. Da Nextcloud eine Open-Source-Software mit sehr
aktiver Community ist, gibt es sehr viele Erweiterungen und
Integrationen.</p>
<p>Um Apps zu installieren, muss man sich im Browser mit dem
Adminstratoraccount anmelden. Bei Klick auf das Benutzericon in der
rechten oberen Ecke gelangt man zum Menüpunkt Apps.</p>
<p>Dort können Apps gesucht, installiert und vorhandene aktualisiert
werden. Die Verwaltung der Apps kann auch mit dem occ-Tool auf der
Kommandozeile erfolgen.</p>
<figure><img src="../fig/13_apps.png" class="figure mx-auto d-block"><div class="figcaption">Nextcloud Appverwaltung im Browser</div>
</figure><p>Es gibt zu sehr vielen Themen unterschiedliche Apps. Z.B. <a href="https://apps.nextcloud.com/apps/spreed" class="external-link">Talk</a> für Chat und
Videokonferenzen, <a href="https://apps.nextcloud.com/apps/memories" class="external-link">Memories</a> für die
Bildverwaltung, <a href="https://apps.nextcloud.com/apps/cospend" class="external-link">Cospend</a> für die
Abrechnung gemeinsamer Ausgaben, <a href="https://apps.nextcloud.com/apps/news" class="external-link">News</a> um Nachrichtenfeeds
in der Nextcloud-App zu erhalten, <a href="https://apps.nextcloud.com/apps/richdocuments" class="external-link">Nextcloud-Office</a>
um Dokumente, auch gemeinsam, im Browser zu bearbeiten, <a href="https://apps.nextcloud.com/apps/calendar" class="external-link">Kalender</a> und <a href="https://apps.nextcloud.com/apps/contacts" class="external-link">Kontakte</a> um diese
Daten nicht mehr bei Dritten speichern zu müssen und vieles <a href="https://apps.nextcloud.com/" class="external-link">mehr</a>.</p>
</div>
<div class="section level3">
<h3 id="user-und-gruppen">User und Gruppen<a class="anchor" aria-label="anchor" href="#user-und-gruppen"></a>
</h3>
<p>Natürlich können dem Nextcloud-Server weitere User hinzugefügt
werden. Auch das kann als Adminstrator im Browser getan werden.
Zusätzlich können User auch in Gruppen eingeteilt werden, um so die
Rechteverwaltung zu erleichtern.</p>
</div>
<div class="section level3">
<h3 id="clients">Clients<a class="anchor" aria-label="anchor" href="#clients"></a>
</h3>
<p>Um auf die Daten und Informationen seines Nextcloud-Servers zugreifen
zu können, können neben dem Webbrowser auch verschiedene <a href="https://nextcloud.com/install/#install-clients" class="external-link">Client-Programme</a>
genutzt werden. Für alle gängigen Betriebssystem gibt es den
Synchronisierungsclient, für mobile Geräte darüber hinaus zahlreiche
Apps für bestimmte Einsatzzwecke.</p>
</div>
<div class="section level3">
<h3 id="support">Support<a class="anchor" aria-label="anchor" href="#support"></a>
</h3>
<p>Während für Privat- und Kleinanwender die große <a href="https://help.nextcloud.com/" class="external-link">Community</a> Hilfe bietet, besteht
für größere Instanzen von Organisationen auch die Option eine <a href="https://nextcloud.com/enterprise/" class="external-link">kostenpflichtige
Enterprise-Lizenz</a> zu erwerben und damit Zugriff auf den Support und
zusätzliche Informationen und Tools von Nextcloud zu erhalten.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Hauptpunkte</h3>
<div class="callout-content">
<ul>
<li><p>Die Aktualisierung kann mit dem Build-In Updater im Browser oder
per CMD erfolgen</p></li>
<li><p>Nach Abschluss der Aktualisierung muss die Datenank migriert
werden und ggf. weitere Schritte durchgeführt werden</p></li>
<li><p>Die Performance des Servers kann durch Konfigurationsänderungen
in PHP verbessert werden</p></li>
<li><p>Die Sicherheit kann durch Änderungen an der Apache-Konfiguration,
mit Fail2Ban und <em>urandom</em> erhöht werden</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>Diese Lektion unterliegt dem <a href="CODE_OF_CONDUCT.html">Verhaltenskodex</a></p>
        <p>

        <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/edit/main/README.md" class="external-link">Auf GitHub bearbeiten</a>

	
        | <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/blob/main/CONTRIBUTING.md" class="external-link">Beitragen</a>
        | <a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/" class="external-link">Quelle</a></p>
				<p><a href="https://github.com/Dr-Eberle-Zentrum/self-hosted-datamanagement/blob/main/CITATION.cff" class="external-link">Zitieren</a> | <a href="mailto:david.kirschenheuter@uni-tuebingen.de">Kontakt</a> | <a href="https://carpentries.org/about/" class="external-link">Über</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Vorlage lizenziert unter <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> von <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Erstellt mit <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a> und <a href="https://github.com/Dr-Eberle-Zentrum/varnish/tree/801bcb40bf3fb18c37950e8d445d79e8aec39af7" class="external-link">varnish (1.0.4)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Zurück nach oben"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Zurück</span> nach oben
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://Dr-Eberle-Zentrum.github.io/self-hosted-datamanagement/instructor/aio.html",
  "inLanguage": "de",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "Datamanagement, Raspberry Pi, Nextcloud, Self-hosted",
  "name": "Alles auf einen Blick",
  "creativeWorkStatus": "active",
  "url": "https://Dr-Eberle-Zentrum.github.io/self-hosted-datamanagement/instructor/aio.html",
  "identifier": "https://Dr-Eberle-Zentrum.github.io/self-hosted-datamanagement/instructor/aio.html",
  "dateCreated": "2024-08-02",
  "dateModified": "2025-04-25",
  "datePublished": "2025-04-25"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

